<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OverSim: PubSubMMOG Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OverSim
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classPubSubMMOG.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">PubSubMMOG Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="PubSubMMOG" --><!-- doxytag: inherits="BaseOverlay" -->
<p><code>#include &lt;<a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PubSubMMOG:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classPubSubMMOG.png" usemap="#PubSubMMOG_map" alt=""/>
  <map id="PubSubMMOG_map" name="PubSubMMOG_map">
<area href="classBaseOverlay.html" title="Base class for overlays." alt="BaseOverlay" shape="rect" coords="115,112,220,136"/>
<area href="classBaseRpc.html" title="Base class for RPCs." alt="BaseRpc" shape="rect" coords="0,56,105,80"/>
<area href="classBaseTcpSupport.html" alt="BaseTcpSupport" shape="rect" coords="115,56,220,80"/>
<area href="classTopologyVis.html" alt="TopologyVis" shape="rect" coords="230,56,335,80"/>
<area href="classRpcListener.html" title="A Remote-Procedure-Call listener class." alt="RpcListener" shape="rect" coords="0,0,105,24"/>
</map>
 </div></div>

<p><a href="classPubSubMMOG-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#ad55240696d31dd1a7003a7269aca4743">~PubSubMMOG</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a42a189f235425d0cc5706857f3122283">initializeOverlay</a> (int stage)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes derived-class-attributes.  <a href="#a42a189f235425d0cc5706857f3122283"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#ab097bce7563e87ecf690559095908207">finishOverlay</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">collects statistical data in derived class  <a href="#ab097bce7563e87ecf690559095908207"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a4af2596c5cc972a1c4dacfde82c989ee">handleUDPMessage</a> (<a class="el" href="classBaseOverlayMessage.html">BaseOverlayMessage</a> *msg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes messages from underlay.  <a href="#a4af2596c5cc972a1c4dacfde82c989ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a3df1116194918ab1768c1afbdef4fb00">handleTimerEvent</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#aa755315cd277b3c3cad5522cb7acb9dc">handleAppMessage</a> (cMessage *msg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes "timer" self-messages.  <a href="#aa755315cd277b3c3cad5522cb7acb9dc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#ac789c61936dbd0e4787822022f0ecfba">receiveChangeNotification</a> (int category, const cPolymorphic *details)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">callback-method for events at the NotificationBoard  <a href="#ac789c61936dbd0e4787822022f0ecfba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a4f2a87f7e95bbb17819f04261585236d">handleRpcCall</a> (<a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *msg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes Remote-Procedure-Call invocation messages.  <a href="#a4f2a87f7e95bbb17819f04261585236d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a8cd2dcabf97fae56f6af40cda177fdf7">handleRpcResponse</a> (<a class="el" href="classBaseResponseMessage.html">BaseResponseMessage</a> *msg, cPolymorphic *context, int rpcId, simtime_t rtt)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is called if an RPC response has been received.  <a href="#a8cd2dcabf97fae56f6af40cda177fdf7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a9838eb23acd2464c8500cdff66caf8a8">handleRpcTimeout</a> (<a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *msg, const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;dest, cPolymorphic *context, int rpcId, const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;destKey)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is called if an RPC timeout has been reached.  <a href="#a9838eb23acd2464c8500cdff66caf8a8"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a3e573d9ce39091daea435016a587b239">setBootstrapedIcon</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a271c0f8b14c7c023c26a1a3f19e156a4">handleMove</a> (<a class="el" href="classGameAPIPositionMessage.html">GameAPIPositionMessage</a> *posMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#aa5f5b3bb6f7a4a26ab45dfdb6248f21b">handleMoveMessage</a> (<a class="el" href="classPubSubMoveMessage.html">PubSubMoveMessage</a> *moveMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a9d46909d81ca32d3ec2020a7184c3f50">handleMoveListMessage</a> (<a class="el" href="classPubSubMoveListMessage.html">PubSubMoveListMessage</a> *moveMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a90f7b9fa68b400b80892d642f4c439b4">handleJoinResponse</a> (<a class="el" href="classPubSubJoinResponse.html">PubSubJoinResponse</a> *joinResp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a3d1fd761fc46a4b56f1c7e852bf41207">handleSubscriptionCall</a> (<a class="el" href="classPubSubSubscriptionCall.html">PubSubSubscriptionCall</a> *subCall)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a7d6b63042aee9dfbe3d11d2062a43a05">handleSubscriptionResponse</a> (<a class="el" href="classPubSubSubscriptionResponse.html">PubSubSubscriptionResponse</a> *subResp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a7e351287bef39afa54408e4fce0fdf26">handleResponsibleNodeResponse</a> (<a class="el" href="classPubSubResponsibleNodeResponse.html">PubSubResponsibleNodeResponse</a> *subResp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#af504bf4e0b52404912395baefed9f5c5">handleTakeOver</a> (<a class="el" href="classPubSubTakeOverSubspaceCall.html">PubSubTakeOverSubspaceCall</a> *toCall)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a7d28b4484518dcf34fbc2cb462bf620b">handleHelpResponse</a> (<a class="el" href="classPubSubHelpResponse.html">PubSubHelpResponse</a> *helpResp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#ac7e55bce3aa2a48f4367977e081eb9e1">handleBackupCall</a> (<a class="el" href="classPubSubBackupCall.html">PubSubBackupCall</a> *backupCall)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a401659ffbdca793a6f7d97e9737a70d0">handleBackupResponse</a> (<a class="el" href="classPubSubBackupResponse.html">PubSubBackupResponse</a> *backupResp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a77d17c923e8b43f0bf38222dd58d3969">handleIntermediateCall</a> (<a class="el" href="classPubSubIntermediateCall.html">PubSubIntermediateCall</a> *intermediateCall)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#ac41702ca41ffae439637504939856f4f">handleIntermediateResponse</a> (<a class="el" href="classPubSubIntermediateResponse.html">PubSubIntermediateResponse</a> *intermediateResp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a301bb30f1b9239fa5ea744400be48a1b">handleAdoptChildCall</a> (<a class="el" href="classPubSubAdoptChildCall.html">PubSubAdoptChildCall</a> *adoptCall)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a9f396c585cfb16b476047c35fbbe05fa">handleAdoptChildResponse</a> (<a class="el" href="classPubSubAdoptChildResponse.html">PubSubAdoptChildResponse</a> *adoptResp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a7179d8d2355f09e50e5172a8bc4e60b1">handlePingCall</a> (<a class="el" href="classPubSubPingCall.html">PubSubPingCall</a> *hearbeatCall)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a6ade874ae0f4871c157cbf3e4334724c">handlePingResponse</a> (<a class="el" href="classPubSubPingResponse.html">PubSubPingResponse</a> *pingResp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a0fe097eb8ff809023d0a119b2dc17d61">takeOverNewSubspace</a> (<a class="el" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a60f9145524471fe4aa44641f1d0e6a17">takeOverSubspace</a> (<a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> &amp;subspaceId, bool isNew)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a237b78a3abc9b6cbb95021e25306e2e2">sendHearbeatToChildren</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#abd00be445c110f527365d00553713334">sendPingToChildren</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a01a6bc8e4b0e38e57d2e3108088f67f3">handleParentTimeout</a> (<a class="el" href="classPubSubTimer.html">PubSubTimer</a> *timer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a217e815ddc5ba02f8afe33a73389184f">handleBackupCallTimeout</a> (<a class="el" href="classPubSubBackupCall.html">PubSubBackupCall</a> *backupCall, const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;oldNode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a0ca3bd97cac131ba5c2ff02235cc6a2f">handlePingCallTimeout</a> (<a class="el" href="classPubSubPingCall.html">PubSubPingCall</a> *pingCall, const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;oldNode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a1e97ea82ff0848af1f5437b1c8da7c99">handleSubscriptionCallTimeout</a> (<a class="el" href="classPubSubSubscriptionCall.html">PubSubSubscriptionCall</a> *subscriptionCall, const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;oldNode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a1e837eb023ac96a24c564e8c42da7c87">handleUnsubscriptionMessage</a> (<a class="el" href="classPubSubUnsubscriptionMessage.html">PubSubUnsubscriptionMessage</a> *unsMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a73afcba7483897f08cfb5d258e569683">handleNodeLeftMessage</a> (<a class="el" href="classPubSubNodeLeftMessage.html">PubSubNodeLeftMessage</a> *leftMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#abd3f25e6c1521cc5d6959fc1929a2ac6">handleReplacementMessage</a> (<a class="el" href="classPubSubReplacementMessage.html">PubSubReplacementMessage</a> *replaceMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#af1197b5fab38765c9e510cb6e755f62a">handleReleaseIntermediate</a> (<a class="el" href="classPubSubReleaseIntermediateMessage.html">PubSubReleaseIntermediateMessage</a> *releaseMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a77b144f6034216ef0184589cf5b4da8d">handleIntermediateBackup</a> (<a class="el" href="classPubSubBackupIntermediateMessage.html">PubSubBackupIntermediateMessage</a> *backupMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a354f1a0173cb3cc5a00bc7d16d17f73a">handleSubscriptionBackup</a> (<a class="el" href="classPubSubBackupSubscriptionMessage.html">PubSubBackupSubscriptionMessage</a> *backupMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a74e961ef109ba657e32f82519721eeaf">handleUnsubscribeBackup</a> (<a class="el" href="classPubSubBackupUnsubscribeMessage.html">PubSubBackupUnsubscribeMessage</a> *backupMsg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a104570a1f3f3f4951bf67e9b8e09b0e8">unsubscribeChild</a> (const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;node, <a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> &amp;subspace)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#aedde86c47759c2ab5b61744c7065377c">sendMessageToChildren</a> (<a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> &amp;subspace, <a class="el" href="classBaseOverlayMessage.html">BaseOverlayMessage</a> *toIntermediates, <a class="el" href="classBaseOverlayMessage.html">BaseOverlayMessage</a> *toBackup, <a class="el" href="classBaseOverlayMessage.html">BaseOverlayMessage</a> *toPlayers)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a3c4d846c243253afb0f72592e44590ff">publishEvents</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a> (<a class="el" href="classPubSubTimer.html">PubSubTimer</a> *timer)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="classPubSubSubspace.html">PubSubSubspace</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>, <br class="typebreak"/>
<a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>, <br class="typebreak"/>
<a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>, <br class="typebreak"/>
<a class="el" href="classPubSubSubspaceIntermediate.html">PubSubSubspaceIntermediate</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a98fd6baf72474a184c902133581273fa">parentTimeout</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#aced8c7945b0f77560359167cc5f398f6">allowOldMoveMessages</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a6adc937050de85cfcffa4561b6daee84">currentRegionX</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#aa43137704c5ad5a9fecbff8a01ce38bc">currentRegionY</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a228fe6f61d1fe510d1336296c4bf254c">movementRate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a219753e4fc3eae95cd21f70bc40017e7">maxMoveDelay</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPubSubTimer.html">PubSubTimer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#aebf88e5c0a0f294c706c3281b1aae373">heartbeatTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPubSubTimer.html">PubSubTimer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a2540cd40427d53404d3adbca173cfd6c">childPingTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPubSubTimer.html">PubSubTimer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a5c7d73c47298f65748e65abc506b9611">eventDeliveryTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a04199b677abdfd25b29f9a5f79c19426">joinTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTransportAddress.html">TransportAddress</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#aa809123a9ef7f64ea622400ed60a2d4c">numEventsWrongTimeslot</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a0adb17b77190fd14c0979fe39a5889cc">numEventsCorrectTimeslot</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a11ca86e89977d8bb4d1512a5e64ce8d3">numMoveMessages</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a122b6f4eacfc82a453cdabace026a0d5">moveMessagesSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">numMoveListMessages</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a5a665dd74681081d669ea57efd5d83b0">moveListMessagesSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a4561eb4e380c7aea874ea622b9145603">respMoveListMessagesSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a1450e36b5a7103fe4581f271fac13340">lostMovementLists</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPubSubMMOG.html#a8415fe6a47b3b961fd54f9e3b5f8d3f0">receivedMovementLists</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00033">33</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ad55240696d31dd1a7003a7269aca4743"></a><!-- doxytag: member="PubSubMMOG::~PubSubMMOG" ref="ad55240696d31dd1a7003a7269aca4743" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PubSubMMOG::~PubSubMMOG </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l02006">2006</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Delete all waiting move messages</span>
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    <span class="keywordflow">for</span>( it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.begin(); it != <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end(); ++it) {
        deque&lt;PubSubMoveMessage*&gt;::iterator msgIt;
        <span class="keywordflow">for</span>( msgIt = it-&gt;second.waitingMoveMessages.begin(); msgIt != it-&gt;second.waitingMoveMessages.end(); ++msgIt ){
            cancelAndDelete( *msgIt );
        }
        it-&gt;second.waitingMoveMessages.clear();
    }

    cancelAndDelete(<a class="code" href="classPubSubMMOG.html#aebf88e5c0a0f294c706c3281b1aae373">heartbeatTimer</a>);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab097bce7563e87ecf690559095908207"></a><!-- doxytag: member="PubSubMMOG::finishOverlay" ref="ab097bce7563e87ecf690559095908207" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::finishOverlay </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>collects statistical data in derived class </p>

<p>Reimplemented from <a class="el" href="classBaseOverlay.html#a8db85b9c706d04007154761d5a0cec16">BaseOverlay</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01977">1977</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    simtime_t time = <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a610799ebfbf64696c59b811870cc8300">calcMeasuredLifetime</a>(<a class="code" href="classBaseOverlay.html#af0eebaddea732ee4ab4d247c388e62bd" title="simtime when the node has been created">creationTime</a>);
    <span class="keywordflow">if</span> (time &lt; <a class="code" href="classGlobalStatistics.html#a169810c78519b271f7e32fdc7c9fc641" title="minimum useful measured lifetime in seconds">GlobalStatistics::MIN_MEASURED</a>) <span class="keywordflow">return</span>;

    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Sent Signaling Messages/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Sent Signaling bytes/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Sent Move Messages/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#a11ca86e89977d8bb4d1512a5e64ce8d3">numMoveMessages</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Sent Move bytes/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#a122b6f4eacfc82a453cdabace026a0d5">moveMessagesSize</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Sent MoveList Messages/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">numMoveListMessages</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Sent MoveList bytes/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#a5a665dd74681081d669ea57efd5d83b0">moveListMessagesSize</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Received Move Events (correct timeslot)/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#a0adb17b77190fd14c0979fe39a5889cc">numEventsCorrectTimeslot</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Received Move Events (wrong timeslot)/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#aa809123a9ef7f64ea622400ed60a2d4c">numEventsWrongTimeslot</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Responsible Nodes: Send MoveList Bytes/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#a4561eb4e380c7aea874ea622b9145603">respMoveListMessagesSize</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Lost or too long delayed MoveLists/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#a1450e36b5a7103fe4581f271fac13340">lostMovementLists</a> / time);
    <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: Received valid MoveLists/s&quot;</span>,
                                <a class="code" href="classPubSubMMOG.html#a8415fe6a47b3b961fd54f9e3b5f8d3f0">receivedMovementLists</a> / time);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a301bb30f1b9239fa5ea744400be48a1b"></a><!-- doxytag: member="PubSubMMOG::handleAdoptChildCall" ref="a301bb30f1b9239fa5ea744400be48a1b" args="(PubSubAdoptChildCall *adoptCall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleAdoptChildCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubAdoptChildCall.html">PubSubAdoptChildCall</a> *&#160;</td>
          <td class="paramname"><em>adoptCall</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01026">1026</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::map&lt;PubSubSubspaceId, PubSubSubspaceIntermediate&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a55f2fabdda4d8e593f62af92f6320efb">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.end() ) {
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleAdoptChildCall() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
           &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;  Received Adopt Child Call for unknown Subspace!\n&quot;</span>
           &lt;&lt; endl;
        cancelAndDelete( adoptCall );
        <span class="keywordflow">return</span>;
    }

    it-&gt;second.addChild( adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a47f61a8c6ac788a183fafe93ada0e149">getChild</a>() );
    <a class="code" href="classPubSubAdoptChildResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildResponse</a>* adoptResp = <span class="keyword">new</span> <a class="code" href="classPubSubAdoptChildResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildResponse</a>(<span class="stringliteral">&quot;I adopted child&quot;</span>);
    adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#a85d626fb2653f5b8d6dc5bef8492a91e">setSubspaceId</a>( adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a55f2fabdda4d8e593f62af92f6320efb">getSubspaceId</a>() );
    adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#addeb9ae58d5d325e300472ed97838eec">setChild</a>( adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a47f61a8c6ac788a183fafe93ada0e149">getChild</a>() );
    adoptResp-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a245e5d150580b43d98348a8cd4008373">PUBSUB_ADOPTCHILDRESPONSE_L</a>( adoptResp ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= adoptResp-&gt;getByteLength()
            );
    <a class="code" href="classBaseRpc.html#adc06091d348c98a5efbf54fe0afe8747" title="Send Remote-Procedure response message and deletes call message.">sendRpcResponse</a>( adoptCall, adoptResp );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9f396c585cfb16b476047c35fbbe05fa"></a><!-- doxytag: member="PubSubMMOG::handleAdoptChildResponse" ref="a9f396c585cfb16b476047c35fbbe05fa" args="(PubSubAdoptChildResponse *adoptResp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleAdoptChildResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubAdoptChildResponse.html">PubSubAdoptChildResponse</a> *&#160;</td>
          <td class="paramname"><em>adoptResp</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01051">1051</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#ac06febb4c2fd644ad5c31b844e6356de">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ) {
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleAdoptChildResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
           &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;  Received AdoptChild Response for unknown Subspace!\n&quot;</span>
           &lt;&lt; endl;
        <span class="keywordflow">return</span>;
    }

<span class="comment">// FIXME: just for testing</span>
<a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;
<span class="keywordtype">int</span> iii = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>();
subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
<span class="keywordflow">if</span>( iii != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() ){
    opp_error(<span class="stringliteral">&quot;Huh?&quot;</span>);
}

    <span class="comment">// Find intermediate node in subspace</span>
    deque&lt;PubSubSubspaceResponsible::IntermediateNode&gt;::iterator iit;
    <span class="keywordflow">for</span>( iit = it-&gt;second.intermediateNodes.begin(); iit !=  it-&gt;second.intermediateNodes.end(); ++iit ){
        <span class="keywordflow">if</span>( !iit-&gt;node.isUnspecified() &amp;&amp; iit-&gt;node == adoptResp-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>() ){

            <span class="comment">// if adoption was for a child intermediate node, nothing is to be done</span>
            <span class="keywordtype">int</span> intermediatePos = iit - it-&gt;second.intermediateNodes.begin();
            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> pos = (intermediatePos+1) * <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a>; pos &lt; (int) it-&gt;second.intermediateNodes.size() &amp;&amp;
                    pos &lt; (intermediatePos+2) * <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a>; ++pos )
            {
                <span class="keywordflow">if</span>( !it-&gt;second.intermediateNodes[pos].node.isUnspecified() &amp;&amp;
                        adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#a2ec09ab70ab5e0f4603c3b856acfde80">getChild</a>() == it-&gt;second.intermediateNodes[pos].node ){
                    <span class="keywordflow">return</span>;
                }
            }

            <span class="comment">// child is a &quot;real&quot; child-&gt;remove it from cache</span>
            <span class="keywordflow">if</span>( !it-&gt;second.cachedChildren.erase( adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#a2ec09ab70ab5e0f4603c3b856acfde80">getChild</a>() ) ){
                <span class="comment">// if node got deleted in the meantime, inform parent...</span>
                <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>* goneMsg = <span class="keyword">new</span> <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>(<span class="stringliteral">&quot;Node left Subspace&quot;</span>);
                goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a4604631be10c1b8f9aa6db29aaa76386">setNode</a>( adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#a2ec09ab70ab5e0f4603c3b856acfde80">getChild</a>() );
                goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a74ae8a4726d74370cc59cae590a72ddb">setSubspaceId</a>( it-&gt;second.getId().getId() );
                goneMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#ac2a4c9a20c40c17b2a948f346d5ae4fc">PUBSUB_NODELEFT_L</a>( goneMsg ));
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= goneMsg-&gt;getByteLength()
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( adoptResp-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>(), goneMsg );
                <span class="keywordflow">return</span>;
            }

            <span class="comment">// move child to intermediate node&#39;s childrenlist</span>
            <span class="keywordflow">if</span>( !iit-&gt;children.insert( adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#a2ec09ab70ab5e0f4603c3b856acfde80">getChild</a>() ).second ){
                <span class="comment">// Node was already in children list, fix children count</span>
                subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
            }
            iit-&gt;waitingChildren--;

<span class="comment">// FIXME: just for testing</span>
<a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;
<span class="keywordtype">int</span> iii = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>();
subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
<span class="keywordflow">if</span>( iii != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() ){
    opp_error(<span class="stringliteral">&quot;Huh?&quot;</span>);
}

            <span class="comment">// Inform Backup</span>
            <span class="keywordflow">if</span>( !it-&gt;second.getBackupNode().isUnspecified() ){
                <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>* backupMsg = <span class="keyword">new</span> <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>(<span class="stringliteral">&quot;Backup: node got a new parent&quot;</span>);
                backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#ac8a8edd3c1669fa810598e7d16b4141f">setSubspaceId</a>( adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#ac06febb4c2fd644ad5c31b844e6356de">getSubspaceId</a>() );
                backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#af638885c4794f5652c318f21521c5668">setChild</a>( adoptResp-&gt;<a class="code" href="classPubSubAdoptChildResponse.html#a2ec09ab70ab5e0f4603c3b856acfde80">getChild</a>() );
                backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#aaf5be2dc4b0de3c0e59c607794788261">setParent</a>( adoptResp-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>() );
                backupMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a485654404a477aa60cb34dd0ae722258">PUBSUB_BACKUPSUBSCRIPTION_L</a>( backupMsg ));
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                       pubSubSignalingMessagesSize+= backupMsg-&gt;getByteLength()
                       );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( it-&gt;second.getBackupNode(), backupMsg );
                <span class="keywordflow">return</span>;
            }
        }
    }

    EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleAdoptChildResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
       &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
       &lt;&lt; <span class="stringliteral">&quot;  Received AdoptChild Response for unknown child!\n&quot;</span>
       &lt;&lt; endl;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa755315cd277b3c3cad5522cb7acb9dc"></a><!-- doxytag: member="PubSubMMOG::handleAppMessage" ref="aa755315cd277b3c3cad5522cb7acb9dc" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleAppMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Processes "timer" self-messages. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>A self-message Processes non-commonAPI messages</td></tr>
    <tr><td class="paramname">msg</td><td>non-commonAPIMessage </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classBaseOverlay.html#aef92d042c22b47c123e59a831acb7033">BaseOverlay</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00315">315</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span>( <a class="code" href="classGameAPIPositionMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">GameAPIPositionMessage</a> *posMsg = dynamic_cast&lt;GameAPIPositionMessage*&gt;(msg) ) {
        <span class="keywordflow">if</span>( <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> == <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fab3a263fb274a58d63b15cd61ba910335">READY</a> ) {
            <a class="code" href="classPubSubMMOG.html#a271c0f8b14c7c023c26a1a3f19e156a4">handleMove</a>( posMsg );
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> == <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fa40c37f1f56c6ed8e40ae467e67e61cab">JOIN</a> ) {
            <span class="comment">// We are not connected to our responsible node, inform app</span>
            <a class="code" href="classCompReadyMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">CompReadyMessage</a>* msg = <span class="keyword">new</span> <a class="code" href="classCompReadyMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">CompReadyMessage</a>(<span class="stringliteral">&quot;Overlay not READY!&quot;</span>);
            msg-&gt;<a class="code" href="classCompReadyMessage.html#a07d2b2a15889728c23ed4d80730de2cf">setReady</a>(<span class="keyword">false</span>);
            msg-&gt;<a class="code" href="classCompReadyMessage.html#a77640d7f3566804064921b2520ed51b6">setComp</a>(<a class="code" href="classBaseOverlay.html#a92e0d3f96a5716245465e05da60ef487" title="Return the component type of this module.">getThisCompType</a>());
            send( msg, <span class="stringliteral">&quot;appOut&quot;</span>);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> == <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fa4c1b397f6c4682baf7db280e7f15520a">INIT</a> ) {
            <span class="comment">// This is only called for the first MOVE message</span>
            <span class="comment">// Trigger login</span>
            <a class="code" href="classPubSubJoinCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubJoinCall</a>* joinMsg = <span class="keyword">new</span> <a class="code" href="classPubSubJoinCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubJoinCall</a>(<span class="stringliteral">&quot;Login&quot;</span>);
            joinMsg-&gt;<a class="code" href="classPubSubJoinCall.html#af8d53001fd45a3b3369a5bb5bbb13e37">setPosition</a>( posMsg-&gt;getPosition() );
            <span class="comment">// FIXME: Ressource handling not yet supported!</span>
            joinMsg-&gt;<a class="code" href="classPubSubJoinCall.html#ad2881d91f16fc96e9cb365af9140cef5">setRessources</a>( 4 );
            <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, joinMsg );

            <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> = <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fa40c37f1f56c6ed8e40ae467e67e61cab">JOIN</a>;
            <a class="code" href="classPubSubMMOG.html#a3e573d9ce39091daea435016a587b239">setBootstrapedIcon</a>();

            <span class="comment">// tell app to wait until login is confirmed...</span>
            <a class="code" href="classCompReadyMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">CompReadyMessage</a>* readyMsg = <span class="keyword">new</span> <a class="code" href="classCompReadyMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">CompReadyMessage</a>(<span class="stringliteral">&quot;Overlay not READY!&quot;</span>);
            readyMsg-&gt;<a class="code" href="classCompReadyMessage.html#a07d2b2a15889728c23ed4d80730de2cf">setReady</a>(<span class="keyword">false</span>);
            readyMsg-&gt;<a class="code" href="classCompReadyMessage.html#a77640d7f3566804064921b2520ed51b6">setComp</a>(<a class="code" href="classBaseOverlay.html#a92e0d3f96a5716245465e05da60ef487" title="Return the component type of this module.">getThisCompType</a>());
            send( readyMsg, <span class="stringliteral">&quot;appOut&quot;</span>);

            <a class="code" href="classPubSubMMOG.html#a6adc937050de85cfcffa4561b6daee84">currentRegionX</a> = (<span class="keywordtype">unsigned</span> int) (posMsg-&gt;getPosition().x/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
            <a class="code" href="classPubSubMMOG.html#aa43137704c5ad5a9fecbff8a01ce38bc">currentRegionY</a> = (<span class="keywordtype">unsigned</span> int) (posMsg-&gt;getPosition().y/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
        }
        <span class="keyword">delete</span> msg;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac7e55bce3aa2a48f4367977e081eb9e1"></a><!-- doxytag: member="PubSubMMOG::handleBackupCall" ref="ac7e55bce3aa2a48f4367977e081eb9e1" args="(PubSubBackupCall *backupCall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleBackupCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubBackupCall.html">PubSubBackupCall</a> *&#160;</td>
          <td class="paramname"><em>backupCall</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00799">799</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> intId = backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a78774c6987e65617ae00b8f896f2963b">getSubspaceId</a>();
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(intId, <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);

    <span class="comment">// Start Heartbeat Timer</span>
    <a class="code" href="classPubSubTimer.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubTimer</a>* <a class="code" href="classPubSubMMOG.html#a98fd6baf72474a184c902133581273fa">parentTimeout</a> = <span class="keyword">new</span> <a class="code" href="classPubSubTimer.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubTimer</a>(<span class="stringliteral">&quot;ParentTimeout&quot;</span>);
    parentTimeout-&gt;<a class="code" href="classPubSubTimer.html#a041b4f4cc94f506b4b94877957509834">setType</a>( <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04cad6da37474996a5016fe145fcc24a52c8">PUBSUB_PARENT_TIMEOUT</a> );
    parentTimeout-&gt;<a class="code" href="classPubSubTimer.html#ac30a1d05ecd5da48e689ddb8136a89bc">setSubspaceId</a>( intId );
    <a class="code" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a>( parentTimeout );

    <span class="comment">// insert subspace into responsible list</span>
    <a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> subspace( subspaceId );
    subspace.setResponsibleNode( backupCall-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>() );
    subspace.setHeartbeatTimer( parentTimeout );

    <span class="comment">// recounstruct load balancing tree</span>
    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a2212ccff087366a67e9a2d1fa78f561c">getIntermediatesArraySize</a>(); ++i ){
        <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a> iNode;
        iNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> = backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a613d13441964c55384fd9aff6c260c65">getIntermediates</a>(i);
        subspace.intermediateNodes.push_back( iNode );
    }
    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a25900d74688009c610a11996861cd2cc">getChildrenArraySize</a>(); ++i ){
        <span class="keywordtype">int</span> pos = backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#ae6261425fc1f1b5eb1febe963b14e386">getChildrenPos</a>( i );
        <span class="keywordflow">if</span>( pos == -2 ){
            subspace.cachedChildren.insert( make_pair( backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a3038e30f56f73cb460d72bbee8b2f13d">getChildren</a>(i), false ));
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pos == -1 ){
            subspace.children.insert( backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a3038e30f56f73cb460d72bbee8b2f13d">getChildren</a>(i) );
        } <span class="keywordflow">else</span> {
            subspace.intermediateNodes[pos].children.insert( backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a3038e30f56f73cb460d72bbee8b2f13d">getChildren</a>(i) );
        }
    }

    <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.insert( make_pair(subspaceId, subspace) );

    <a class="code" href="classPubSubBackupResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupResponse</a>* backupResp = <span class="keyword">new</span> <a class="code" href="classPubSubBackupResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupResponse</a>(<span class="stringliteral">&quot;I&#39;ll be your backup&quot;</span>);
    backupResp-&gt;<a class="code" href="classPubSubBackupResponse.html#a0c582d92fb30f36845f104ac42995d0a">setSubspaceId</a>( intId );
    backupResp-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a3a767754300bd5331a8bfabb54477377">PUBSUB_BACKUPRESPONSE_L</a>( backupResp ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= backupResp-&gt;getByteLength()
            );
    <a class="code" href="classBaseRpc.html#adc06091d348c98a5efbf54fe0afe8747" title="Send Remote-Procedure response message and deletes call message.">sendRpcResponse</a>( backupCall, backupResp );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a217e815ddc5ba02f8afe33a73389184f"></a><!-- doxytag: member="PubSubMMOG::handleBackupCallTimeout" ref="a217e815ddc5ba02f8afe33a73389184f" args="(PubSubBackupCall *backupCall, const TransportAddress &amp;oldNode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleBackupCallTimeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubBackupCall.html">PubSubBackupCall</a> *&#160;</td>
          <td class="paramname"><em>backupCall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>oldNode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01288">1288</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// FIXME: cast oldNode to NodeHandle</span>
    <span class="comment">// Inform Lobbyserver over failed node</span>
    <a class="code" href="classPubSubFailedNodeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubFailedNodeMessage</a>* failedNode = <span class="keyword">new</span> <a class="code" href="classPubSubFailedNodeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubFailedNodeMessage</a>(<span class="stringliteral">&quot;Node failed&quot;</span>);
    failedNode-&gt;<a class="code" href="classPubSubFailedNodeMessage.html#a69484c6b7387a623c18edb86a0aca7d3">setFailedNode</a>( oldNode );
    failedNode-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#acb366745fb62311b100b1632b04b1141">PUBSUB_FAILEDNODE_L</a>( failedNode ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= failedNode-&gt;getByteLength()
            );
    <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, failedNode );

    <span class="comment">// Request new Backup</span>
    <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>* helpCall = <span class="keyword">new</span> <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>(<span class="stringliteral">&quot;I need a backup node&quot;</span>);
    helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a15d480c842e84416cea15f69225be7f9">setHelpType</a>( <a class="code" href="PubSubMessage__m_8h.html#a0a7abf0acc5a382f3b386ab1a09cd07aaa575d5ab279429401172053d228e4838">PUBSUB_BACKUP</a> );
    helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a5e3fd97479f76170ffbfcea6385dcd16">setSubspaceId</a>( backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a78774c6987e65617ae00b8f896f2963b">getSubspaceId</a>() );
    helpCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#aac95c8ba038a0a9dd3671a29330493a9">PUBSUB_HELPCALL_L</a>( helpCall ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            pubSubSignalingMessagesSize+= helpCall-&gt;getByteLength()
            );
    <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, helpCall );

    <span class="comment">// find appropriate subspace and mark backup as failed</span>
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a78774c6987e65617ae00b8f896f2963b">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.find( subspaceId );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ) {
        <span class="keywordflow">return</span>;
    }
    it-&gt;second.setBackupNode( <a class="code" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6" title="the unspecified NodeHandle">NodeHandle::UNSPECIFIED_NODE</a> );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a401659ffbdca793a6f7d97e9737a70d0"></a><!-- doxytag: member="PubSubMMOG::handleBackupResponse" ref="a401659ffbdca793a6f7d97e9737a70d0" args="(PubSubBackupResponse *backupResp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleBackupResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubBackupResponse.html">PubSubBackupResponse</a> *&#160;</td>
          <td class="paramname"><em>backupResp</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00844">844</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Nothing to be done</span>
    <span class="comment">// HandleHelpResponse() already did everything important</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7d28b4484518dcf34fbc2cb462bf620b"></a><!-- doxytag: member="PubSubMMOG::handleHelpResponse" ref="a7d28b4484518dcf34fbc2cb462bf620b" args="(PubSubHelpResponse *helpResp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleHelpResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubHelpResponse.html">PubSubHelpResponse</a> *&#160;</td>
          <td class="paramname"><em>helpResp</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00722">722</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
   <span class="comment">// lobby server answered our call for help</span>
   <span class="comment">// (i.e. he sends us a candidate for backup/intermediate nodes</span>
    <span class="keywordflow">if</span>( helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a22f7d6407dbc34eed5cab79a3a0d27bb">getHelpType</a>() == <a class="code" href="PubSubMessage__m_8h.html#a0a7abf0acc5a382f3b386ab1a09cd07aaa575d5ab279429401172053d228e4838">PUBSUB_BACKUP</a> ){
        <a class="code" href="classPubSubBackupCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupCall</a>* backupCall = <span class="keyword">new</span> <a class="code" href="classPubSubBackupCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupCall</a>(<span class="stringliteral">&quot;Become my backup node!&quot;</span>);
        backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a192bdef5825614d40c092c911dc2151f">setSubspaceId</a>( helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a3dfeaa012bc872e1ebdfe89e57af4e38">getSubspaceId</a>() );

        <span class="comment">// Find the subspace in the subspace map</span>
        std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
        it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a3dfeaa012bc872e1ebdfe89e57af4e38">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );
        <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ){
            EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleHelpResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
               &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
               &lt;&lt; <span class="stringliteral">&quot;  received helpResponse for unknown subspace&quot;</span> &lt;&lt; helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a3dfeaa012bc872e1ebdfe89e57af4e38">getSubspaceId</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
               &lt;&lt; endl;
            <span class="keywordflow">return</span>;
        }
        <a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;

        <span class="comment">// Assume the new backup will not refuse his task</span>
        subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a462a25a436aa25d8cc38310119a5d671">setBackupNode</a>( helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a380c4de936be194d72ff943761e2f6dc">getNode</a>() );

<span class="comment">// FIXME: just for testing</span>
<span class="keywordtype">int</span> iii = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>();
subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
<span class="keywordflow">if</span>( iii != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() ){
    opp_error(<span class="stringliteral">&quot;Huh?&quot;</span>);
}

        <span class="comment">// backup the load balancing tree</span>
        backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a6a950c9a840ca3ab3bddfa5d61f87fa7">setChildrenArraySize</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() );
        backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#ac5761ad291a99fda13ebb23d5adc8f62">setChildrenPosArraySize</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() );
        backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a35e138c413c33667d8c1be7a8f8e84fa">setIntermediatesArraySize</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.size() );

        set&lt;NodeHandle&gt;::iterator childIt;
        map&lt;NodeHandle, bool&gt;::iterator childMapIt;
        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
        <span class="keywordflow">for</span>( childMapIt = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.begin(); childMapIt != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.end(); ++childMapIt ){
            backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a575dc4670196df3a46b2474bc9817a5c">setChildren</a>(i, childMapIt-&gt;first);
            backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#aad92edd6081f8a66956d8181f2edf002">setChildrenPos</a>(i, -2);
            ++i;
        }
        <span class="keywordflow">for</span>( childIt = subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.begin(); childIt != subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.end(); ++childIt ){
            backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a575dc4670196df3a46b2474bc9817a5c">setChildren</a>(i, *childIt);
            backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#aad92edd6081f8a66956d8181f2edf002">setChildrenPos</a>(i, -1);
            ++i;
        }
        <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.size(); ++ii ){
            <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a>&amp; iNode =  subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[ii];
            backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a7e2fb307662983ccaed02c29220116ea">setIntermediates</a>(ii, iNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>);
            <span class="keywordflow">for</span>( childIt = iNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.begin(); childIt != iNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.end(); ++childIt ){
                backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#a575dc4670196df3a46b2474bc9817a5c">setChildren</a>(i, *childIt);
                backupCall-&gt;<a class="code" href="classPubSubBackupCall.html#aad92edd6081f8a66956d8181f2edf002">setChildrenPos</a>(i, ii);
                ++i;
            }
        }

        backupCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a571c4080ef67f0cfe61d2e1a8f80243d">PUBSUB_BACKUPCALL_L</a>( backupCall ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= backupCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a380c4de936be194d72ff943761e2f6dc">getNode</a>(), backupCall );

    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a22f7d6407dbc34eed5cab79a3a0d27bb">getHelpType</a>() == <a class="code" href="PubSubMessage__m_8h.html#a0a7abf0acc5a382f3b386ab1a09cd07aa99501a84d5d53b3a4c78362dc7c7a551">PUBSUB_INTERMEDIATE</a> ){
        <a class="code" href="classPubSubIntermediateCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubIntermediateCall</a>* intermediateCall = <span class="keyword">new</span> <a class="code" href="classPubSubIntermediateCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubIntermediateCall</a>(<span class="stringliteral">&quot;Become my intermediate node!&quot;</span>);
        intermediateCall-&gt;<a class="code" href="classPubSubIntermediateCall.html#ad119a608187e8a5bff2a940caf3b546f">setSubspaceId</a>( helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a3dfeaa012bc872e1ebdfe89e57af4e38">getSubspaceId</a>() );
        intermediateCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a961df784f796bd894a954761e5585e72">PUBSUB_INTERMEDIATECALL_L</a>( intermediateCall ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= intermediateCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( helpResp-&gt;<a class="code" href="classPubSubHelpResponse.html#a380c4de936be194d72ff943761e2f6dc">getNode</a>(), intermediateCall );
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a77b144f6034216ef0184589cf5b4da8d"></a><!-- doxytag: member="PubSubMMOG::handleIntermediateBackup" ref="a77b144f6034216ef0184589cf5b4da8d" args="(PubSubBackupIntermediateMessage *backupMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleIntermediateBackup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubBackupIntermediateMessage.html">PubSubBackupIntermediateMessage</a> *&#160;</td>
          <td class="paramname"><em>backupMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01512">1512</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// find appropriate subspace</span>
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#a29368618e2b7954ae2080f6d3f53cada">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.find( subspaceId );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.end() ) {
        <span class="keywordflow">return</span>;
    }

    <span class="keywordflow">if</span>( backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#ab6e4a0ccaf47b2adde4de6629eee7cd2">getPos</a>() &gt;= (int) it-&gt;second.intermediateNodes.size() ){
        it-&gt;second.intermediateNodes.resize( backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#ab6e4a0ccaf47b2adde4de6629eee7cd2">getPos</a>() + 1 );
    }
    it-&gt;second.intermediateNodes[ backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#ab6e4a0ccaf47b2adde4de6629eee7cd2">getPos</a>() ].node = backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#ae375666139531eea47c20adc4d95437c">getNode</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a77d17c923e8b43f0bf38222dd58d3969"></a><!-- doxytag: member="PubSubMMOG::handleIntermediateCall" ref="a77d17c923e8b43f0bf38222dd58d3969" args="(PubSubIntermediateCall *intermediateCall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleIntermediateCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubIntermediateCall.html">PubSubIntermediateCall</a> *&#160;</td>
          <td class="paramname"><em>intermediateCall</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00850">850</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// insert subspace into intermediate list</span>
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(intermediateCall-&gt;<a class="code" href="classPubSubIntermediateCall.html#aae48f9b0cfa46ea154a2ff0ed6edfb73">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    <a class="code" href="classPubSubSubspaceIntermediate.html">PubSubSubspaceIntermediate</a> subspace( subspaceId );
    subspace.setResponsibleNode( intermediateCall-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>() );
    subspace.setTimestamp(0);
    <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.insert( make_pair(subspaceId, subspace) );

    <a class="code" href="classPubSubIntermediateResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubIntermediateResponse</a>* iResp = <span class="keyword">new</span> <a class="code" href="classPubSubIntermediateResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubIntermediateResponse</a>(<span class="stringliteral">&quot;I&#39;ll be your intermediate node&quot;</span>);
    iResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a37897f58114b66c35ef8b21e99798155">setSubspaceId</a>( intermediateCall-&gt;<a class="code" href="classPubSubIntermediateCall.html#aae48f9b0cfa46ea154a2ff0ed6edfb73">getSubspaceId</a>() );
    iResp-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a520b21326aecd010016e460c12c4a572">PUBSUB_INTERMEDIATERESPONSE_L</a>( iResp ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= iResp-&gt;getByteLength()
            );
    <a class="code" href="classBaseRpc.html#adc06091d348c98a5efbf54fe0afe8747" title="Send Remote-Procedure response message and deletes call message.">sendRpcResponse</a>( intermediateCall, iResp );
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac41702ca41ffae439637504939856f4f"></a><!-- doxytag: member="PubSubMMOG::handleIntermediateResponse" ref="ac41702ca41ffae439637504939856f4f" args="(PubSubIntermediateResponse *intermediateResp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleIntermediateResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubIntermediateResponse.html">PubSubIntermediateResponse</a> *&#160;</td>
          <td class="paramname"><em>intermediateResp</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00869">869</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// we found a new intermediate node for a subspace</span>
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(intermediateResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a10274ee87eb24712c45b63ac3456d835">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ) {
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleIntermediateResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
           &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;  Received Intermediate Response for unknown Subspace!\n&quot;</span>
           &lt;&lt; endl;
        <span class="keywordflow">return</span>;
    }
    <a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;
    <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a> iNode;
    iNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> = intermediateResp-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>();

    <span class="comment">// if there is any broken intermediate node in list, replace it</span>
    <span class="keywordtype">bool</span> newIntermediate = <span class="keyword">true</span>;
    deque&lt;PubSubSubspaceResponsible::IntermediateNode&gt;::iterator iit;
    <span class="keywordflow">for</span>( iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin(); iit != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end(); ++iit ){
        <span class="keywordflow">if</span>( iit-&gt;node.isUnspecified() ){
            iit-&gt;node = iNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>;
            newIntermediate = <span class="keyword">false</span>;
            <span class="keywordflow">break</span>;
        }
    }
    <span class="keywordflow">if</span>( iit == subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end() ){
        subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.push_back( iNode );
        iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end() - 1;
    }

    <span class="comment">// inform Backup</span>
    <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
        <a class="code" href="classPubSubBackupIntermediateMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupIntermediateMessage</a>* backupMsg = <span class="keyword">new</span> <a class="code" href="classPubSubBackupIntermediateMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupIntermediateMessage</a>(<span class="stringliteral">&quot;Backup: new Intermediate&quot;</span>);
        backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#a0619ec8887f931a6167c41624524bdf2">setSubspaceId</a>( intermediateResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a10274ee87eb24712c45b63ac3456d835">getSubspaceId</a>() );
        backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#a3c235e6bf5ac5b52ea93bb8ac612a22a">setNode</a>( iNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> );
        backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#a2b50b84aae0d5fb21f800f7060719cdc">setPos</a>( iit - subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin() );
        backupMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#af0f2565f24c2e5b8e3655c3fb073d887">PUBSUB_BACKUPINTERMEDIATE_L</a>( backupMsg ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= backupMsg-&gt;getByteLength()
                );
        <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>(), backupMsg );
    }

    <span class="comment">// if needed, send adopt to parent</span>
    <span class="keywordtype">int</span> intermediatePos = iit - subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin();
    <span class="keywordtype">int</span> parentPos = intermediatePos/<a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> -1;
    <span class="keywordflow">if</span>( parentPos &gt;= 0 &amp;&amp; !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[parentPos].node.isUnspecified() ){
        <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>* adoptCall = <span class="keyword">new</span> <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>(<span class="stringliteral">&quot;Adopt (intermediate) Node&quot;</span>);
        adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#ad057dff5f1db054f15839a20adb17f8b">setSubspaceId</a>( intermediateResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a10274ee87eb24712c45b63ac3456d835">getSubspaceId</a>() );
        adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a33b972c420b165433c98e9096f08ed79">setChild</a>( iit-&gt;node );
        adoptCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a40172b8994bee9881c879d1f69994013">PUBSUB_ADOPTCHILDCALL_L</a>( adoptCall ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= adoptCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[parentPos].node, adoptCall );
    }

    <span class="keywordflow">if</span>( newIntermediate ){
        <span class="comment">// move one child from iNodes&#39;s parent to cache</span>
        <span class="keywordflow">if</span>( parentPos &gt;= 0 ) {
            <span class="comment">// parent is an intermediate node</span>
            <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a>&amp; parent = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[parentPos];
            <span class="keywordflow">if</span>( parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.begin() != parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.end() ){
                <span class="keywordtype">bool</span> fixNeeded = <span class="keyword">false</span>;
                <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert( make_pair( *(parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.begin()), <span class="keyword">false</span> )).second ){
                    fixNeeded = <span class="keyword">true</span>;
                }
                <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
                    <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>* backupMsg = <span class="keyword">new</span> <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>(<span class="stringliteral">&quot;Backup: nodes moved to cache&quot;</span>);
                    backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#ac8a8edd3c1669fa810598e7d16b4141f">setSubspaceId</a>( intermediateResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a10274ee87eb24712c45b63ac3456d835">getSubspaceId</a>() );
                    backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#af638885c4794f5652c318f21521c5668">setChild</a>( *(parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.begin()) );
                    backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a52fe84752aa0929392cc6c6e7a5d059f">setOldParent</a>( parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> );
                    backupMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a485654404a477aa60cb34dd0ae722258">PUBSUB_BACKUPSUBSCRIPTION_L</a>( backupMsg ));
                    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                            pubSubSignalingMessagesSize+= backupMsg-&gt;getByteLength()
                            );
                    <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>(), backupMsg );
                }
                <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>* goneMsg = <span class="keyword">new</span> <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>(<span class="stringliteral">&quot;Node left: moved&quot;</span>);
                goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a4604631be10c1b8f9aa6db29aaa76386">setNode</a>( *(parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.begin()) );
                goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a74ae8a4726d74370cc59cae590a72ddb">setSubspaceId</a>( intermediateResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a10274ee87eb24712c45b63ac3456d835">getSubspaceId</a>() );
                goneMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#ac2a4c9a20c40c17b2a948f346d5ae4fc">PUBSUB_NODELEFT_L</a>( goneMsg ));
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= goneMsg-&gt;getByteLength()
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>, goneMsg );
                parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.erase( parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.begin() );
                <span class="keywordflow">if</span>( fixNeeded ){
                    subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
                }
            }

        } <span class="keywordflow">else</span> {
            <span class="comment">// we are parent</span>
            <span class="keywordflow">if</span>( subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.begin() != subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.end() ){
                <span class="keywordtype">bool</span> fixNeeded = <span class="keyword">false</span>;
                <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert( make_pair( *(subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.begin()), <span class="keyword">false</span> )).second ){
                    fixNeeded = <span class="keyword">true</span>;
                }
                <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
                    <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>* backupMsg = <span class="keyword">new</span> <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>(<span class="stringliteral">&quot;Backup: nodes moved to cache&quot;</span>);
                    backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#ac8a8edd3c1669fa810598e7d16b4141f">setSubspaceId</a>( intermediateResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a10274ee87eb24712c45b63ac3456d835">getSubspaceId</a>() );
                    backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#af638885c4794f5652c318f21521c5668">setChild</a>( *(subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.begin()) );
                    backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a52fe84752aa0929392cc6c6e7a5d059f">setOldParent</a>( <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> );
                    backupMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a485654404a477aa60cb34dd0ae722258">PUBSUB_BACKUPSUBSCRIPTION_L</a>( backupMsg ));
                    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                            pubSubSignalingMessagesSize+= backupMsg-&gt;getByteLength()
                            );
                    <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>(), backupMsg );
                }
                subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.erase( *(subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.begin()) );
                <span class="keywordflow">if</span>( fixNeeded ){
                    subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
                }
            }
        }
    } <span class="keywordflow">else</span> {
        <span class="comment">// send adopt for all children intermediates</span>
        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> pos = (intermediatePos+1) * <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a>; pos &lt; (int) subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.size() &amp;&amp;
                pos &lt; (intermediatePos+2) * <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a>; ++pos ){
            <span class="keywordflow">if</span>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[pos].node.isUnspecified() ) <span class="keywordflow">continue</span>;
            <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>* adoptCall = <span class="keyword">new</span> <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>(<span class="stringliteral">&quot;Adopt (intermediate) Node&quot;</span>);
            adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#ad057dff5f1db054f15839a20adb17f8b">setSubspaceId</a>( intermediateResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a10274ee87eb24712c45b63ac3456d835">getSubspaceId</a>() );
            adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a33b972c420b165433c98e9096f08ed79">setChild</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[pos].node );
            adoptCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a40172b8994bee9881c879d1f69994013">PUBSUB_ADOPTCHILDCALL_L</a>( adoptCall ));
            <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                    ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                    pubSubSignalingMessagesSize+= adoptCall-&gt;getByteLength()
                    );
            <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( iit-&gt;node, adoptCall );
        }
    }

    <span class="comment">// move as many cached children to the new node as possible</span>
    std::map&lt;NodeHandle,bool&gt;::iterator childIt;
    <span class="keywordflow">for</span>( childIt = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.begin(); childIt != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.end(); ++childIt ){
        <span class="keywordflow">if</span>( childIt-&gt;second ) <span class="keywordflow">continue</span>;
        <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>* adoptCall = <span class="keyword">new</span> <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>(<span class="stringliteral">&quot;Adopt Node&quot;</span>);
        adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#ad057dff5f1db054f15839a20adb17f8b">setSubspaceId</a>( intermediateResp-&gt;<a class="code" href="classPubSubIntermediateResponse.html#a10274ee87eb24712c45b63ac3456d835">getSubspaceId</a>() );
        adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a33b972c420b165433c98e9096f08ed79">setChild</a>( childIt-&gt;first );
        adoptCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a40172b8994bee9881c879d1f69994013">PUBSUB_ADOPTCHILDCALL_L</a>( adoptCall ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= adoptCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( intermediateResp-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>(), adoptCall );
        childIt-&gt;second = <span class="keyword">true</span>;
        <span class="keywordflow">if</span>( (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> == ++(iit-&gt;waitingChildren) ) <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a90f7b9fa68b400b80892d642f4c439b4"></a><!-- doxytag: member="PubSubMMOG::handleJoinResponse" ref="a90f7b9fa68b400b80892d642f4c439b4" args="(PubSubJoinResponse *joinResp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleJoinResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubJoinResponse.html">PubSubJoinResponse</a> *&#160;</td>
          <td class="paramname"><em>joinResp</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00367">367</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> = <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fa40c37f1f56c6ed8e40ae467e67e61cab">JOIN</a>;
    <a class="code" href="classPubSubMMOG.html#a3e573d9ce39091daea435016a587b239">setBootstrapedIcon</a>();
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> region( <a class="code" href="classPubSubMMOG.html#a6adc937050de85cfcffa4561b6daee84">currentRegionX</a>, <a class="code" href="classPubSubMMOG.html#aa43137704c5ad5a9fecbff8a01ce38bc">currentRegionY</a>, <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);

    <a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a> respNode = joinResp-&gt;<a class="code" href="classPubSubJoinResponse.html#af6b6ef0423fb75458fdde7f977ad8623">getResponsibleNode</a>();
    <a class="code" href="classPubSubSubspace.html">PubSubSubspace</a> sub(region);
    sub.setResponsibleNode( respNode );
    <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.push_back( sub );
    <span class="keywordflow">if</span>( respNode.<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ) {
        <a class="code" href="classPubSubResponsibleNodeCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubResponsibleNodeCall</a>* respCall = <span class="keyword">new</span> <a class="code" href="classPubSubResponsibleNodeCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubResponsibleNodeCall</a>(<span class="stringliteral">&quot;Request Responsible NodeHandle&quot;</span>);
        respCall-&gt;<a class="code" href="classPubSubResponsibleNodeCall.html#a2bf680eb93832016647c1dfbdc6618ca">setSubspacePos</a>( <a class="code" href="classVector2D.html">Vector2D</a>(<a class="code" href="classPubSubMMOG.html#a6adc937050de85cfcffa4561b6daee84">currentRegionX</a>, <a class="code" href="classPubSubMMOG.html#aa43137704c5ad5a9fecbff8a01ce38bc">currentRegionY</a>) );
        respCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a5d4e7d4a5b91386ccba0e0a03330ab9d">PUBSUB_RESPONSIBLENODECALL_L</a>( respCall ) );
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= respCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, respCall, NULL, 5, 5 ); <span class="comment">// FIXME: Make it a parameter...</span>
    } <span class="keywordflow">else</span> {
        <a class="code" href="classPubSubSubscriptionCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubSubscriptionCall</a>* subCall = <span class="keyword">new</span> <a class="code" href="classPubSubSubscriptionCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubSubscriptionCall</a>(<span class="stringliteral">&quot;JoinSubspace&quot;</span>);
        subCall-&gt;<a class="code" href="classPubSubSubscriptionCall.html#a8b0793692afe779cf03bd1081fa60a6f">setSubspaceId</a>( region.getId() );
        subCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a2b5451b24d68787636358002b3292042">PUBSUB_SUBSCRIPTIONCALL_L</a>( subCall ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= subCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( respNode, subCall );
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a271c0f8b14c7c023c26a1a3f19e156a4"></a><!-- doxytag: member="PubSubMMOG::handleMove" ref="a271c0f8b14c7c023c26a1a3f19e156a4" args="(GameAPIPositionMessage *posMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleMove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGameAPIPositionMessage.html">GameAPIPositionMessage</a> *&#160;</td>
          <td class="paramname"><em>posMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00541">541</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classPubSubMMOG.html#a6adc937050de85cfcffa4561b6daee84">currentRegionX</a> = (<span class="keywordtype">unsigned</span> int) (posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac5c4e553815737aa24bec8281270178f">x</a>/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <a class="code" href="classPubSubMMOG.html#aa43137704c5ad5a9fecbff8a01ce38bc">currentRegionY</a> = (<span class="keywordtype">unsigned</span> int) (posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac38d0179cfe74c30fee290a703ab209a">y</a>/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);

    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> region( <a class="code" href="classPubSubMMOG.html#a6adc937050de85cfcffa4561b6daee84">currentRegionX</a>, <a class="code" href="classPubSubMMOG.html#aa43137704c5ad5a9fecbff8a01ce38bc">currentRegionY</a>, <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);

    set&lt;PubSubSubspaceId&gt; expectedRegions;
    <span class="keywordtype">int</span> minX = (int) ((posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac5c4e553815737aa24bec8281270178f">x</a> - <a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>)/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <span class="keywordflow">if</span>( minX &lt; 0 ) minX = 0;
    <span class="keywordtype">int</span> maxX = (int) ((posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac5c4e553815737aa24bec8281270178f">x</a> + <a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>)/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <span class="keywordflow">if</span>( maxX &gt;= <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> ) maxX = <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> -1;
    <span class="keywordtype">int</span> minY = (int) ((posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac38d0179cfe74c30fee290a703ab209a">y</a> - <a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>)/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <span class="keywordflow">if</span>( minY &lt; 0 ) minY = 0;
    <span class="keywordtype">int</span> maxY = (int) ((posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac38d0179cfe74c30fee290a703ab209a">y</a> + <a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>)/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <span class="keywordflow">if</span>( maxY &gt;= <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> ) maxY = <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> -1;

    <span class="comment">// FIXME: make parameter: unsubscription size</span>
    <span class="keywordtype">int</span> minUnsubX = (int) ((posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac5c4e553815737aa24bec8281270178f">x</a> - 1.5*<a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>)/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <span class="keywordflow">if</span>( minUnsubX &lt; 0 ) minUnsubX = 0;
    <span class="keywordtype">int</span> maxUnsubX = (int) ((posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac5c4e553815737aa24bec8281270178f">x</a> + 1.5*<a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>)/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <span class="keywordflow">if</span>( maxUnsubX &gt;= <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> ) maxUnsubX = <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> -1;
    <span class="keywordtype">int</span> minUnsubY = (int) ((posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac38d0179cfe74c30fee290a703ab209a">y</a> - 1.5*<a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>)/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <span class="keywordflow">if</span>( minUnsubY &lt; 0 ) minUnsubY = 0;
    <span class="keywordtype">int</span> maxUnsubY = (int) ((posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>().<a class="code" href="classVector2D.html#ac38d0179cfe74c30fee290a703ab209a">y</a> + 1.5+<a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>)/<a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a>);
    <span class="keywordflow">if</span>( maxUnsubY &gt;= <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> ) maxUnsubY = <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> -1;

    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = minX; x &lt;= maxX; ++x ){
        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> y = minY; y &lt;= maxY; ++y ){
            expectedRegions.insert( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>( x, y, <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> ));
        }
    }

    list&lt;PubSubSubspace&gt;::iterator subIt = <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.begin();
    <a class="code" href="classPubSubSubspace.html">PubSubSubspace</a>* subspace = NULL;
    <span class="keywordflow">while</span>( subIt != <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.end() ){
        <span class="keywordflow">if</span>( subIt-&gt;getId() == region ){
            subspace = &amp;*subIt;
        }
        expectedRegions.erase( subIt-&gt;getId() );

        <span class="comment">// unsubscribe region if to far away</span>
        <span class="keywordflow">if</span>( subIt-&gt;getId().getX() &lt; minX || subIt-&gt;getId().getX() &gt; maxX ||
                subIt-&gt;getId().getY() &lt; minY || subIt-&gt;getId().getY() &gt; maxY ){
            <span class="keywordflow">if</span>( !subIt-&gt;getResponsibleNode().isUnspecified() ){
                <a class="code" href="classPubSubUnsubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubUnsubscriptionMessage</a>* unsubMsg = <span class="keyword">new</span> <a class="code" href="classPubSubUnsubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubUnsubscriptionMessage</a>(<span class="stringliteral">&quot;Unsubscribe from subspace&quot;</span>);
                unsubMsg-&gt;<a class="code" href="classPubSubUnsubscriptionMessage.html#a2f04866a86a8d5df84d88bd17a06516e">setSubspaceId</a>( subIt-&gt;getId().getId() );
                unsubMsg-&gt;<a class="code" href="classPubSubUnsubscriptionMessage.html#acd1f9c51a3483ee3b8e5fcfdc4e0ebb5">setSrc</a>( <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> );
                unsubMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a88c175706edd5bdd237ad0768aeb6ef8">PUBSUB_UNSUBSCRIPTION_L</a>( unsubMsg ));
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= unsubMsg-&gt;getByteLength()
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subIt-&gt;getResponsibleNode(), unsubMsg );
            }
            <span class="comment">// Erase subspace from subscribedList and increase iterator</span>
            <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.erase( subIt++ );
        } <span class="keywordflow">else</span> {
            ++subIt;
        }
    }

    <span class="comment">// if any &quot;near&quot; region is not yet subscribed, subscribe</span>
    <span class="keywordflow">for</span>( set&lt;PubSubSubspaceId&gt;::iterator regionIt = expectedRegions.begin(); regionIt != expectedRegions.end(); ++regionIt ){
        <a class="code" href="classPubSubSubspace.html">PubSubSubspace</a> sub( *regionIt );
        <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.push_back( sub );
        <a class="code" href="classPubSubResponsibleNodeCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubResponsibleNodeCall</a>* respCall = <span class="keyword">new</span> <a class="code" href="classPubSubResponsibleNodeCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubResponsibleNodeCall</a>(<span class="stringliteral">&quot;Request Responsible NodeHandle&quot;</span>);
        respCall-&gt;<a class="code" href="classPubSubResponsibleNodeCall.html#a2bf680eb93832016647c1dfbdc6618ca">setSubspacePos</a>( <a class="code" href="classVector2D.html">Vector2D</a>(regionIt-&gt;getX(), regionIt-&gt;getY()) );
        respCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a5d4e7d4a5b91386ccba0e0a03330ab9d">PUBSUB_RESPONSIBLENODECALL_L</a>( respCall ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= respCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, respCall, NULL, 5, 5 ); <span class="comment">// FIXME: Make it a parameter...</span>
    }

    <span class="keywordflow">if</span>( subspace &amp;&amp; !subspace-&gt;<a class="code" href="classPubSubSubspace.html#a996b0242f4c47164d5ee2141755d8fb1">getResponsibleNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
        <a class="code" href="classPubSubMoveMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubMoveMessage</a>* moveMsg = <span class="keyword">new</span> <a class="code" href="classPubSubMoveMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubMoveMessage</a>(<span class="stringliteral">&quot;Player move&quot;</span>);
        moveMsg-&gt;<a class="code" href="classPubSubMoveMessage.html#a383f68c7b8594fa08b87b85b5ca6fa48">setSubspaceId</a>( region.getId() );
        moveMsg-&gt;<a class="code" href="classPubSubMoveMessage.html#a96b0721fb30bf0a20b34215e90a2780b">setPlayer</a>( <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> );
        moveMsg-&gt;<a class="code" href="classPubSubMoveMessage.html#ac1d2aa4cbadc7c386c8a22f455c015cc">setPosition</a>( posMsg-&gt;<a class="code" href="classGameAPIPositionMessage.html#a62cb5e229193a2e0118e240de2494d53">getPosition</a>() );
        moveMsg-&gt;<a class="code" href="classPubSubMoveMessage.html#a670813b9282cf62aa089d6784f3dfd78">setTimestamp</a>( simTime() );
        moveMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a07feb8f3c2aaad5db67ec6860dec5c5d">PUBSUB_MOVE_L</a>( moveMsg ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#a11ca86e89977d8bb4d1512a5e64ce8d3">numMoveMessages</a>;
                <a class="code" href="classPubSubMMOG.html#a122b6f4eacfc82a453cdabace026a0d5">moveMessagesSize</a>+= moveMsg-&gt;getByteLength()
                );
        <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subspace-&gt;<a class="code" href="classPubSubSubspace.html#a996b0242f4c47164d5ee2141755d8fb1">getResponsibleNode</a>(), moveMsg );
    } <span class="keywordflow">else</span> {
        <span class="comment">// trying to move to not-yet subscribed region</span>
        <span class="comment">// FIXME: change state to JOIN?</span>
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9d46909d81ca32d3ec2020a7184c3f50"></a><!-- doxytag: member="PubSubMMOG::handleMoveListMessage" ref="a9d46909d81ca32d3ec2020a7184c3f50" args="(PubSubMoveListMessage *moveMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleMoveListMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubMoveListMessage.html">PubSubMoveListMessage</a> *&#160;</td>
          <td class="paramname"><em>moveMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00666">666</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    simtime_t timestamp = moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#a3d67a3591e45877525dbd887bd3406d0">getTimestamp</a>();

    <span class="comment">// If I&#39;m intermediate node for this subspace, forward message to children</span>
    std::map&lt;PubSubSubspaceId, PubSubSubspaceIntermediate&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#ac3f12e1ebacfa47cfcdfb5d032be6a55">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );
    <span class="keywordflow">if</span>( it != <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.end() ){
        <span class="comment">// Forward only if the message has not already been forwarded</span>
        <span class="keywordflow">if</span>( it-&gt;second.getLastTimestamp() &lt; moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#a3d67a3591e45877525dbd887bd3406d0">getTimestamp</a>() ){
            set&lt;NodeHandle&gt;::iterator childIt;
            <span class="keywordflow">for</span>( childIt = it-&gt;second.children.begin(); childIt != it-&gt;second.children.end(); ++childIt ){
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( *childIt, (<a class="code" href="classBaseOverlayMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseOverlayMessage</a>*) moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#a5d61d0f12b29063f944e6fd5775d3da7">dup</a>() );
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">numMoveListMessages</a>;
                        <a class="code" href="classPubSubMMOG.html#a5a665dd74681081d669ea57efd5d83b0">moveListMessagesSize</a>+= moveMsg-&gt;getByteLength()
                        );
            }
            it-&gt;second.setTimestamp( timestamp );
        }
    }

    <span class="comment">// If I&#39;m subscribed to the subspace, transfer a GameAPIMoveList to app</span>
    std::list&lt;PubSubSubspace&gt;::iterator subIt;
    <span class="keywordflow">for</span>( subIt = <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.begin(); subIt != <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.end(); ++subIt ){
        <span class="keywordflow">if</span>( subIt-&gt;getId().getId() == moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#ac3f12e1ebacfa47cfcdfb5d032be6a55">getSubspaceId</a>() ){
            <span class="keywordflow">if</span>( subIt-&gt;getLastTimestamp() &lt; moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#a3d67a3591e45877525dbd887bd3406d0">getTimestamp</a>() ){
                <a class="code" href="classGameAPIListMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">GameAPIListMessage</a>* moveList = <span class="keyword">new</span> <a class="code" href="classGameAPIListMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">GameAPIListMessage</a>(<span class="stringliteral">&quot;player position update&quot;</span>);
                moveList-&gt;<a class="code" href="classGameAPIMessage.html#a3fe3071c66623191477b903527280ddc">setCommand</a>( <a class="code" href="CommonMessages__m_8h.html#ac76e82bc37e4b2b364247c7cff8f7b6ba360dbdf5c7f61a4d26263e2a010057d7">NEIGHBOR_UPDATE</a> );
                moveList-&gt;<a class="code" href="classGameAPIListMessage.html#a6bac1604abbdf9c0ec959343b7b64834">setAddNeighborArraySize</a>( moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#aa41dbdd97c91926ec1b86116a9750802">getPlayerArraySize</a>() );
                moveList-&gt;<a class="code" href="classGameAPIListMessage.html#a81292ede7c0903f5982efcc7625024f1">setNeighborPositionArraySize</a>( moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#a2f87ee7e50d5d28b31f86dd2cc219d63">getPositionArraySize</a>() );
                <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#aa41dbdd97c91926ec1b86116a9750802">getPlayerArraySize</a>(); ++i ){
                    moveList-&gt;<a class="code" href="classGameAPIListMessage.html#a6fdd2736b4eaabac3e90a623f0e8e130">setAddNeighbor</a>( i, moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#a6c8be50200570e0c4c45dd809c3b5dbe">getPlayer</a>(i) );
                    moveList-&gt;<a class="code" href="classGameAPIListMessage.html#ad91052c0577545e987bf5b08244ece9e">setNeighborPosition</a>( i, moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#a59cce8e96288c2874df9d3fe72096fa8">getPosition</a>(i) );
                    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        <a class="code" href="classBaseRpc.html#a9552ba3a2b09c83b3c561e65dab9f23d" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;PubSubMMOG: MoveDelay&quot;</span>,
                                SIMTIME_DBL(simTime() - timestamp + moveMsg-&gt;<a class="code" href="classPubSubMoveListMessage.html#a75c129b174b7e91b314cb13c475f3021">getPositionAge</a>(i)) );
                        );
                }
                send( moveList, <span class="stringliteral">&quot;appOut&quot;</span> );
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        <span class="keywordflow">if</span>( timestamp &lt; simTime() - <a class="code" href="classPubSubMMOG.html#a219753e4fc3eae95cd21f70bc40017e7">maxMoveDelay</a> ){
                            ++<a class="code" href="classPubSubMMOG.html#a1450e36b5a7103fe4581f271fac13340">lostMovementLists</a>;
                        } <span class="keywordflow">else</span> {
                            ++<a class="code" href="classPubSubMMOG.html#a8415fe6a47b3b961fd54f9e3b5f8d3f0">receivedMovementLists</a>;
                        }
                        <span class="keywordflow">if</span>( subIt-&gt;getLastTimestamp() != 0) <a class="code" href="classPubSubMMOG.html#a1450e36b5a7103fe4581f271fac13340">lostMovementLists</a> += (<span class="keywordtype">int</span>)(SIMTIME_DBL(timestamp - subIt-&gt;getLastTimestamp())*<a class="code" href="classPubSubMMOG.html#a228fe6f61d1fe510d1336296c4bf254c">movementRate</a> -1);

                        );
                subIt-&gt;setTimestamp( timestamp );
            }
            <span class="keywordflow">return</span>;
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa5f5b3bb6f7a4a26ab45dfdb6248f21b"></a><!-- doxytag: member="PubSubMMOG::handleMoveMessage" ref="aa5f5b3bb6f7a4a26ab45dfdb6248f21b" args="(PubSubMoveMessage *moveMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleMoveMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubMoveMessage.html">PubSubMoveMessage</a> *&#160;</td>
          <td class="paramname"><em>moveMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00635">635</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(moveMsg-&gt;<a class="code" href="classPubSubMoveMessage.html#ac5824dff148c7bface7054d5c257e14d">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ){
         EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleMoveMessage() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;  received moveMessage for unknown subspace&quot;</span> &lt;&lt; moveMsg-&gt;<a class="code" href="classPubSubMoveMessage.html#ac5824dff148c7bface7054d5c257e14d">getSubspaceId</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; endl;
        <span class="keywordflow">return</span>;
    }

    <span class="comment">// If message arrived in the correct timeslot, store move message until deadline</span>
    <span class="comment">// Note: This assumes, we get no messages with future timestamps. At least in</span>
    <span class="comment">// the simulation, this assumption will hold.</span>
    <span class="comment">// The allowOldMoveMessages parameter allows overriding the timeslot barriers and forward all</span>
    <span class="comment">// messages.</span>
    <span class="keywordflow">if</span>( <a class="code" href="classPubSubMMOG.html#aced8c7945b0f77560359167cc5f398f6">allowOldMoveMessages</a> || moveMsg-&gt;<a class="code" href="classPubSubMoveMessage.html#a6cbaea29f897c198f6de3afa14226055">getTimestamp</a>() &gt;= <a class="code" href="classPubSubMMOG.html#a5c7d73c47298f65748e65abc506b9611">eventDeliveryTimer</a>-&gt;getArrivalTime() - 1.0/(2*<a class="code" href="classPubSubMMOG.html#a228fe6f61d1fe510d1336296c4bf254c">movementRate</a>) ){
        it-&gt;second.waitingMoveMessages.push_back( moveMsg );
        ++<a class="code" href="classPubSubMMOG.html#a0adb17b77190fd14c0979fe39a5889cc">numEventsCorrectTimeslot</a>;
    } <span class="keywordflow">else</span> {
         EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleMoveMessage() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;  received moveMesage with Timestamp: &quot;</span> &lt;&lt; moveMsg-&gt;<a class="code" href="classPubSubMoveMessage.html#a6cbaea29f897c198f6de3afa14226055">getTimestamp</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;  deadline was: &quot;</span> &lt;&lt; <a class="code" href="classPubSubMMOG.html#a5c7d73c47298f65748e65abc506b9611">eventDeliveryTimer</a>-&gt;getArrivalTime() - 1.0/(2*<a class="code" href="classPubSubMMOG.html#a228fe6f61d1fe510d1336296c4bf254c">movementRate</a>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; endl;
        ++<a class="code" href="classPubSubMMOG.html#aa809123a9ef7f64ea622400ed60a2d4c">numEventsWrongTimeslot</a>;
        cancelAndDelete( moveMsg );
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a73afcba7483897f08cfb5d258e569683"></a><!-- doxytag: member="PubSubMMOG::handleNodeLeftMessage" ref="a73afcba7483897f08cfb5d258e569683" args="(PubSubNodeLeftMessage *leftMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleNodeLeftMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubNodeLeftMessage.html">PubSubNodeLeftMessage</a> *&#160;</td>
          <td class="paramname"><em>leftMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00432">432</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::map&lt;PubSubSubspaceId, PubSubSubspaceIntermediate&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(leftMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a5bdc2448771e8e102f2a1742669e3ff4">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );

    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.end() ) <span class="keywordflow">return</span>;

    it-&gt;second.removeChild( leftMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a3ade8236d7ce506a1805f3e1f7aa87d8">getNode</a>() );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a01a6bc8e4b0e38e57d2e3108088f67f3"></a><!-- doxytag: member="PubSubMMOG::handleParentTimeout" ref="a01a6bc8e4b0e38e57d2e3108088f67f3" args="(PubSubTimer *timer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleParentTimeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubTimer.html">PubSubTimer</a> *&#160;</td>
          <td class="paramname"><em>timer</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01260">1260</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// our parent timed out. we have to take over the subspace...</span>
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(timer-&gt;<a class="code" href="classPubSubTimer.html#a5d7727faa7e6264688af6211880bbff8">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.find( subspaceId );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.end() ) {
        <span class="keyword">delete</span> timer;
        <span class="keywordflow">return</span>;
    }

    <span class="comment">// increase fail count; if to high, take over subspace</span>
    it-&gt;second.incHeartbeatFailCount();
    <span class="keywordflow">if</span>( it-&gt;second.getHeartbeatFailCount() &gt; 1 ) { <span class="comment">// FIXME: make it a parameter</span>

        <span class="comment">// Delete Timer</span>
        cancelAndDelete( timer );
        it-&gt;second.setHeartbeatTimer( NULL );

        <span class="comment">// Take over Subspace</span>
        <a class="code" href="classPubSubMMOG.html#a60f9145524471fe4aa44641f1d0e6a17">takeOverSubspace</a>( it-&gt;second );
        <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.erase( it );

    } <span class="keywordflow">else</span> {
        <a class="code" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a>( timer );
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7179d8d2355f09e50e5172a8bc4e60b1"></a><!-- doxytag: member="PubSubMMOG::handlePingCall" ref="a7179d8d2355f09e50e5172a8bc4e60b1" args="(PubSubPingCall *hearbeatCall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handlePingCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubPingCall.html">PubSubPingCall</a> *&#160;</td>
          <td class="paramname"><em>hearbeatCall</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01140">1140</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> subspaceId = pingCall-&gt;getSubspaceId();

    <span class="keywordflow">if</span>( pingCall-&gt;getPingType() == <a class="code" href="PubSubMessage__m_8h.html#a955af4961bb8702caeddf04706c0681ba4bcfe90f539ae081948077a9d0c1d992">PUBSUB_PING_BACKUP</a> ){
        <span class="comment">// reset heartbeat timer</span>
        std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
        it = <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(pingCall-&gt;getSubspaceId(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );
        <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.end() ) {
            EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handlePingCall() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
               &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
               &lt;&lt; <span class="stringliteral">&quot;  Received PingCall for unknown Subspace!\n&quot;</span>
               &lt;&lt; endl;
            <span class="comment">// FIXME: Somebody thinks we are his backup. What shall we do?</span>
        } <span class="keywordflow">else</span> {
            it-&gt;second.resetHeartbeatFailCount();
            <a class="code" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a>( it-&gt;second.getHeartbeatTimer() );
        }
    }

    <a class="code" href="classPubSubPingResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubPingResponse</a>* pingResp = <span class="keyword">new</span> <a class="code" href="classPubSubPingResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubPingResponse</a>(<span class="stringliteral">&quot;PingResponse&quot;</span>);
    pingResp-&gt;<a class="code" href="classPubSubPingResponse.html#a57e8722a1871166499e54fd1ecb4e30f">setSubspaceId</a>( subspaceId );
    pingResp-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a9221c16747bc0f1ebce9a85e72a5d479">PUBSUB_PINGRESPONSE_L</a>( pingResp ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= pingResp-&gt;getByteLength()
            );
    <a class="code" href="classBaseRpc.html#adc06091d348c98a5efbf54fe0afe8747" title="Send Remote-Procedure response message and deletes call message.">sendRpcResponse</a>( pingCall, pingResp );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0ca3bd97cac131ba5c2ff02235cc6a2f"></a><!-- doxytag: member="PubSubMMOG::handlePingCallTimeout" ref="a0ca3bd97cac131ba5c2ff02235cc6a2f" args="(PubSubPingCall *pingCall, const TransportAddress &amp;oldNode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handlePingCallTimeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubPingCall.html">PubSubPingCall</a> *&#160;</td>
          <td class="paramname"><em>pingCall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>oldNode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01322">1322</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Inform Lobbyserver over failed node</span>
    <span class="keyword">const</span> <a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a>&amp; oldNodeHandle = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a>&amp;<span class="keyword">&gt;</span>(oldNode);
    <span class="comment">// FIXME: use oldNodeHandle instead of oldNode</span>
    <a class="code" href="classPubSubFailedNodeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubFailedNodeMessage</a>* failedNode = <span class="keyword">new</span> <a class="code" href="classPubSubFailedNodeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubFailedNodeMessage</a>(<span class="stringliteral">&quot;Node failed&quot;</span>);
    failedNode-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#acb366745fb62311b100b1632b04b1141">PUBSUB_FAILEDNODE_L</a>( failedNode ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= failedNode-&gt;getByteLength()
            );
    failedNode-&gt;<a class="code" href="classPubSubFailedNodeMessage.html#a69484c6b7387a623c18edb86a0aca7d3">setFailedNode</a>( oldNode );
    <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, failedNode );

    <span class="comment">// find appropriate subspace</span>
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(pingCall-&gt;<a class="code" href="classPubSubPingCall.html#a6c09797ec1a7e667e85b3daba1dc5a60">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.find( subspaceId );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ) {
        <span class="keywordflow">return</span>;
    }
    <a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;

    <span class="keywordflow">if</span>( pingCall-&gt;<a class="code" href="classPubSubPingCall.html#ad2d88a7b8ff45cf95aabfcb792490d1d">getPingType</a>() == <a class="code" href="PubSubMessage__m_8h.html#a955af4961bb8702caeddf04706c0681ba6be4bc3a5b9c7bee39a3eed787e5eb90">PUBSUB_PING_CHILD</a> ){
        <span class="comment">// remove child</span>
        <a class="code" href="classPubSubMMOG.html#a104570a1f3f3f4951bf67e9b8e09b0e8">unsubscribeChild</a>( oldNodeHandle, subspace );

    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pingCall-&gt;<a class="code" href="classPubSubPingCall.html#ad2d88a7b8ff45cf95aabfcb792490d1d">getPingType</a>() == <a class="code" href="PubSubMessage__m_8h.html#a955af4961bb8702caeddf04706c0681ba4bcfe90f539ae081948077a9d0c1d992">PUBSUB_PING_BACKUP</a> ){

        <span class="comment">// if we didn&#39;t already have (or asked for) a new backup</span>
        <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() &amp;&amp;
                subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>() == oldNodeHandle )
        {
            <span class="comment">// our backup timed out. we have to request a new one...</span>
            <span class="comment">// delete old backup entry</span>
            subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a462a25a436aa25d8cc38310119a5d671">setBackupNode</a>( <a class="code" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6" title="the unspecified NodeHandle">NodeHandle::UNSPECIFIED_NODE</a> );

            <span class="comment">// Request new Backup</span>
            <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>* helpCall = <span class="keyword">new</span> <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>(<span class="stringliteral">&quot;I need a backup node&quot;</span>);
            helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a15d480c842e84416cea15f69225be7f9">setHelpType</a>( <a class="code" href="PubSubMessage__m_8h.html#a0a7abf0acc5a382f3b386ab1a09cd07aaa575d5ab279429401172053d228e4838">PUBSUB_BACKUP</a> );
            helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a5e3fd97479f76170ffbfcea6385dcd16">setSubspaceId</a>( pingCall-&gt;<a class="code" href="classPubSubPingCall.html#a6c09797ec1a7e667e85b3daba1dc5a60">getSubspaceId</a>() );
            helpCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#aac95c8ba038a0a9dd3671a29330493a9">PUBSUB_HELPCALL_L</a>( helpCall ));
            <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                    ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                    pubSubSignalingMessagesSize+= helpCall-&gt;getByteLength()
                    );
            <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, helpCall );
        }

    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pingCall-&gt;<a class="code" href="classPubSubPingCall.html#ad2d88a7b8ff45cf95aabfcb792490d1d">getPingType</a>() == <a class="code" href="PubSubMessage__m_8h.html#a955af4961bb8702caeddf04706c0681ba3402d727b81d4511a52d09df2252918c">PUBSUB_PING_INTERMEDIATE</a> ){
        <span class="comment">// one intermediate node timed out. we have to request a new one...</span>
        <span class="comment">// delete old intermediate entry</span>
        deque&lt;PubSubSubspaceResponsible::IntermediateNode&gt;::iterator iit;
        <span class="keywordflow">for</span>( iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin(); iit != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end(); ++iit ){
            <span class="keywordflow">if</span>( !iit-&gt;node.isUnspecified() &amp;&amp; oldNode == iit-&gt;node ) <span class="keywordflow">break</span>;
        }
        <span class="keywordflow">if</span>( iit == subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end() ) <span class="keywordflow">return</span>;

        <a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a> oldNode = iit-&gt;node;
        iit-&gt;node = <a class="code" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6" title="the unspecified NodeHandle">NodeHandle::UNSPECIFIED_NODE</a>;

        <span class="comment">// inform Backup</span>
        <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
            <a class="code" href="classPubSubBackupIntermediateMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupIntermediateMessage</a>* backupMsg = <span class="keyword">new</span> <a class="code" href="classPubSubBackupIntermediateMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupIntermediateMessage</a>(<span class="stringliteral">&quot;Backup: Intermediate failed&quot;</span>);
            backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#a0619ec8887f931a6167c41624524bdf2">setSubspaceId</a>( pingCall-&gt;<a class="code" href="classPubSubPingCall.html#a6c09797ec1a7e667e85b3daba1dc5a60">getSubspaceId</a>() );
            backupMsg-&gt;<a class="code" href="classPubSubBackupIntermediateMessage.html#a2b50b84aae0d5fb21f800f7060719cdc">setPos</a>( iit - it-&gt;second.intermediateNodes.begin() );
            backupMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#af0f2565f24c2e5b8e3655c3fb073d887">PUBSUB_BACKUPINTERMEDIATE_L</a>( backupMsg ));
            <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                    ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                    pubSubSignalingMessagesSize+= backupMsg-&gt;getByteLength()
                    );
            <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>(), backupMsg );
        }

        <span class="keywordtype">bool</span> fixNeeded = <span class="keyword">false</span>;
        <span class="comment">// Take over all children until new intermediate is found.</span>
        set&lt;NodeHandle&gt;::iterator childIt;
        <span class="keywordflow">for</span>(  childIt = iit-&gt;children.begin(); childIt != iit-&gt;children.end(); ++childIt ){
            <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert( make_pair(*childIt, <span class="keyword">false</span>)).second ){
                fixNeeded = <span class="keyword">true</span>;
            }

            <span class="comment">// Inform Backup</span>
            <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
                <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>* backupMsg = <span class="keyword">new</span> <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>(<span class="stringliteral">&quot;Backup: nodes moved to cache&quot;</span>);
                backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#ac8a8edd3c1669fa810598e7d16b4141f">setSubspaceId</a>( pingCall-&gt;<a class="code" href="classPubSubPingCall.html#a6c09797ec1a7e667e85b3daba1dc5a60">getSubspaceId</a>() );
                backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#af638885c4794f5652c318f21521c5668">setChild</a>( *childIt );
                backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a52fe84752aa0929392cc6c6e7a5d059f">setOldParent</a>( oldNodeHandle );
                backupMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a485654404a477aa60cb34dd0ae722258">PUBSUB_BACKUPSUBSCRIPTION_L</a>( backupMsg ));
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= backupMsg-&gt;getByteLength()
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>(), backupMsg );
            }
        }
        iit-&gt;children.clear();
        <span class="keywordflow">if</span>( fixNeeded ) subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();

        <span class="comment">// inform parent of intermediate node</span>
        <span class="keywordtype">int</span> parentPos = (iit - subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin())/<a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> -1;
        <span class="keywordflow">if</span>( parentPos &gt;= 0 ){
            <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a>&amp; parent = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[parentPos];
            <span class="keywordflow">if</span>( !parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>.<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
                <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>* goneMsg = <span class="keyword">new</span> <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>(<span class="stringliteral">&quot;Intermediate left Subspace&quot;</span>);
                goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a4604631be10c1b8f9aa6db29aaa76386">setNode</a>( oldNodeHandle );
                goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a74ae8a4726d74370cc59cae590a72ddb">setSubspaceId</a>( subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>().<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>() );
                goneMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#ac2a4c9a20c40c17b2a948f346d5ae4fc">PUBSUB_NODELEFT_L</a>( goneMsg ));
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= goneMsg-&gt;getByteLength()
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>, goneMsg );
            }
        }

        <span class="comment">// Request new Intermediate</span>
        <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>* helpCall = <span class="keyword">new</span> <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>(<span class="stringliteral">&quot;I need an intermediate node&quot;</span>);
        helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a15d480c842e84416cea15f69225be7f9">setHelpType</a>( <a class="code" href="PubSubMessage__m_8h.html#a0a7abf0acc5a382f3b386ab1a09cd07aa99501a84d5d53b3a4c78362dc7c7a551">PUBSUB_INTERMEDIATE</a> );
        helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a5e3fd97479f76170ffbfcea6385dcd16">setSubspaceId</a>( pingCall-&gt;<a class="code" href="classPubSubPingCall.html#a6c09797ec1a7e667e85b3daba1dc5a60">getSubspaceId</a>() );
        helpCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#aac95c8ba038a0a9dd3671a29330493a9">PUBSUB_HELPCALL_L</a>( helpCall ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= helpCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, helpCall );
    }
<span class="comment">// FIXME: just for testing</span>
<span class="keywordtype">int</span> iii = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>();
subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
<span class="keywordflow">if</span>( iii != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() ){
    opp_error(<span class="stringliteral">&quot;Huh?&quot;</span>);
}

}
</pre></div>
</div>
</div>
<a class="anchor" id="a6ade874ae0f4871c157cbf3e4334724c"></a><!-- doxytag: member="PubSubMMOG::handlePingResponse" ref="a6ade874ae0f4871c157cbf3e4334724c" args="(PubSubPingResponse *pingResp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handlePingResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubPingResponse.html">PubSubPingResponse</a> *&#160;</td>
          <td class="paramname"><em>pingResp</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01170">1170</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
}
</pre></div>
</div>
</div>
<a class="anchor" id="af1197b5fab38765c9e510cb6e755f62a"></a><!-- doxytag: member="PubSubMMOG::handleReleaseIntermediate" ref="af1197b5fab38765c9e510cb6e755f62a" args="(PubSubReleaseIntermediateMessage *releaseMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleReleaseIntermediate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubReleaseIntermediateMessage.html">PubSubReleaseIntermediateMessage</a> *&#160;</td>
          <td class="paramname"><em>releaseMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01506">1506</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(releaseMsg-&gt;<a class="code" href="classPubSubReleaseIntermediateMessage.html#a18c562845e99ef0ef4d72faba29aded5">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.erase( subspaceId );
}
</pre></div>
</div>
</div>
<a class="anchor" id="abd3f25e6c1521cc5d6959fc1929a2ac6"></a><!-- doxytag: member="PubSubMMOG::handleReplacementMessage" ref="abd3f25e6c1521cc5d6959fc1929a2ac6" args="(PubSubReplacementMessage *replaceMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleReplacementMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubReplacementMessage.html">PubSubReplacementMessage</a> *&#160;</td>
          <td class="paramname"><em>replaceMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01484">1484</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(replaceMsg-&gt;<a class="code" href="classPubSubReplacementMessage.html#ab1379bead1302a2e9278039991db882f">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);

    <span class="comment">// There&#39;s a new responsible node for a subspace</span>
    <span class="comment">// Replace the old one in the intermediateSubspaces map...</span>
    std::map&lt;PubSubSubspaceId, PubSubSubspaceIntermediate&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.find( subspaceId );
    <span class="keywordflow">if</span>( it != <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a>.end() ) {
        it-&gt;second.setResponsibleNode( replaceMsg-&gt;<a class="code" href="classPubSubReplacementMessage.html#ad86ff24aed5d6c098aa882032966cb79">getNewResponsibleNode</a>() );
    }

    <span class="comment">// ... and in the subsribed subspaces list</span>
    std::list&lt;PubSubSubspace&gt;::iterator iit;
    <span class="keywordflow">for</span>( iit = <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.begin(); iit != <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.end(); ++iit ){
        <span class="keywordflow">if</span>( iit-&gt;getId() == subspaceId ) {
            iit-&gt;setResponsibleNode( replaceMsg-&gt;<a class="code" href="classPubSubReplacementMessage.html#ad86ff24aed5d6c098aa882032966cb79">getNewResponsibleNode</a>() );
            <span class="keywordflow">return</span>;
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7e351287bef39afa54408e4fce0fdf26"></a><!-- doxytag: member="PubSubMMOG::handleResponsibleNodeResponse" ref="a7e351287bef39afa54408e4fce0fdf26" args="(PubSubResponsibleNodeResponse *subResp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleResponsibleNodeResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubResponsibleNodeResponse.html">PubSubResponsibleNodeResponse</a> *&#160;</td>
          <td class="paramname"><em>subResp</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00398">398</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> subspaceId = subResp-&gt;<a class="code" href="classPubSubResponsibleNodeResponse.html#a90f846a8230ff1c298116eae9320fc5f">getSubspaceId</a>();
    <a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a> respNode = subResp-&gt;<a class="code" href="classPubSubResponsibleNodeResponse.html#a9c9dcf7c0e9e43a34b80baba9761481d">getResponsibleNode</a>();

    std::list&lt;PubSubSubspace&gt;::iterator it = <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.begin();
    <span class="keywordflow">while</span>( it != <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.end() ) {
        <span class="keywordflow">if</span>( it-&gt;getId().getId() == subspaceId) <span class="keywordflow">break</span>;
        ++it;
    }
    <span class="keywordflow">if</span>( it != <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a>.end() ) {
        it-&gt;setResponsibleNode( respNode );

        <a class="code" href="classPubSubSubscriptionCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubSubscriptionCall</a>* subCall = <span class="keyword">new</span> <a class="code" href="classPubSubSubscriptionCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubSubscriptionCall</a>(<span class="stringliteral">&quot;JoinSubspace&quot;</span>);
        subCall-&gt;<a class="code" href="classPubSubSubscriptionCall.html#a8b0793692afe779cf03bd1081fa60a6f">setSubspaceId</a>( subspaceId );
        subCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a2b5451b24d68787636358002b3292042">PUBSUB_SUBSCRIPTIONCALL_L</a>( subCall ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= subCall-&gt;getByteLength()
                );
        <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( respNode, subCall );
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4f2a87f7e95bbb17819f04261585236d"></a><!-- doxytag: member="PubSubMMOG::handleRpcCall" ref="a4f2a87f7e95bbb17819f04261585236d" args="(BaseCallMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PubSubMMOG::handleRpcCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Processes Remote-Procedure-Call invocation messages. </p>
<p><br/>
</p>
<p>This method should be overloaded when the overlay provides RPC functionality.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true, if rpc has been handled </dd></dl>

<p>Reimplemented from <a class="el" href="classBaseRpc.html#a20e77c3e0c203762a5b582ffebe3ba4b">BaseRpc</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00103">103</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// delegate messages</span>
    <a class="code" href="RpcMacros_8h.html#aa75b135e279b574267e1a7dc4ab79da4" title="Marks the beginning of a Remote-Procedure-Call Switch block.">RPC_SWITCH_START</a>( msg )
    <a class="code" href="RpcMacros_8h.html#ad81d44e9bc59d2fb2cfcacc4d5ecda35" title="Declares a RPC method delegation.">RPC_DELEGATE</a>( PubSubSubscription, <a class="code" href="classPubSubMMOG.html#a3d1fd761fc46a4b56f1c7e852bf41207">handleSubscriptionCall</a> );
    <a class="code" href="RpcMacros_8h.html#ad81d44e9bc59d2fb2cfcacc4d5ecda35" title="Declares a RPC method delegation.">RPC_DELEGATE</a>( PubSubTakeOverSubspace, <a class="code" href="classPubSubMMOG.html#af504bf4e0b52404912395baefed9f5c5">handleTakeOver</a> );
    <a class="code" href="RpcMacros_8h.html#ad81d44e9bc59d2fb2cfcacc4d5ecda35" title="Declares a RPC method delegation.">RPC_DELEGATE</a>( PubSubBackup, <a class="code" href="classPubSubMMOG.html#ac7e55bce3aa2a48f4367977e081eb9e1">handleBackupCall</a> );
    <a class="code" href="RpcMacros_8h.html#ad81d44e9bc59d2fb2cfcacc4d5ecda35" title="Declares a RPC method delegation.">RPC_DELEGATE</a>( PubSubIntermediate, <a class="code" href="classPubSubMMOG.html#a77d17c923e8b43f0bf38222dd58d3969">handleIntermediateCall</a> );
    <a class="code" href="RpcMacros_8h.html#ad81d44e9bc59d2fb2cfcacc4d5ecda35" title="Declares a RPC method delegation.">RPC_DELEGATE</a>( PubSubAdoptChild, <a class="code" href="classPubSubMMOG.html#a301bb30f1b9239fa5ea744400be48a1b">handleAdoptChildCall</a> );
    <a class="code" href="RpcMacros_8h.html#ad81d44e9bc59d2fb2cfcacc4d5ecda35" title="Declares a RPC method delegation.">RPC_DELEGATE</a>( PubSubPing, <a class="code" href="classPubSubMMOG.html#a7179d8d2355f09e50e5172a8bc4e60b1">handlePingCall</a> );
    <a class="code" href="RpcMacros_8h.html#a29a8a3f21e67ecb25f58608a54df5191" title="Marks the end of a Remote-Procedure-Call Switch block.">RPC_SWITCH_END</a>( )

    return <a class="code" href="RpcMacros_8h.html#aa5e964b7c7129c0943237a786e455e9a">RPC_HANDLED</a>;

}
</pre></div>
</div>
</div>
<a class="anchor" id="a8cd2dcabf97fae56f6af40cda177fdf7"></a><!-- doxytag: member="PubSubMMOG::handleRpcResponse" ref="a8cd2dcabf97fae56f6af40cda177fdf7" args="(BaseResponseMessage *msg, cPolymorphic *context, int rpcId, simtime_t rtt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleRpcResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseResponseMessage.html">BaseResponseMessage</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rpcId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>rtt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This method is called if an RPC response has been received. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>The response message. </td></tr>
    <tr><td class="paramname">context</td><td>Pointer to an optional state object. The object has to be handled/deleted by the <a class="el" href="classPubSubMMOG.html#a8cd2dcabf97fae56f6af40cda177fdf7" title="This method is called if an RPC response has been received.">handleRpcResponse()</a> code </td></tr>
    <tr><td class="paramname">rpcId</td><td>The RPC id. </td></tr>
    <tr><td class="paramname">rtt</td><td>The Round-Trip-Time of this RPC </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classRpcListener.html#a6229090a446fb649cfec3c1fb61e7167">RpcListener</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00119">119</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="RpcMacros_8h.html#aa75b135e279b574267e1a7dc4ab79da4" title="Marks the beginning of a Remote-Procedure-Call Switch block.">RPC_SWITCH_START</a>(msg);
    <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( PubSubJoin ) {
        <a class="code" href="classPubSubMMOG.html#a90f7b9fa68b400b80892d642f4c439b4">handleJoinResponse</a>( _PubSubJoinResponse );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    Received a PubSubJoin RPC Response: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubJoinResponse &lt;&lt; <span class="stringliteral">&quot; rtt=&quot;</span> &lt;&lt; rtt
            &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( PubSubSubscription ) {
        <a class="code" href="classPubSubMMOG.html#a7d6b63042aee9dfbe3d11d2062a43a05">handleSubscriptionResponse</a>( _PubSubSubscriptionResponse );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    Received a PubSubSubscription RPC Response: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubSubscriptionResponse &lt;&lt; <span class="stringliteral">&quot; rtt=&quot;</span> &lt;&lt; rtt
            &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( PubSubResponsibleNode ) {
        <a class="code" href="classPubSubMMOG.html#a7e351287bef39afa54408e4fce0fdf26">handleResponsibleNodeResponse</a>( _PubSubResponsibleNodeResponse );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    Received a PubSubResponsibleNode RPC Response: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubResponsibleNodeResponse &lt;&lt; <span class="stringliteral">&quot; rtt=&quot;</span> &lt;&lt; rtt
            &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( PubSubHelp ) {
        <a class="code" href="classPubSubMMOG.html#a7d28b4484518dcf34fbc2cb462bf620b">handleHelpResponse</a>( _PubSubHelpResponse );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    Received a PubSubHelp RPC Response: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubHelpResponse &lt;&lt; <span class="stringliteral">&quot; rtt=&quot;</span> &lt;&lt; rtt
            &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( PubSubBackup ) {
        <a class="code" href="classPubSubMMOG.html#a401659ffbdca793a6f7d97e9737a70d0">handleBackupResponse</a>( _PubSubBackupResponse );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    Received a PubSubBackup RPC Response: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubBackupResponse &lt;&lt; <span class="stringliteral">&quot; rtt=&quot;</span> &lt;&lt; rtt
            &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( PubSubIntermediate ) {
        <a class="code" href="classPubSubMMOG.html#ac41702ca41ffae439637504939856f4f">handleIntermediateResponse</a>( _PubSubIntermediateResponse );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    Received a PubSubIntermediate RPC Response: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubIntermediateResponse &lt;&lt; <span class="stringliteral">&quot; rtt=&quot;</span> &lt;&lt; rtt
            &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( PubSubAdoptChild ) {
        <a class="code" href="classPubSubMMOG.html#a9f396c585cfb16b476047c35fbbe05fa">handleAdoptChildResponse</a>( _PubSubAdoptChildResponse );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    Received a PubSubAdoptChild RPC Response: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubAdoptChildResponse &lt;&lt; <span class="stringliteral">&quot; rtt=&quot;</span> &lt;&lt; rtt
            &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( PubSubPing ) {
        <a class="code" href="classPubSubMMOG.html#a6ade874ae0f4871c157cbf3e4334724c">handlePingResponse</a>( _PubSubPingResponse );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    Received a PubSubPing RPC Response: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubPingResponse &lt;&lt; <span class="stringliteral">&quot; rtt=&quot;</span> &lt;&lt; rtt
            &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a29a8a3f21e67ecb25f58608a54df5191" title="Marks the end of a Remote-Procedure-Call Switch block.">RPC_SWITCH_END</a>( );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9838eb23acd2464c8500cdff66caf8a8"></a><!-- doxytag: member="PubSubMMOG::handleRpcTimeout" ref="a9838eb23acd2464c8500cdff66caf8a8" args="(BaseCallMessage *msg, const TransportAddress &amp;dest, cPolymorphic *context, int rpcId, const OverlayKey &amp;destKey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleRpcTimeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rpcId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&#160;</td>
          <td class="paramname"><em>destKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This method is called if an RPC timeout has been reached. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>The original RPC message. </td></tr>
    <tr><td class="paramname">dest</td><td>The destination node </td></tr>
    <tr><td class="paramname">context</td><td>Pointer to an optional state object. The object has to be handled/deleted by the <a class="el" href="classPubSubMMOG.html#a8cd2dcabf97fae56f6af40cda177fdf7" title="This method is called if an RPC response has been received.">handleRpcResponse()</a> code </td></tr>
    <tr><td class="paramname">rpcId</td><td>The RPC id. </td></tr>
    <tr><td class="paramname">destKey</td><td>the destination <a class="el" href="classOverlayKey.html" title="A common overlay key class.">OverlayKey</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classRpcListener.html#aaaf9cd362481527ed995dd159aa96b73">RpcListener</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00199">199</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="RpcMacros_8h.html#aa75b135e279b574267e1a7dc4ab79da4" title="Marks the beginning of a Remote-Procedure-Call Switch block.">RPC_SWITCH_START</a>(msg)
    <a class="code" href="RpcMacros_8h.html#ae07fad586ce7b9e82ad12848767a32e5">RPC_ON_CALL</a>( PubSubBackup ) {
        <a class="code" href="classPubSubMMOG.html#a217e815ddc5ba02f8afe33a73389184f">handleBackupCallTimeout</a>( _PubSubBackupCall, dest );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcTimeout() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
           &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    Backup RPC Call timed out: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubBackupCall
           &lt;&lt; <span class="stringliteral">&quot;    oldNode=&quot;</span> &lt;&lt; dest
           &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#ae07fad586ce7b9e82ad12848767a32e5">RPC_ON_CALL</a>( PubSubPing ) {
        <a class="code" href="classPubSubMMOG.html#a0ca3bd97cac131ba5c2ff02235cc6a2f">handlePingCallTimeout</a>( _PubSubPingCall, dest );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcTimeout() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
           &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    Ping RPC Call timed out: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubPingCall
           &lt;&lt; <span class="stringliteral">&quot;    oldNode=&quot;</span> &lt;&lt; dest
           &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#ae07fad586ce7b9e82ad12848767a32e5">RPC_ON_CALL</a>( PubSubSubscription ) {
        <a class="code" href="classPubSubMMOG.html#a1e97ea82ff0848af1f5437b1c8da7c99">handleSubscriptionCallTimeout</a>( _PubSubSubscriptionCall, dest );
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::handleRpcTimeout() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
           &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    Subscription RPC Call timed out: id=&quot;</span> &lt;&lt; rpcId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    msg=&quot;</span> &lt;&lt; *_PubSubSubscriptionCall
           &lt;&lt; <span class="stringliteral">&quot;    oldNode=&quot;</span> &lt;&lt; dest
           &lt;&lt; endl;
        <span class="keywordflow">break</span>;
    }
    <a class="code" href="RpcMacros_8h.html#a29a8a3f21e67ecb25f58608a54df5191" title="Marks the end of a Remote-Procedure-Call Switch block.">RPC_SWITCH_END</a>( )

    <span class="comment">// FIXME:</span>
    <span class="comment">//   AdoptCall missing!</span>
    <span class="comment">//   IntermediateCall missing!</span>
    <span class="comment">//   (ResponsibleNodeCall missing)</span>
    <span class="comment">//   (HelpCall missing)</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a354f1a0173cb3cc5a00bc7d16d17f73a"></a><!-- doxytag: member="PubSubMMOG::handleSubscriptionBackup" ref="a354f1a0173cb3cc5a00bc7d16d17f73a" args="(PubSubBackupSubscriptionMessage *backupMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleSubscriptionBackup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubBackupSubscriptionMessage.html">PubSubBackupSubscriptionMessage</a> *&#160;</td>
          <td class="paramname"><em>backupMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01528">1528</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Note: this funktion may break subspace&#39;s tatalChildrenCall</span>
    <span class="comment">// You have to use fixTotalChildrenCount before using the subspace</span>
    <span class="comment">// find appropriate subspace</span>
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a86c045717d5a7327f8e9484b399167d5">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.find( subspaceId );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.end() ) {
        <span class="keywordflow">return</span>;
    }
    <a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;

    deque&lt;PubSubSubspaceResponsible::IntermediateNode&gt;::iterator iit;

    <span class="keywordflow">if</span>( !backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a9f318b50e53b2c75f8cac7ab2629a614">getOldParent</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
        <span class="comment">// oldParent set -&gt; move child</span>
        <span class="keywordflow">if</span>( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a9f318b50e53b2c75f8cac7ab2629a614">getOldParent</a>() == subspace.<a class="code" href="classPubSubSubspace.html#a996b0242f4c47164d5ee2141755d8fb1">getResponsibleNode</a>() ){
            <span class="comment">// direct child -&gt; cache</span>
            subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#ada0034be890586e3cc0305bfa089e031">removeChild</a>( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a457980ddd7bf8f15c5392ab43b0d090e">getChild</a>() );
            subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert(make_pair( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a457980ddd7bf8f15c5392ab43b0d090e">getChild</a>(), <span class="keyword">false</span>) );

        } <span class="keywordflow">else</span> {
            <span class="comment">// from I -&gt; chache</span>
            <span class="keywordflow">for</span>( iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin(); iit != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end(); ++iit ){
<span class="comment">//                if( !iit-&gt;node.isUnspecified() &amp;&amp; iit-&gt;node == backupMsg-&gt;getOldParent() ){</span>
                    iit-&gt;children.erase( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a457980ddd7bf8f15c5392ab43b0d090e">getChild</a>() );
<span class="comment">//                }</span>
            }
            subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert(make_pair( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a457980ddd7bf8f15c5392ab43b0d090e">getChild</a>(), <span class="keyword">false</span>) );
        }
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#aaca1114e8cbfe010357b2088dbb5696a">getParent</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
        <span class="comment">// parent not set -&gt; new child to chache</span>
        subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert(make_pair( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a457980ddd7bf8f15c5392ab43b0d090e">getChild</a>(), <span class="keyword">false</span>) );

    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#aaca1114e8cbfe010357b2088dbb5696a">getParent</a>() == subspace.<a class="code" href="classPubSubSubspace.html#a996b0242f4c47164d5ee2141755d8fb1">getResponsibleNode</a>() ){
        <span class="comment">// new direct child</span>
        subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ae254ce652d4827abfb7981b4f067c89a">addChild</a>( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a457980ddd7bf8f15c5392ab43b0d090e">getChild</a>() );
    } <span class="keywordflow">else</span> {
        <span class="comment">// move child from cache to intermediate</span>
        subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.erase( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a457980ddd7bf8f15c5392ab43b0d090e">getChild</a>() );

        <span class="keywordflow">for</span>( iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin(); iit != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end(); ++iit ){
            <span class="keywordflow">if</span>( !iit-&gt;node.isUnspecified() &amp;&amp; iit-&gt;node == backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#aaca1114e8cbfe010357b2088dbb5696a">getParent</a>() ){
                iit-&gt;children.insert( backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#a457980ddd7bf8f15c5392ab43b0d090e">getChild</a>() );
            }
        }
        <span class="comment">// FIXME: check for errors</span>
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3d1fd761fc46a4b56f1c7e852bf41207"></a><!-- doxytag: member="PubSubMMOG::handleSubscriptionCall" ref="a3d1fd761fc46a4b56f1c7e852bf41207" args="(PubSubSubscriptionCall *subCall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleSubscriptionCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubSubscriptionCall.html">PubSubSubscriptionCall</a> *&#160;</td>
          <td class="paramname"><em>subCall</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00442">442</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(subCall-&gt;<a class="code" href="classPubSubSubscriptionCall.html#a6cba83861e6c98de7a2721a596d2ff14">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );

    <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>* backupMsg = 0;
    <a class="code" href="classPubSubSubscriptionResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubSubscriptionResponse</a>* resp;
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ) {
        resp = <span class="keyword">new</span> <a class="code" href="classPubSubSubscriptionResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubSubscriptionResponse</a>(<span class="stringliteral">&quot;Subscription failed&quot;</span>);
        resp-&gt;<a class="code" href="classPubSubSubscriptionResponse.html#aa43c934894540c35c33e5f611243fc0b">setFailed</a>( <span class="keyword">true</span> );
    } <span class="keywordflow">else</span> {
        resp = <span class="keyword">new</span> <a class="code" href="classPubSubSubscriptionResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubSubscriptionResponse</a>(<span class="stringliteral">&quot;Subscription successful&quot;</span>);
        backupMsg = <span class="keyword">new</span> <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>(<span class="stringliteral">&quot;Backup: new subscription&quot;</span>);
        backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#ac8a8edd3c1669fa810598e7d16b4141f">setSubspaceId</a>( subCall-&gt;<a class="code" href="classPubSubSubscriptionCall.html#a6cba83861e6c98de7a2721a596d2ff14">getSubspaceId</a>() );
        backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#af638885c4794f5652c318f21521c5668">setChild</a>( subCall-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>() );

        <span class="keywordflow">if</span>( it-&gt;second.addChild( subCall-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>() )) {
            <span class="comment">// We have still room for the child</span>
            backupMsg-&gt;<a class="code" href="classPubSubBackupSubscriptionMessage.html#aaf5be2dc4b0de3c0e59c607794788261">setParent</a>( <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> );
        } <span class="keywordflow">else</span> {
            <span class="comment">// Child has to go to an intermediate node...</span>
            <span class="keywordflow">if</span>( <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a>* iNode = it-&gt;second.getNextFreeIntermediate() ){
                <span class="comment">// find intermediate node with free slots</span>
                <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>* adoptCall = <span class="keyword">new</span> <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>(<span class="stringliteral">&quot;Adopt child&quot;</span>);
                adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a33b972c420b165433c98e9096f08ed79">setChild</a>( subCall-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>() );
                adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#ad057dff5f1db054f15839a20adb17f8b">setSubspaceId</a>( subCall-&gt;<a class="code" href="classPubSubSubscriptionCall.html#a6cba83861e6c98de7a2721a596d2ff14">getSubspaceId</a>() );
                adoptCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a40172b8994bee9881c879d1f69994013">PUBSUB_ADOPTCHILDCALL_L</a>( adoptCall ));
                <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( iNode-&gt;node, adoptCall );
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= adoptCall-&gt;getByteLength()
                        );
                iNode-&gt;waitingChildren++;
            } <span class="keywordflow">else</span> {
                <span class="comment">// no free slots available, create new intermediate node</span>
                <span class="comment">// FIXME: when getting two subscriptions at once, we&#39;re requesting too many intermediates</span>
                <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>* helpCall = <span class="keyword">new</span> <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>(<span class="stringliteral">&quot;I need an intermediate node&quot;</span>);
                helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a15d480c842e84416cea15f69225be7f9">setHelpType</a>( <a class="code" href="PubSubMessage__m_8h.html#a0a7abf0acc5a382f3b386ab1a09cd07aa99501a84d5d53b3a4c78362dc7c7a551">PUBSUB_INTERMEDIATE</a> );
                helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a5e3fd97479f76170ffbfcea6385dcd16">setSubspaceId</a>( subCall-&gt;<a class="code" href="classPubSubSubscriptionCall.html#a6cba83861e6c98de7a2721a596d2ff14">getSubspaceId</a>() );
                helpCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#aac95c8ba038a0a9dd3671a29330493a9">PUBSUB_HELPCALL_L</a>( helpCall ));
                <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, helpCall );
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= helpCall-&gt;getByteLength()
                        );
            }
        }
    }
    resp-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a2d60280823412936f4ce8dc98ae3fb41">PUBSUB_SUBSCRIPTIONRESPONSE_L</a>( resp ));
    <a class="code" href="classBaseRpc.html#adc06091d348c98a5efbf54fe0afe8747" title="Send Remote-Procedure response message and deletes call message.">sendRpcResponse</a>( subCall, resp );
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            pubSubSignalingMessagesSize+= resp-&gt;getByteLength()
            );

    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ) <span class="keywordflow">return</span>;

<span class="comment">// FIXME: just for testing</span>
<a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;
<span class="keywordtype">int</span> iii = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>();
subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
<span class="keywordflow">if</span>( iii != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() ){
    opp_error(<span class="stringliteral">&quot;Huh?&quot;</span>);
}

    <span class="keywordflow">if</span>( !it-&gt;second.getBackupNode().isUnspecified() ){
        backupMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a485654404a477aa60cb34dd0ae722258">PUBSUB_BACKUPSUBSCRIPTION_L</a>( backupMsg ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= backupMsg-&gt;getByteLength()
                );
        <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( it-&gt;second.getBackupNode(), backupMsg );
    } <span class="keywordflow">else</span> {
        <span class="keyword">delete</span> backupMsg;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1e97ea82ff0848af1f5437b1c8da7c99"></a><!-- doxytag: member="PubSubMMOG::handleSubscriptionCallTimeout" ref="a1e97ea82ff0848af1f5437b1c8da7c99" args="(PubSubSubscriptionCall *subscriptionCall, const TransportAddress &amp;oldNode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleSubscriptionCallTimeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubSubscriptionCall.html">PubSubSubscriptionCall</a> *&#160;</td>
          <td class="paramname"><em>subscriptionCall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>oldNode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01458">1458</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// FIXME: cast oldNode to NodeHandle</span>
    <span class="comment">// our subscription call timed out. This means the responsible node is dead...</span>
    <span class="comment">// Inform Lobbyserver over failed node</span>
    <a class="code" href="classPubSubFailedNodeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubFailedNodeMessage</a>* failedNode = <span class="keyword">new</span> <a class="code" href="classPubSubFailedNodeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubFailedNodeMessage</a>(<span class="stringliteral">&quot;Node failed&quot;</span>);
    failedNode-&gt;<a class="code" href="classPubSubFailedNodeMessage.html#a69484c6b7387a623c18edb86a0aca7d3">setFailedNode</a>( oldNode );
    failedNode-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#acb366745fb62311b100b1632b04b1141">PUBSUB_FAILEDNODE_L</a>( failedNode ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= failedNode-&gt;getByteLength()
            );
    <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, failedNode );

    <span class="comment">// Ask for new responsible node</span>
    <a class="code" href="classPubSubResponsibleNodeCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubResponsibleNodeCall</a>* respCall = <span class="keyword">new</span> <a class="code" href="classPubSubResponsibleNodeCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubResponsibleNodeCall</a>(<span class="stringliteral">&quot;Request Responsible NodeHandle&quot;</span>);
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId( subscriptionCall-&gt;<a class="code" href="classPubSubSubscriptionCall.html#a6cba83861e6c98de7a2721a596d2ff14">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    respCall-&gt;<a class="code" href="classPubSubResponsibleNodeCall.html#a2bf680eb93832016647c1dfbdc6618ca">setSubspacePos</a>( <a class="code" href="classVector2D.html">Vector2D</a>(subspaceId.getX(), subspaceId.getY()) );
    respCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a5d4e7d4a5b91386ccba0e0a03330ab9d">PUBSUB_RESPONSIBLENODECALL_L</a>( respCall ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            pubSubSignalingMessagesSize+= respCall-&gt;getByteLength()
            );
    <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, respCall, NULL, 5, 5 ); <span class="comment">// FIXME: Make it a parameter...</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7d6b63042aee9dfbe3d11d2062a43a05"></a><!-- doxytag: member="PubSubMMOG::handleSubscriptionResponse" ref="a7d6b63042aee9dfbe3d11d2062a43a05" args="(PubSubSubscriptionResponse *subResp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleSubscriptionResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubSubscriptionResponse.html">PubSubSubscriptionResponse</a> *&#160;</td>
          <td class="paramname"><em>subResp</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00351">351</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span>( subResp-&gt;<a class="code" href="classPubSubSubscriptionResponse.html#a8b39219b33424e4eeac34caa2b835156">getFailed</a>() ) {
        <span class="comment">// TODO: get new resp node...</span>
    } <span class="keywordflow">else</span> {
        <span class="keywordflow">if</span>( <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> != <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fab3a263fb274a58d63b15cd61ba910335">READY</a> ){
            <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> = <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fab3a263fb274a58d63b15cd61ba910335">READY</a>;
            <a class="code" href="classPubSubMMOG.html#a3e573d9ce39091daea435016a587b239">setBootstrapedIcon</a>();
            <a class="code" href="classCompReadyMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">CompReadyMessage</a>* readyMsg = <span class="keyword">new</span> <a class="code" href="classCompReadyMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">CompReadyMessage</a>(<span class="stringliteral">&quot;Overlay READY!&quot;</span>);
            readyMsg-&gt;<a class="code" href="classCompReadyMessage.html#a07d2b2a15889728c23ed4d80730de2cf">setReady</a>(<span class="keyword">true</span>);
            readyMsg-&gt;<a class="code" href="classCompReadyMessage.html#a77640d7f3566804064921b2520ed51b6">setComp</a>(<a class="code" href="classBaseOverlay.html#a92e0d3f96a5716245465e05da60ef487" title="Return the component type of this module.">getThisCompType</a>());
            sendDelayed( readyMsg, ceil(simTime()) - simTime(), <span class="stringliteral">&quot;appOut&quot;</span> );
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="af504bf4e0b52404912395baefed9f5c5"></a><!-- doxytag: member="PubSubMMOG::handleTakeOver" ref="af504bf4e0b52404912395baefed9f5c5" args="(PubSubTakeOverSubspaceCall *toCall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleTakeOver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubTakeOverSubspaceCall.html">PubSubTakeOverSubspaceCall</a> *&#160;</td>
          <td class="paramname"><em>toCall</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00519">519</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> region((<span class="keywordtype">int</span>) toCall-&gt;<a class="code" href="classPubSubTakeOverSubspaceCall.html#afed679f34e29e2f4265a16e6e59e38ec">getSubspacePos</a>().<a class="code" href="classVector2D.html#ac5c4e553815737aa24bec8281270178f">x</a>, (int) toCall-&gt;<a class="code" href="classPubSubTakeOverSubspaceCall.html#afed679f34e29e2f4265a16e6e59e38ec">getSubspacePos</a>().<a class="code" href="classVector2D.html#ac38d0179cfe74c30fee290a703ab209a">y</a>, <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);

    <a class="code" href="classPubSubMMOG.html#a0fe097eb8ff809023d0a119b2dc17d61">takeOverNewSubspace</a>( region );

    <a class="code" href="classPubSubTakeOverSubspaceResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubTakeOverSubspaceResponse</a>* toResp = <span class="keyword">new</span> <a class="code" href="classPubSubTakeOverSubspaceResponse.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubTakeOverSubspaceResponse</a>(<span class="stringliteral">&quot;Accept subspace responsibility&quot;</span>);
    toResp-&gt;<a class="code" href="classPubSubTakeOverSubspaceResponse.html#a77c8b14b4454432282db30082b5fe5f0">setSubspacePos</a>( toCall-&gt;<a class="code" href="classPubSubTakeOverSubspaceCall.html#afed679f34e29e2f4265a16e6e59e38ec">getSubspacePos</a>() );
    toResp-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a4b113dcf08095771bd96237e30495a29">PUBSUB_TAKEOVERSUBSPACERESPONSE_L</a>( toResp ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= toResp-&gt;getByteLength()
            );
    <a class="code" href="classBaseRpc.html#adc06091d348c98a5efbf54fe0afe8747" title="Send Remote-Procedure response message and deletes call message.">sendRpcResponse</a>( toCall, toResp );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3df1116194918ab1768c1afbdef4fb00"></a><!-- doxytag: member="PubSubMMOG::handleTimerEvent" ref="a3df1116194918ab1768c1afbdef4fb00" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleTimerEvent </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classBaseRpc.html#ab893c156412e38caa62fe058b229899b">BaseRpc</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00275">275</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span>( <a class="code" href="classPubSubTimer.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubTimer</a>* timer = dynamic_cast&lt;PubSubTimer*&gt;(msg) ) {
        <span class="keywordflow">switch</span>( timer-&gt;getType() ) {
            <span class="keywordflow">case</span> <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04caec28dc4bd962108ceb27575f46b81ebd">PUBSUB_HEARTBEAT</a>:
                <a class="code" href="classPubSubMMOG.html#a237b78a3abc9b6cbb95021e25306e2e2">sendHearbeatToChildren</a>();
                <a class="code" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a>( timer );
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04caa64f2984ebaaa94fb52bc3ff99d24fa1">PUBSUB_CHILDPING</a>:
                <a class="code" href="classPubSubMMOG.html#abd00be445c110f527365d00553713334">sendPingToChildren</a>();
                <a class="code" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a>( timer );
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04cad6da37474996a5016fe145fcc24a52c8">PUBSUB_PARENT_TIMEOUT</a>:
                <a class="code" href="classPubSubMMOG.html#a01a6bc8e4b0e38e57d2e3108088f67f3">handleParentTimeout</a>( timer );
                <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04cab87b77accd020036a875063be27c753c">PUBSUB_EVENTDELIVERY</a>:
                <a class="code" href="classPubSubMMOG.html#a3c4d846c243253afb0f72592e44590ff">publishEvents</a>();
                <a class="code" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a>( timer );
                <span class="keywordflow">break</span>;
        }
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( msg == <a class="code" href="classPubSubMMOG.html#a04199b677abdfd25b29f9a5f79c19426">joinTimer</a> ) {
        <span class="comment">// send a fake ready message to app to get initial position</span>
        <span class="comment">// Note: This is not consistent to the paper, where the lobby server</span>
        <span class="comment">// positions player. But it is needed for consistency with other MMOG protocols</span>
        <a class="code" href="classCompReadyMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">CompReadyMessage</a>* msg = <span class="keyword">new</span> <a class="code" href="classCompReadyMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">CompReadyMessage</a>(<span class="stringliteral">&quot;fake READY&quot;</span>);
        msg-&gt;<a class="code" href="classCompReadyMessage.html#a07d2b2a15889728c23ed4d80730de2cf">setReady</a>(<span class="keyword">true</span>);
        msg-&gt;<a class="code" href="classCompReadyMessage.html#a77640d7f3566804064921b2520ed51b6">setComp</a>(<a class="code" href="classBaseOverlay.html#a92e0d3f96a5716245465e05da60ef487" title="Return the component type of this module.">getThisCompType</a>());
        send( msg, <span class="stringliteral">&quot;appOut&quot;</span>);
        <span class="keyword">delete</span> <a class="code" href="classPubSubMMOG.html#a04199b677abdfd25b29f9a5f79c19426">joinTimer</a>;
        <a class="code" href="classPubSubMMOG.html#a04199b677abdfd25b29f9a5f79c19426">joinTimer</a> = NULL;
        <span class="comment">// send initial AOI size to the application</span>
        <span class="comment">// Note: This is not consistent to the paper.</span>
        <span class="comment">// But it is needed for this nodes movement generation within the application layer.</span>
        <a class="code" href="classGameAPIResizeAOIMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">GameAPIResizeAOIMessage</a>* gameMsg = <span class="keyword">new</span> <a class="code" href="classGameAPIResizeAOIMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">GameAPIResizeAOIMessage</a>(<span class="stringliteral">&quot;RESIZE_AOI&quot;</span>);
        gameMsg-&gt;<a class="code" href="classGameAPIMessage.html#a3fe3071c66623191477b903527280ddc">setCommand</a>(<a class="code" href="CommonMessages__m_8h.html#ac76e82bc37e4b2b364247c7cff8f7b6ba04223e5523bbf330b2553e5ba3e320d1">RESIZE_AOI</a>);
        gameMsg-&gt;<a class="code" href="classGameAPIResizeAOIMessage.html#ae8df0a2a6adc664d2dc8a5c0291f9f49">setAOIsize</a>(<a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a>);
        send( gameMsg, <span class="stringliteral">&quot;appOut&quot;</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4af2596c5cc972a1c4dacfde82c989ee"></a><!-- doxytag: member="PubSubMMOG::handleUDPMessage" ref="a4af2596c5cc972a1c4dacfde82c989ee" args="(BaseOverlayMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleUDPMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseOverlayMessage.html">BaseOverlayMessage</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Processes messages from underlay. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message from UDP </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classBaseOverlay.html#a31d7dd39ddc9e62ad92f69f6d7210344">BaseOverlay</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00244">244</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span>( <a class="code" href="classPubSubMoveListMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubMoveListMessage</a>* moveMsg = dynamic_cast&lt;PubSubMoveListMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#a9d46909d81ca32d3ec2020a7184c3f50">handleMoveListMessage</a>( moveMsg );
        <span class="keyword">delete</span> moveMsg;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classPubSubMoveMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubMoveMessage</a>* moveMsg = dynamic_cast&lt;PubSubMoveMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#aa5f5b3bb6f7a4a26ab45dfdb6248f21b">handleMoveMessage</a>( moveMsg );
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classPubSubUnsubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubUnsubscriptionMessage</a>* unsMsg = dynamic_cast&lt;PubSubUnsubscriptionMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#a1e837eb023ac96a24c564e8c42da7c87">handleUnsubscriptionMessage</a>( unsMsg );
        <span class="keyword">delete</span> unsMsg;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>* leftMsg = dynamic_cast&lt;PubSubNodeLeftMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#a73afcba7483897f08cfb5d258e569683">handleNodeLeftMessage</a>( leftMsg );
        <span class="keyword">delete</span> leftMsg;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classPubSubReplacementMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubReplacementMessage</a>* replaceMsg = dynamic_cast&lt;PubSubReplacementMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#abd3f25e6c1521cc5d6959fc1929a2ac6">handleReplacementMessage</a>( replaceMsg );
        <span class="keyword">delete</span> replaceMsg;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classPubSubBackupSubscriptionMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupSubscriptionMessage</a>* backupMsg = dynamic_cast&lt;PubSubBackupSubscriptionMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#a354f1a0173cb3cc5a00bc7d16d17f73a">handleSubscriptionBackup</a>( backupMsg );
        <span class="keyword">delete</span> backupMsg;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classPubSubBackupUnsubscribeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupUnsubscribeMessage</a>* backupMsg = dynamic_cast&lt;PubSubBackupUnsubscribeMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#a74e961ef109ba657e32f82519721eeaf">handleUnsubscribeBackup</a>( backupMsg );
        <span class="keyword">delete</span> backupMsg;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classPubSubBackupIntermediateMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupIntermediateMessage</a>* backupMsg = dynamic_cast&lt;PubSubBackupIntermediateMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#a77b144f6034216ef0184589cf5b4da8d">handleIntermediateBackup</a>( backupMsg );
        <span class="keyword">delete</span> backupMsg;
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classPubSubReleaseIntermediateMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubReleaseIntermediateMessage</a>* releaseMsg = dynamic_cast&lt;PubSubReleaseIntermediateMessage*&gt;(msg) ){
        <a class="code" href="classPubSubMMOG.html#af1197b5fab38765c9e510cb6e755f62a">handleReleaseIntermediate</a>( releaseMsg );
        <span class="keyword">delete</span> releaseMsg;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a74e961ef109ba657e32f82519721eeaf"></a><!-- doxytag: member="PubSubMMOG::handleUnsubscribeBackup" ref="a74e961ef109ba657e32f82519721eeaf" args="(PubSubBackupUnsubscribeMessage *backupMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleUnsubscribeBackup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubBackupUnsubscribeMessage.html">PubSubBackupUnsubscribeMessage</a> *&#160;</td>
          <td class="paramname"><em>backupMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01579">1579</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Note: this funktion may break subspace&#39;s tatalChildrenCall</span>
    <span class="comment">// You have to use fixTotalChildrenCount before using the subspace</span>
    <span class="comment">// find appropriate subspace</span>
    <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a> subspaceId(backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#abd6c02f362cbe028c6734790c58c0f7a">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.find( subspaceId );
    <span class="keywordflow">if</span>( it == <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a>.end() ) {
        <span class="keywordflow">return</span>;
    }
    <a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;

    deque&lt;PubSubSubspaceResponsible::IntermediateNode&gt;::iterator iit;
    set&lt;NodeHandle&gt;::iterator childIt;

    <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#ada0034be890586e3cc0305bfa089e031">removeChild</a>(backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#a67e1e3ffdb3722403645fbfdf007ae57">getChild</a>()) &amp;&amp; !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.erase( backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#a67e1e3ffdb3722403645fbfdf007ae57">getChild</a>()) ){
        <span class="keywordflow">for</span>( iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin(); iit != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end(); ++iit ){
            iit-&gt;<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.erase( backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#a67e1e3ffdb3722403645fbfdf007ae57">getChild</a>() );
        }
    }
    <span class="keywordflow">if</span>( !backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#a35249f2b557ff54817a03fcaa927f148">getIntermediate</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
        <span class="comment">// remove intermediate</span>
        <span class="keywordflow">for</span>( iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin(); iit != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end(); ++iit ){
            <span class="keywordflow">if</span>( !iit-&gt;node.isUnspecified() &amp;&amp; iit-&gt;node == backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#a35249f2b557ff54817a03fcaa927f148">getIntermediate</a>() ){
                <span class="keywordflow">for</span>( childIt = iit-&gt;children.begin(); childIt != iit-&gt;children.end(); ++childIt ){
                    <span class="comment">// FIXME: note really stable. let the resp node inform us about child moves</span>
                    <span class="comment">// remove children of last intermediate</span>
                    <span class="keywordflow">if</span>( subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#a17ae7d975c0ae11c5b8e25c970e2fdb4">getNumChildren</a>() + subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0037dfdbb81b9918713cba46ad994cb9">getNumIntermediates</a>() &lt; <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> ){
                        <span class="comment">// we have room for the child</span>
                        subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.insert( *childIt );
                    } <span class="keywordflow">else</span> {
                        <span class="comment">// Node has to go to some intermediate</span>
                        <span class="comment">// cache it</span>
                        subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert( make_pair(*childIt, <span class="keyword">true</span>) );
                    }
                }
                subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.erase( iit );
                <span class="keywordflow">break</span>;
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1e837eb023ac96a24c564e8c42da7c87"></a><!-- doxytag: member="PubSubMMOG::handleUnsubscriptionMessage" ref="a1e837eb023ac96a24c564e8c42da7c87" args="(PubSubUnsubscriptionMessage *unsMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::handleUnsubscriptionMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubUnsubscriptionMessage.html">PubSubUnsubscriptionMessage</a> *&#160;</td>
          <td class="paramname"><em>unsMsg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00422">422</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.find( <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>(unsMsg-&gt;<a class="code" href="classPubSubUnsubscriptionMessage.html#aefd5581bbccb1322572d4623a9b7098c">getSubspaceId</a>(), <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>) );

    <span class="keywordflow">if</span>( it != <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end() ) {
        <a class="code" href="classPubSubMMOG.html#a104570a1f3f3f4951bf67e9b8e09b0e8">unsubscribeChild</a>( unsMsg-&gt;<a class="code" href="classPubSubUnsubscriptionMessage.html#a4c20f9918ebc12a6567fb6600abbca19">getSrc</a>(), it-&gt;second );
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a42a189f235425d0cc5706857f3122283"></a><!-- doxytag: member="PubSubMMOG::initializeOverlay" ref="a42a189f235425d0cc5706857f3122283" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::initializeOverlay </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes derived-class-attributes. </p>
<p><br/>
</p>
<p>Initializes derived-class-attributes, called by <a class="el" href="classBaseOverlay.html#a9738ba6065b0f699f1921bbe82ab97be" title="initializes base-class-attributes">BaseOverlay::initialize()</a>. By default this method is called once. If more stages are needed one can overload <a class="el" href="classBaseOverlay.html#a3234dfcf81463984e88a42432734a615" title="Sets init stage.">numInitStages()</a> and add more stages.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">stage</td><td>the init stage </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classBaseOverlay.html#a41f88dfbea856a2b38319ff52c758c96">BaseOverlay</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00036">36</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// because of IPAddressResolver, we need to wait until interfaces are registered,</span>
    <span class="comment">// address auto-assignment takes place etc.</span>
    <span class="keywordflow">if</span>(stage != <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532a58e83c497c7c8495e9c592ff3148b6b9" title="first stage for overlay modules (Tier 0 / KBR)">MIN_STAGE_OVERLAY</a>) <span class="keywordflow">return</span>;

    <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> = <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fa4c1b397f6c4682baf7db280e7f15520a">INIT</a>;
    <a class="code" href="classPubSubMMOG.html#a3e573d9ce39091daea435016a587b239">setBootstrapedIcon</a>();
    <span class="comment">// TODO: use BootstrapList instead (but this currently preferes</span>
    <span class="comment">//       nodes from the same partition)</span>
    <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a> = <a class="code" href="classBaseOverlay.html#a933e505ea77cae4ab0c8edcb77ade2c7" title="pointer to GlobalNodeList in this node">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#ac2b8737b7228a19ddc599adddfbdc5e9" title="Returns a random NodeHandle.">getBootstrapNode</a>();

    <a class="code" href="classPubSubMMOG.html#a04199b677abdfd25b29f9a5f79c19426">joinTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;join timer&quot;</span>);
    simtime_t joinTime = ceil(simTime() + (simtime_t) par(<span class="stringliteral">&quot;joinDelay&quot;</span>));
    scheduleAt( joinTime, <a class="code" href="classPubSubMMOG.html#a04199b677abdfd25b29f9a5f79c19426">joinTimer</a> );

    <a class="code" href="classPubSubMMOG.html#a228fe6f61d1fe510d1336296c4bf254c">movementRate</a> = par(<span class="stringliteral">&quot;movementRate&quot;</span>);
    <a class="code" href="classPubSubMMOG.html#a5c7d73c47298f65748e65abc506b9611">eventDeliveryTimer</a> = <span class="keyword">new</span> <a class="code" href="classPubSubTimer.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubTimer</a>(<span class="stringliteral">&quot;event delivery timer&quot;</span>);
    <a class="code" href="classPubSubMMOG.html#a5c7d73c47298f65748e65abc506b9611">eventDeliveryTimer</a>-&gt;<a class="code" href="classPubSubTimer.html#a041b4f4cc94f506b4b94877957509834">setType</a>( <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04cab87b77accd020036a875063be27c753c">PUBSUB_EVENTDELIVERY</a> );
    scheduleAt( joinTime + 1.0/(2*<a class="code" href="classPubSubMMOG.html#a228fe6f61d1fe510d1336296c4bf254c">movementRate</a>), <a class="code" href="classPubSubMMOG.html#a5c7d73c47298f65748e65abc506b9611">eventDeliveryTimer</a> );

    <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a> = par(<span class="stringliteral">&quot;numSubspaces&quot;</span>);
    <a class="code" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">subspaceSize</a> = (int) ( (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) par(<span class="stringliteral">&quot;areaDimension&quot;</span>) / <a class="code" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">numSubspaces</a>);
    <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#af3992f1fda9ea42dc10bf4739e47700a" title="saves given key to NodeHandle::key">setKey</a>( <a class="code" href="classOverlayKey.html#a1983e1b47e32783f8ccd5e59fe725290" title="Returns a random key.">OverlayKey::random</a>() );

    <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> = par(<span class="stringliteral">&quot;maxChildren&quot;</span>);
    <a class="code" href="classPubSubSubspaceResponsible.html#a5dfd7f5d997726d5c8f158a371cee621">PubSubSubspaceResponsible::maxChildren</a> = <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a>;

    <a class="code" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">AOIWidth</a> = par(<span class="stringliteral">&quot;AOIWidth&quot;</span>);
    <a class="code" href="classPubSubMMOG.html#a219753e4fc3eae95cd21f70bc40017e7">maxMoveDelay</a> = par(<span class="stringliteral">&quot;maxMoveDelay&quot;</span>);

    <a class="code" href="classPubSubMMOG.html#a98fd6baf72474a184c902133581273fa">parentTimeout</a> = par(<span class="stringliteral">&quot;parentTimeout&quot;</span>);
    <a class="code" href="classPubSubMMOG.html#aebf88e5c0a0f294c706c3281b1aae373">heartbeatTimer</a> = <span class="keyword">new</span> <a class="code" href="classPubSubTimer.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubTimer</a>(<span class="stringliteral">&quot;HeartbeatTimer&quot;</span>);
    <a class="code" href="classPubSubMMOG.html#aebf88e5c0a0f294c706c3281b1aae373">heartbeatTimer</a>-&gt;<a class="code" href="classPubSubTimer.html#a041b4f4cc94f506b4b94877957509834">setType</a>( <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04caec28dc4bd962108ceb27575f46b81ebd">PUBSUB_HEARTBEAT</a> );
    <a class="code" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a>( <a class="code" href="classPubSubMMOG.html#aebf88e5c0a0f294c706c3281b1aae373">heartbeatTimer</a> );
    <a class="code" href="classPubSubMMOG.html#a2540cd40427d53404d3adbca173cfd6c">childPingTimer</a> = <span class="keyword">new</span> <a class="code" href="classPubSubTimer.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubTimer</a>(<span class="stringliteral">&quot;ChildPingTimer&quot;</span>);
    <a class="code" href="classPubSubMMOG.html#a2540cd40427d53404d3adbca173cfd6c">childPingTimer</a>-&gt;<a class="code" href="classPubSubTimer.html#a041b4f4cc94f506b4b94877957509834">setType</a>( <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04caa64f2984ebaaa94fb52bc3ff99d24fa1">PUBSUB_CHILDPING</a> );
    <a class="code" href="classPubSubMMOG.html#a7544c76d3fceee2a56dee1bdf63c4db1">startTimer</a>( <a class="code" href="classPubSubMMOG.html#a2540cd40427d53404d3adbca173cfd6c">childPingTimer</a> );

    <a class="code" href="classPubSubMMOG.html#aced8c7945b0f77560359167cc5f398f6">allowOldMoveMessages</a>  = par(<span class="stringliteral">&quot;allowOldMoveMessages&quot;</span>);

    <a class="code" href="classPubSubMMOG.html#aa809123a9ef7f64ea622400ed60a2d4c">numEventsWrongTimeslot</a> = <a class="code" href="classPubSubMMOG.html#a0adb17b77190fd14c0979fe39a5889cc">numEventsCorrectTimeslot</a> = 0;
    <a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a> = 0;
    <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a> = 0;
    <a class="code" href="classPubSubMMOG.html#a11ca86e89977d8bb4d1512a5e64ce8d3">numMoveMessages</a> = 0;
    <a class="code" href="classPubSubMMOG.html#a122b6f4eacfc82a453cdabace026a0d5">moveMessagesSize</a> = 0;
    <a class="code" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">numMoveListMessages</a> = 0;
    <a class="code" href="classPubSubMMOG.html#a5a665dd74681081d669ea57efd5d83b0">moveListMessagesSize</a> = 0;
    <a class="code" href="classPubSubMMOG.html#a4561eb4e380c7aea874ea622b9145603">respMoveListMessagesSize</a> = 0;
    <a class="code" href="classPubSubMMOG.html#a1450e36b5a7103fe4581f271fac13340">lostMovementLists</a> = 0;
    <a class="code" href="classPubSubMMOG.html#a8415fe6a47b3b961fd54f9e3b5f8d3f0">receivedMovementLists</a> = 0;
    WATCH( <a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#a11ca86e89977d8bb4d1512a5e64ce8d3">numMoveMessages</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#a122b6f4eacfc82a453cdabace026a0d5">moveMessagesSize</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">numMoveListMessages</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#a5a665dd74681081d669ea57efd5d83b0">moveListMessagesSize</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#aa809123a9ef7f64ea622400ed60a2d4c">numEventsWrongTimeslot</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#a0adb17b77190fd14c0979fe39a5889cc">numEventsCorrectTimeslot</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#a1450e36b5a7103fe4581f271fac13340">lostMovementLists</a> );
    WATCH( <a class="code" href="classPubSubMMOG.html#a8415fe6a47b3b961fd54f9e3b5f8d3f0">receivedMovementLists</a> );
    WATCH_LIST( <a class="code" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">subscribedSubspaces</a> );
    WATCH_MAP( <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a> );
    WATCH_MAP( <a class="code" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">backupSubspaces</a> );
    WATCH_MAP( <a class="code" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">intermediateSubspaces</a> );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3c4d846c243253afb0f72592e44590ff"></a><!-- doxytag: member="PubSubMMOG::publishEvents" ref="a3c4d846c243253afb0f72592e44590ff" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::publishEvents </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01851">1851</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// FOr all (responsible) subspaces</span>
    <span class="keywordtype">int</span> numRespSubspaces = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.size();
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    <span class="keywordflow">for</span>( it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.begin(); it != <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end(); ++it ){
        <a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&amp; subspace = it-&gt;second;

        <span class="comment">// Prepare a movement list message aggregating all stored move messages</span>
        <a class="code" href="classPubSubMoveListMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubMoveListMessage</a>* moveList = <span class="keyword">new</span> <a class="code" href="classPubSubMoveListMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubMoveListMessage</a>(<span class="stringliteral">&quot;Movement list&quot;</span>);
        moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a29a663e3ab95721f0eeeb2740331fd7e">setTimestamp</a>( simTime() );
        moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a1295c70bfc4ff914b1fa0ef2d85f3952">setSubspaceId</a>( subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>().<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>() );
        moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a7cfc3016cda8ffe6a48efb921b17d454">setPlayerArraySize</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a3f199ce5648d14d4faf8672db1b9e8c7">waitingMoveMessages</a>.size() );
        moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#ac471ea4143307ab400a66a5d570a3579">setPositionArraySize</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a3f199ce5648d14d4faf8672db1b9e8c7">waitingMoveMessages</a>.size() );
        moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a5d28566e440f12fcc2adc5c13063def8">setPositionAgeArraySize</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a3f199ce5648d14d4faf8672db1b9e8c7">waitingMoveMessages</a>.size() );

        std::deque&lt;PubSubMoveMessage*&gt;::iterator msgIt;
        <span class="keywordtype">int</span> pos = 0;
        <span class="keywordflow">for</span>( msgIt = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a3f199ce5648d14d4faf8672db1b9e8c7">waitingMoveMessages</a>.begin(); msgIt != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a3f199ce5648d14d4faf8672db1b9e8c7">waitingMoveMessages</a>.end(); ++msgIt ){
            moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a2b40bae9aa526d91741eec67f0f3b6e2">setPlayer</a>( pos, (*msgIt)-&gt;getPlayer() );
            moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a82f4f379dbdb32a4d4f0db2b1d6ad2a0">setPosition</a>( pos, (*msgIt)-&gt;getPosition() );
            moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#ad60d1703ea48593d5c8e27f810b17a98">setPositionAge</a>( pos, simTime() - (*msgIt)-&gt;getCreationTime() );
            pos++;
            cancelAndDelete( *msgIt );
        }
        subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a3f199ce5648d14d4faf8672db1b9e8c7">waitingMoveMessages</a>.clear();

        moveList-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a874c79322e2687e6c465d6c75129b8df">PUBSUB_MOVELIST_L</a>( moveList ));
        <span class="comment">// Send message to all direct children...</span>
        <span class="keywordflow">for</span>( set&lt;NodeHandle&gt;::iterator childIt = subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.begin();
                childIt != subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.end(); ++childIt )
        {
            <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                    ++<a class="code" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">numMoveListMessages</a>;
                    <a class="code" href="classPubSubMMOG.html#a5a665dd74681081d669ea57efd5d83b0">moveListMessagesSize</a>+= moveList-&gt;getByteLength();
                    <a class="code" href="classPubSubMMOG.html#a4561eb4e380c7aea874ea622b9145603">respMoveListMessagesSize</a>+= (int)((<span class="keywordtype">double</span>) moveList-&gt;getByteLength() / numRespSubspaces)
                    );
            <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( *childIt, (<a class="code" href="classBaseOverlayMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseOverlayMessage</a>*) moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a5d61d0f12b29063f944e6fd5775d3da7">dup</a>() );
        }

        <span class="comment">//... all cached children (if messages are not too big) ...</span>
        <span class="keywordflow">if</span>( moveList-&gt;getByteLength() &lt; 1024 ){ <span class="comment">// FIXME: magic number. make it a parameter, or dependant on the available bandwidth</span>
            <span class="keywordflow">for</span>( map&lt;NodeHandle, bool&gt;::iterator childIt = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.begin();
                    childIt != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.end(); ++childIt )
            {
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">numMoveListMessages</a>;
                        moveListMessagesSize+= moveList-&gt;getByteLength();
                        <a class="code" href="classPubSubMMOG.html#a4561eb4e380c7aea874ea622b9145603">respMoveListMessagesSize</a>+= (int)((<span class="keywordtype">double</span>) moveList-&gt;getByteLength() / numRespSubspaces)
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( childIt-&gt;first, (<a class="code" href="classBaseOverlayMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseOverlayMessage</a>*) moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a5d61d0f12b29063f944e6fd5775d3da7">dup</a>() );
                <span class="comment">// ... but don&#39;t send msgs to too many cached children, as this would exhaust our bandwidth</span>
            }
        }

        <span class="comment">// ... all direct intermediates and intermediates with broken parent</span>
        deque&lt;PubSubSubspaceResponsible::IntermediateNode&gt;::iterator iit;
        <span class="keywordflow">for</span>( iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin(); iit != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end(); ++iit )
        {
            <span class="keywordtype">int</span> intermediatePos = iit - subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin();
            <span class="keywordflow">if</span>( intermediatePos &gt;= <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> &amp;&amp;
                  !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[intermediatePos/<a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> -1].node.isUnspecified() ) <span class="keywordflow">continue</span>;
            <span class="keywordflow">if</span>( !iit-&gt;node.isUnspecified() ) {
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">numMoveListMessages</a>;
                        moveListMessagesSize+= moveList-&gt;getByteLength();
                        <a class="code" href="classPubSubMMOG.html#a4561eb4e380c7aea874ea622b9145603">respMoveListMessagesSize</a>+= (int)((<span class="keywordtype">double</span>) moveList-&gt;getByteLength() / numRespSubspaces)
                );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( iit-&gt;node, (<a class="code" href="classBaseOverlayMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseOverlayMessage</a>*) moveList-&gt;<a class="code" href="classPubSubMoveListMessage.html#a5d61d0f12b29063f944e6fd5775d3da7">dup</a>() );
            }
        }

        <span class="keyword">delete</span> moveList;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac789c61936dbd0e4787822022f0ecfba"></a><!-- doxytag: member="PubSubMMOG::receiveChangeNotification" ref="ac789c61936dbd0e4787822022f0ecfba" args="(int category, const cPolymorphic *details)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::receiveChangeNotification </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>category</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cPolymorphic *&#160;</td>
          <td class="paramname"><em>details</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>callback-method for events at the NotificationBoard </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">category</td><td>... TODO ... </td></tr>
    <tr><td class="paramname">details</td><td>... TODO ... </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classBaseOverlay.html#ac1cf471c2918271ed0244e4a9579c878">BaseOverlay</a>.</p>

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l00535">535</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span>(category == NF_OVERLAY_NODE_GRACEFUL_LEAVE &amp;&amp; <a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> == <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fab3a263fb274a58d63b15cd61ba910335">READY</a>) {
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a237b78a3abc9b6cbb95021e25306e2e2"></a><!-- doxytag: member="PubSubMMOG::sendHearbeatToChildren" ref="a237b78a3abc9b6cbb95021e25306e2e2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::sendHearbeatToChildren </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01227">1227</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    <span class="keywordflow">for</span>( it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.begin(); it != <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end(); ++it) {
        <a class="code" href="classPubSubPingCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubPingCall</a>* bHeartbeat = <span class="keyword">new</span> <a class="code" href="classPubSubPingCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubPingCall</a>(<span class="stringliteral">&quot;Heartbeat Backup&quot;</span>);
        bHeartbeat-&gt;<a class="code" href="classPubSubPingCall.html#a1e17478f614c712ac5fa0d51cd750cb1">setPingType</a>( <a class="code" href="PubSubMessage__m_8h.html#a955af4961bb8702caeddf04706c0681ba4bcfe90f539ae081948077a9d0c1d992">PUBSUB_PING_BACKUP</a> );
        bHeartbeat-&gt;<a class="code" href="classPubSubPingCall.html#a9a24a971b4ffec664ceda5cc1b0ed8f6">setSubspaceId</a>( it-&gt;second.getId().getId() );
        bHeartbeat-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a5afa100d3f724e66abc9356ec55342b5">PUBSUB_PINGCALL_L</a>( bHeartbeat ));

        <a class="code" href="classPubSubPingCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubPingCall</a>* iHeartbeat = <span class="keyword">new</span> <a class="code" href="classPubSubPingCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubPingCall</a>(<span class="stringliteral">&quot;Heartbeat Intermediate&quot;</span>);
        iHeartbeat-&gt;<a class="code" href="classPubSubPingCall.html#a1e17478f614c712ac5fa0d51cd750cb1">setPingType</a>( <a class="code" href="PubSubMessage__m_8h.html#a955af4961bb8702caeddf04706c0681ba3402d727b81d4511a52d09df2252918c">PUBSUB_PING_INTERMEDIATE</a> );
        iHeartbeat-&gt;<a class="code" href="classPubSubPingCall.html#a9a24a971b4ffec664ceda5cc1b0ed8f6">setSubspaceId</a>( it-&gt;second.getId().getId() );
        iHeartbeat-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a5afa100d3f724e66abc9356ec55342b5">PUBSUB_PINGCALL_L</a>( iHeartbeat ));

        <a class="code" href="classPubSubMMOG.html#aedde86c47759c2ab5b61744c7065377c">sendMessageToChildren</a>( it-&gt;second, iHeartbeat, bHeartbeat, NULL);
        <span class="keyword">delete</span> bHeartbeat;
        <span class="keyword">delete</span> iHeartbeat;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aedde86c47759c2ab5b61744c7065377c"></a><!-- doxytag: member="PubSubMMOG::sendMessageToChildren" ref="aedde86c47759c2ab5b61744c7065377c" args="(PubSubSubspaceResponsible &amp;subspace, BaseOverlayMessage *toIntermediates, BaseOverlayMessage *toBackup, BaseOverlayMessage *toPlayers)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::sendMessageToChildren </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> &amp;&#160;</td>
          <td class="paramname"><em>subspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBaseOverlayMessage.html">BaseOverlayMessage</a> *&#160;</td>
          <td class="paramname"><em>toIntermediates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBaseOverlayMessage.html">BaseOverlayMessage</a> *&#160;</td>
          <td class="paramname"><em>toBackup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBaseOverlayMessage.html">BaseOverlayMessage</a> *&#160;</td>
          <td class="paramname"><em>toPlayers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01749">1749</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classBaseCallMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseCallMessage</a>* intermediateCall = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classBaseCallMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseCallMessage</a>*<span class="keyword">&gt;</span>(toIntermediates);
    <a class="code" href="classBaseCallMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseCallMessage</a>* backupCall = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classBaseCallMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseCallMessage</a>*<span class="keyword">&gt;</span>(toBackup);
    <a class="code" href="classBaseCallMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseCallMessage</a>* playerCall = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classBaseCallMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseCallMessage</a>*<span class="keyword">&gt;</span>(toPlayers);

    std::set&lt;NodeHandle&gt;::iterator childIt;

    <span class="keywordflow">if</span>( toPlayers ) {
        <span class="comment">// Inform all children ...</span>
        <span class="keywordflow">for</span>( childIt = subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.begin(); childIt != subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.end(); ++childIt ) {
            <span class="keywordflow">if</span>( playerCall ){
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= playerCall-&gt;getByteLength()
                        );
                <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( *childIt, static_cast&lt;BaseCallMessage*&gt;(playerCall-&gt;<a class="code" href="classBaseCallMessage.html#a2e1b28efce2f3b0b45c6b101b9515704">dup</a>()) );
            } <span class="keywordflow">else</span> {
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= toPlayers-&gt;getByteLength()
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( *childIt, static_cast&lt;BaseOverlayMessage*&gt;(toPlayers-&gt;<a class="code" href="classBaseOverlayMessage.html#ade9ac38d77f492e194e6f1129590f409">dup</a>()) );
            }
        }
        <span class="comment">// ... and all cached children ...</span>
        std::map&lt;NodeHandle, bool&gt;::iterator cacheChildIt;
        <span class="keywordflow">for</span>( cacheChildIt = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.begin(); cacheChildIt != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.end(); ++cacheChildIt ) {
            <span class="keywordflow">if</span>( playerCall ){
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= playerCall-&gt;getByteLength()
                        );
                <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( cacheChildIt-&gt;first, static_cast&lt;BaseCallMessage*&gt;(playerCall-&gt;<a class="code" href="classBaseCallMessage.html#a2e1b28efce2f3b0b45c6b101b9515704">dup</a>()) );
            } <span class="keywordflow">else</span> {
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= toPlayers-&gt;getByteLength()
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( cacheChildIt-&gt;first, static_cast&lt;BaseOverlayMessage*&gt;(toPlayers-&gt;<a class="code" href="classBaseOverlayMessage.html#ade9ac38d77f492e194e6f1129590f409">dup</a>()) );
            }
        }
    }
    deque&lt;PubSubSubspaceResponsible::IntermediateNode&gt;::iterator iit;
    <span class="comment">// ... all intermediate nodes ...</span>
    <span class="keywordflow">for</span>( iit = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.begin(); iit != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.end(); ++iit ){
        <span class="keywordflow">if</span>( toIntermediates &amp;&amp; !iit-&gt;node.isUnspecified() ){
            <span class="keywordflow">if</span>( intermediateCall ){
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= intermediateCall-&gt;getByteLength()
                        );
                <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( iit-&gt;node, static_cast&lt;BaseCallMessage*&gt;(intermediateCall-&gt;<a class="code" href="classBaseCallMessage.html#a2e1b28efce2f3b0b45c6b101b9515704">dup</a>()) );
            } <span class="keywordflow">else</span> {
                <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                        ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                        pubSubSignalingMessagesSize+= toIntermediates-&gt;getByteLength()
                        );
                <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( iit-&gt;node, static_cast&lt;BaseOverlayMessage*&gt;(toIntermediates-&gt;<a class="code" href="classBaseOverlayMessage.html#ade9ac38d77f492e194e6f1129590f409">dup</a>()) );
            }
        }
        <span class="keywordflow">if</span>( toPlayers ) {
            <span class="comment">// .. and all intermediate node&#39;s children ...</span>
            <span class="keywordflow">for</span>( childIt = iit-&gt;children.begin(); childIt != iit-&gt;children.end(); ++childIt ){
                <span class="keywordflow">if</span>( playerCall ){
                    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                            pubSubSignalingMessagesSize+= playerCall-&gt;getByteLength()
                            );
                    <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( *childIt, static_cast&lt;BaseCallMessage*&gt;(playerCall-&gt;<a class="code" href="classBaseCallMessage.html#a2e1b28efce2f3b0b45c6b101b9515704">dup</a>()) );
                } <span class="keywordflow">else</span> {
                    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                            pubSubSignalingMessagesSize+= toPlayers-&gt;getByteLength()
                            );
                    <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( *childIt, static_cast&lt;BaseOverlayMessage*&gt;(toPlayers-&gt;<a class="code" href="classBaseOverlayMessage.html#ade9ac38d77f492e194e6f1129590f409">dup</a>()) );
                }
            }
        }
    }
    <span class="comment">// ... and the backup node</span>
    <span class="keywordflow">if</span>( toBackup &amp;&amp; !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ) {
        <span class="keywordflow">if</span>( backupCall ){
            <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                    ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                    pubSubSignalingMessagesSize+= backupCall-&gt;getByteLength()
                    );
            <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>(), <span class="keyword">static_cast&lt;</span><a class="code" href="classBaseCallMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseCallMessage</a>*<span class="keyword">&gt;</span>(backupCall-&gt;<a class="code" href="classBaseCallMessage.html#a2e1b28efce2f3b0b45c6b101b9515704">dup</a>()) );
        } <span class="keywordflow">else</span> {
            <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                    ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                    pubSubSignalingMessagesSize+= toBackup-&gt;getByteLength()
                    );
            <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>(), <span class="keyword">static_cast&lt;</span><a class="code" href="classBaseOverlayMessage.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">BaseOverlayMessage</a>*<span class="keyword">&gt;</span>(toBackup-&gt;<a class="code" href="classBaseOverlayMessage.html#ade9ac38d77f492e194e6f1129590f409">dup</a>()) );
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="abd00be445c110f527365d00553713334"></a><!-- doxytag: member="PubSubMMOG::sendPingToChildren" ref="abd00be445c110f527365d00553713334" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::sendPingToChildren </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01247">1247</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::map&lt;PubSubSubspaceId, PubSubSubspaceResponsible&gt;::iterator it;
    <span class="keywordflow">for</span>( it = <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.begin(); it != <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.end(); ++it) {
        <a class="code" href="classPubSubPingCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubPingCall</a>* heartbeat = <span class="keyword">new</span> <a class="code" href="classPubSubPingCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubPingCall</a>(<span class="stringliteral">&quot;Ping&quot;</span>);
        heartbeat-&gt;<a class="code" href="classPubSubPingCall.html#a1e17478f614c712ac5fa0d51cd750cb1">setPingType</a>( <a class="code" href="PubSubMessage__m_8h.html#a955af4961bb8702caeddf04706c0681ba6be4bc3a5b9c7bee39a3eed787e5eb90">PUBSUB_PING_CHILD</a> );
        heartbeat-&gt;<a class="code" href="classPubSubPingCall.html#a9a24a971b4ffec664ceda5cc1b0ed8f6">setSubspaceId</a>( it-&gt;second.getId().getId() );
        heartbeat-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a5afa100d3f724e66abc9356ec55342b5">PUBSUB_PINGCALL_L</a>( heartbeat ));
        <a class="code" href="classPubSubMMOG.html#aedde86c47759c2ab5b61744c7065377c">sendMessageToChildren</a>( it-&gt;second, NULL, NULL, heartbeat );
        <span class="keyword">delete</span> heartbeat;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3e573d9ce39091daea435016a587b239"></a><!-- doxytag: member="PubSubMMOG::setBootstrapedIcon" ref="a3e573d9ce39091daea435016a587b239" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::setBootstrapedIcon </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01927">1927</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span>(ev.isGUI()) {
        <span class="keywordflow">if</span>(<a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> == <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fab3a263fb274a58d63b15cd61ba910335">READY</a>) {
            getParentModule()-&gt;getParentModule()-&gt;getDisplayString().setTagArg(<span class="stringliteral">&quot;i2&quot;</span>, 1, <span class="stringliteral">&quot;green&quot;</span>);
            getDisplayString().setTagArg(<span class="stringliteral">&quot;i&quot;</span>, 1, <span class="stringliteral">&quot;green&quot;</span>);
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classBaseOverlay.html#ab4be6d88417117fbf33a445d56af2655">state</a> == <a class="code" href="classBaseOverlay.html#a0ad4b12b0c9949661f66db7fbbf7d40fa40c37f1f56c6ed8e40ae467e67e61cab">JOIN</a>) {
            getParentModule()-&gt;getParentModule()-&gt;getDisplayString().setTagArg(<span class="stringliteral">&quot;i2&quot;</span>, 1, <span class="stringliteral">&quot;yellow&quot;</span>);
            getDisplayString().setTagArg(<span class="stringliteral">&quot;i&quot;</span>, 1, <span class="stringliteral">&quot;yellow&quot;</span>);
        }
        <span class="keywordflow">else</span> {
            getParentModule()-&gt;getParentModule()-&gt;getDisplayString().setTagArg(<span class="stringliteral">&quot;i2&quot;</span>, 1, <span class="stringliteral">&quot;red&quot;</span>);
            getDisplayString().setTagArg(<span class="stringliteral">&quot;i&quot;</span>, 1, <span class="stringliteral">&quot;red&quot;</span>);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7544c76d3fceee2a56dee1bdf63c4db1"></a><!-- doxytag: member="PubSubMMOG::startTimer" ref="a7544c76d3fceee2a56dee1bdf63c4db1" args="(PubSubTimer *timer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::startTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubTimer.html">PubSubTimer</a> *&#160;</td>
          <td class="paramname"><em>timer</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01945">1945</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span>( !timer ) {
        EV &lt;&lt; <span class="stringliteral">&quot;[PubSubMMOG::startTimer() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
           &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    WARNING! Trying to start NULL timer @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
           &lt;&lt; endl;
        <span class="keywordflow">return</span>;
    }

    <span class="keywordflow">if</span>( timer-&gt;isScheduled() ) {
        cancelEvent( timer );
    }

    simtime_t duration = 0;
    <span class="keywordflow">switch</span>( timer-&gt;<a class="code" href="classPubSubTimer.html#a4f1885dff2e7dc391d899e5b6b3cc92f">getType</a>() ) {
        <span class="keywordflow">case</span> <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04caec28dc4bd962108ceb27575f46b81ebd">PUBSUB_HEARTBEAT</a>:
            duration = <a class="code" href="classPubSubMMOG.html#a98fd6baf72474a184c902133581273fa">parentTimeout</a>/2;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04caa64f2984ebaaa94fb52bc3ff99d24fa1">PUBSUB_CHILDPING</a>:
            duration = <a class="code" href="classPubSubMMOG.html#a98fd6baf72474a184c902133581273fa">parentTimeout</a>*10; <span class="comment">// FIXME: make it a parameter</span>
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04cad6da37474996a5016fe145fcc24a52c8">PUBSUB_PARENT_TIMEOUT</a>:
            duration = <a class="code" href="classPubSubMMOG.html#a98fd6baf72474a184c902133581273fa">parentTimeout</a>;
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="PubSubMessage__m_8h.html#ac87923fdb9d8348a9eb766921ec0e04cab87b77accd020036a875063be27c753c">PUBSUB_EVENTDELIVERY</a>:
            duration = 1.0/<a class="code" href="classPubSubMMOG.html#a228fe6f61d1fe510d1336296c4bf254c">movementRate</a>;
            <span class="keywordflow">break</span>;
    }
    scheduleAt(simTime() + duration, timer );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0fe097eb8ff809023d0a119b2dc17d61"></a><!-- doxytag: member="PubSubMMOG::takeOverNewSubspace" ref="a0fe097eb8ff809023d0a119b2dc17d61" args="(PubSubSubspaceId subspaceId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::takeOverNewSubspace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>&#160;</td>
          <td class="paramname"><em>subspaceId</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01174">1174</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// create a new subspace</span>
    <a class="code" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> subspace( subspaceId );
    <a class="code" href="classPubSubMMOG.html#a60f9145524471fe4aa44641f1d0e6a17">takeOverSubspace</a>( subspace, <span class="keyword">true</span> );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a60f9145524471fe4aa44641f1d0e6a17"></a><!-- doxytag: member="PubSubMMOG::takeOverSubspace" ref="a60f9145524471fe4aa44641f1d0e6a17" args="(PubSubSubspaceResponsible &amp;subspaceId, bool isNew)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::takeOverSubspace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> &amp;&#160;</td>
          <td class="paramname"><em>subspaceId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isNew</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01181">1181</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <a class="code" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>&amp; subspaceId = subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>();
    <span class="keywordtype">int</span> intId = subspaceId.<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>();

    subspace.fixTotalChildrenCount();

    <a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a> oldNode = subspace.getResponsibleNode();

    <span class="comment">// insert subspace into responsible list</span>
    subspace.setResponsibleNode( <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> );
    <a class="code" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">responsibleSubspaces</a>.insert( make_pair(subspaceId, subspace) );

    <span class="comment">// request backup</span>
    <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>* helpCall = <span class="keyword">new</span> <a class="code" href="classPubSubHelpCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpCall</a>(<span class="stringliteral">&quot;I need a backup node&quot;</span>);
    helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a15d480c842e84416cea15f69225be7f9">setHelpType</a>( <a class="code" href="PubSubMessage__m_8h.html#a0a7abf0acc5a382f3b386ab1a09cd07aaa575d5ab279429401172053d228e4838">PUBSUB_BACKUP</a> );
    helpCall-&gt;<a class="code" href="classPubSubHelpCall.html#a5e3fd97479f76170ffbfcea6385dcd16">setSubspaceId</a>( intId );
    helpCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#aac95c8ba038a0a9dd3671a29330493a9">PUBSUB_HELPCALL_L</a>( helpCall ));
    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
            <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= helpCall-&gt;getByteLength()
            );
    <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, helpCall );

    <span class="keywordflow">if</span>( !isNew ) {
        <a class="code" href="classPubSubReplacementMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubReplacementMessage</a>* repMsg = <span class="keyword">new</span> <a class="code" href="classPubSubReplacementMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubReplacementMessage</a>(<span class="stringliteral">&quot;I replaced the responsible node&quot;</span>);
        repMsg-&gt;<a class="code" href="classPubSubReplacementMessage.html#aeb45a9fb0e38c4d3e5c33d4131a98655">setSubspaceId</a>( intId );
        repMsg-&gt;<a class="code" href="classPubSubReplacementMessage.html#ae8ce96ec8b68ba24f15dca2d7cf8a9d4">setNewResponsibleNode</a>( <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> );
        repMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a9dd61fb5cd5685440c7e610a2800b1f9">PUBSUB_REPLACEMENT_L</a>( repMsg ));

        <span class="comment">// Inform children and lobbyserver about takeover</span>
        <a class="code" href="classPubSubMMOG.html#aedde86c47759c2ab5b61744c7065377c">sendMessageToChildren</a>( subspace, repMsg, NULL, repMsg );
        <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, repMsg );

        <span class="comment">// inform lobby server over failed node</span>
        <a class="code" href="classPubSubFailedNodeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubFailedNodeMessage</a>* failedNode = <span class="keyword">new</span> <a class="code" href="classPubSubFailedNodeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubFailedNodeMessage</a>(<span class="stringliteral">&quot;Node failed&quot;</span>);
        failedNode-&gt;<a class="code" href="classPubSubFailedNodeMessage.html#a69484c6b7387a623c18edb86a0aca7d3">setFailedNode</a>( oldNode );
        failedNode-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#acb366745fb62311b100b1632b04b1141">PUBSUB_FAILEDNODE_L</a>( failedNode ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= failedNode-&gt;getByteLength()
                );
        <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, failedNode );
   }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a104570a1f3f3f4951bf67e9b8e09b0e8"></a><!-- doxytag: member="PubSubMMOG::unsubscribeChild" ref="a104570a1f3f3f4951bf67e9b8e09b0e8" args="(const NodeHandle &amp;node, PubSubSubspaceResponsible &amp;subspace)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PubSubMMOG::unsubscribeChild </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a> &amp;&#160;</td>
          <td class="paramname"><em>subspace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8cc_source.html#l01623">1623</a> of file <a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classPubSubBackupUnsubscribeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupUnsubscribeMessage</a>* backupMsg = <span class="keyword">new</span> <a class="code" href="classPubSubBackupUnsubscribeMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubBackupUnsubscribeMessage</a>(<span class="stringliteral">&quot;Backup: node left subspace&quot;</span>);
    backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#a89e811a65443c958acbdb0968bedf2f9">setChild</a>( node );
    backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#a6e8d85eceb4fedfd35ef4696375c47dc">setSubspaceId</a>( subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>().<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>() );
    <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a>* iNode = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a5380c2d29951d510f7dfc7808ebedf3b">removeAnyChild</a>( node );
    <span class="keywordflow">if</span>( iNode &amp;&amp; !iNode-&gt;<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>.<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ) {
        <span class="comment">// Node is handled by an intermediate node, inform him</span>
        <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>* goneMsg = <span class="keyword">new</span> <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>(<span class="stringliteral">&quot;Node left Subspace&quot;</span>);
        goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a4604631be10c1b8f9aa6db29aaa76386">setNode</a>( node );
        goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a74ae8a4726d74370cc59cae590a72ddb">setSubspaceId</a>( subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>().<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>() );
        goneMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#ac2a4c9a20c40c17b2a948f346d5ae4fc">PUBSUB_NODELEFT_L</a>( goneMsg ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                <a class="code" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">pubSubSignalingMessagesSize</a>+= goneMsg-&gt;getByteLength()
                );
        <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( iNode-&gt;<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>, goneMsg );
    }
    <span class="keywordflow">if</span> ( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() &lt; ( <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> - 1) * subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0037dfdbb81b9918713cba46ad994cb9">getNumIntermediates</a>()){<span class="comment">// FIXME: parameter when to start cleanup?</span>
        <span class="comment">// Too many &quot;free&quot; slots, remove one intermediate node</span>
        <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a>&amp; liNode = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.back();
        <span class="keywordflow">if</span>( !liNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>.<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
            <span class="comment">// Inform node + lobby about release from intermediate node status</span>
            <a class="code" href="classPubSubReleaseIntermediateMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubReleaseIntermediateMessage</a>* releaseMsg = <span class="keyword">new</span> <a class="code" href="classPubSubReleaseIntermediateMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubReleaseIntermediateMessage</a>(<span class="stringliteral">&quot;I don&#39;t need you anymore as intermediate&quot;</span>);
            releaseMsg-&gt;<a class="code" href="classPubSubReleaseIntermediateMessage.html#a61d94e5f316f7726b548986e922d7528">setSubspaceId</a>( subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>().<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>() );
            releaseMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a7a3eb4a2755d7c92be0f817a2a90340a">PUBSUB_RELEASEINTERMEDIATE_L</a>( releaseMsg ));
            <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                    ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                    pubSubSignalingMessagesSize+= releaseMsg-&gt;getByteLength()
                    );
            <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( liNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>, releaseMsg );

            <a class="code" href="classPubSubHelpReleaseMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpReleaseMessage</a>* helpRMsg = <span class="keyword">new</span> <a class="code" href="classPubSubHelpReleaseMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubHelpReleaseMessage</a>(<span class="stringliteral">&quot;node is not my intermediate anymore&quot;</span>);
            helpRMsg-&gt;<a class="code" href="classPubSubHelpReleaseMessage.html#af11806852c62d44f511e96f5189c734a">setSubspaceId</a>( subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>().<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>() );
            helpRMsg-&gt;<a class="code" href="classPubSubHelpReleaseMessage.html#acd007733b0b6d9f9bd6cc13dbe15564b">setNode</a>( liNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> );
            helpRMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#add2bbabb5819a74b1655d4f4ebdc5275">PUBSUB_HELPRELEASE_L</a>( helpRMsg ));
            <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                    ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                    pubSubSignalingMessagesSize+= helpRMsg-&gt;getByteLength()
                    );
            <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( <a class="code" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">lobbyServer</a>, helpRMsg );

            <span class="comment">// inform parent of intermediate node</span>
            <span class="keywordtype">int</span> parentPos = (subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.size()-1)/<a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> -1;
            <span class="keywordflow">if</span>( parentPos &gt;= 0 ){
                <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a>&amp; parent = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>[parentPos];
                <span class="keywordflow">if</span>( !parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>.<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
                    <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>* goneMsg = <span class="keyword">new</span> <a class="code" href="classPubSubNodeLeftMessage.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubNodeLeftMessage</a>(<span class="stringliteral">&quot;Intermediate left Subspace&quot;</span>);
                    goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a4604631be10c1b8f9aa6db29aaa76386">setNode</a>( liNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> );
                    goneMsg-&gt;<a class="code" href="classPubSubNodeLeftMessage.html#a74ae8a4726d74370cc59cae590a72ddb">setSubspaceId</a>( subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>().<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>() );
                    goneMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#ac2a4c9a20c40c17b2a948f346d5ae4fc">PUBSUB_NODELEFT_L</a>( goneMsg ));
                    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                            pubSubSignalingMessagesSize+= goneMsg-&gt;getByteLength()
                            );
                    <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( parent.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>, goneMsg );
                }
            }
        }

        <span class="keywordtype">bool</span> fixNeeded = <span class="keyword">false</span>;
        set&lt;NodeHandle&gt;::iterator childIt;
        <span class="keywordflow">for</span>( childIt = liNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.begin(); childIt != liNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a2ddae3a07ad454ef312681659588b92a">children</a>.end(); ++childIt ){
            <span class="comment">// remove children of last intermediate</span>
            <span class="keywordflow">if</span>( subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#a17ae7d975c0ae11c5b8e25c970e2fdb4">getNumChildren</a>() + subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0037dfdbb81b9918713cba46ad994cb9">getNumIntermediates</a>() &lt; <a class="code" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">maxChildren</a> ){
                <span class="comment">// we have room for the child</span>
                <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceIntermediate.html#aef3a0468a7eb4cbd84f774e2de574b16">children</a>.insert( *childIt ).second ) fixNeeded = <span class="keyword">true</span>;

                <span class="comment">//FIXME: send backup new-&gt;toMe</span>
            } <span class="keywordflow">else</span> {
                <span class="comment">// Node has to go to some intermediate</span>
                <span class="comment">// find intermediate with free capacities</span>
                <a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html">PubSubSubspaceResponsible::IntermediateNode</a>* newINode;
                newINode = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a2a6d3bc5ff302065df572a07f604a3de">getNextFreeIntermediate</a>();

                <span class="keywordflow">if</span>( newINode  &amp;&amp; newINode-&gt;<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> != liNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> ){
                    <span class="comment">// cache it</span>
                    <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert( make_pair(*childIt, <span class="keyword">true</span>) ).second ) fixNeeded = <span class="keyword">true</span>;
                    <span class="comment">//FIXME: send backup new-&gt;toCache</span>

                    ++(newINode-&gt;<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#adc4e60645148ad5003649a9dd77587a6">waitingChildren</a>);

                    <span class="comment">// let him adopt the child</span>
                    <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>* adoptCall = <span class="keyword">new</span> <a class="code" href="classPubSubAdoptChildCall.html" title="Class generated from overlay/pubsubmmog/PubSubMessage.msg by opp_msgc.">PubSubAdoptChildCall</a>(<span class="stringliteral">&quot;Adopt Node&quot;</span>);
                    adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#ad057dff5f1db054f15839a20adb17f8b">setSubspaceId</a>( subspace.<a class="code" href="classPubSubSubspace.html#a68c0be6c59e362d291533d74a65aa187">getId</a>().<a class="code" href="classPubSubSubspaceId.html#afb4d71a54d5337d65bb89c27e4d4938c">getId</a>() );
                    adoptCall-&gt;<a class="code" href="classPubSubAdoptChildCall.html#a33b972c420b165433c98e9096f08ed79">setChild</a>( *childIt );
                    adoptCall-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a40172b8994bee9881c879d1f69994013">PUBSUB_ADOPTCHILDCALL_L</a>( adoptCall ));
                    <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                            ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                            pubSubSignalingMessagesSize+= adoptCall-&gt;getByteLength()
                            );
                    <a class="code" href="classBaseRpc.html#ac128e0ff0d09f81b652f7d3e00ce9441" title="Sends a Remote-Procedure-Call message to the underlay ">sendUdpRpcCall</a>( newINode-&gt;<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a>, adoptCall );
                } <span class="keywordflow">else</span> {
                    <span class="comment">// no intermediate found</span>
                    <span class="comment">// just move child to cache and wait for a new one</span>
                    <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0dad92f50458f0daf1f719c842661a7b">cachedChildren</a>.insert( make_pair(*childIt, <span class="keyword">false</span>) ).second ) fixNeeded = <span class="keyword">true</span>;
                }
            }
        }
        <span class="comment">// delete node from subspace&#39;s intermediate node list</span>
        subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ac0c251df1da2b4752784b9c77a697059">intermediateNodes</a>.pop_back();
        <span class="comment">// inform backup about deleted intermediate</span>
        backupMsg-&gt;<a class="code" href="classPubSubBackupUnsubscribeMessage.html#a616993c19f85b1e1b4ce46f74d76f160">setIntermediate</a>( liNode.<a class="code" href="classPubSubSubspaceResponsible_1_1IntermediateNode.html#a597257efca218f9499aa4e113d99e139">node</a> );

        <span class="keywordflow">if</span>( fixNeeded ) subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
    }

<span class="comment">// FIXME: just for testing</span>
<span class="keywordtype">int</span> iii = subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>();
subspace.<a class="code" href="classPubSubSubspaceResponsible.html#ab2792e92420b16f1e971e9ff83ebce70">fixTotalChildrenCount</a>();
<span class="keywordflow">if</span>( iii != subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a41dc142fbdac4eebcadd7b62ee0a822e">getTotalChildrenCount</a>() ){
    opp_error(<span class="stringliteral">&quot;Huh?&quot;</span>);
}

    <span class="keywordflow">if</span>( !subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>().<a class="code" href="classNodeHandle.html#ab5136375a4548ced7c2014a73c8743c9" title="indicates if this NodeHandle is specified">isUnspecified</a>() ){
        backupMsg-&gt;setBitLength( <a class="code" href="PubSubMessage__m_8h.html#a7e3bc76c2154625bc34828f44408df2e">PUBSUB_BACKUPUNSUBSCRIBE_L</a>( backupMsg ));
        <a class="code" href="GlobalStatistics_8h.html#af29140ebe8e0a93406a58441f7c5fec8" title="Macro used for recording statistics considering measureNetwIn parameter.">RECORD_STATS</a>(
                ++<a class="code" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">numPubSubSignalingMessages</a>;
                pubSubSignalingMessagesSize+= backupMsg-&gt;getByteLength()
                );
        <a class="code" href="classBaseOverlay.html#a10189697bd95f3de66c27c1ecf07e323" title="Sends message to underlay.">sendMessageToUDP</a>( subspace.<a class="code" href="classPubSubSubspaceResponsible.html#a0c585a0f9e8162d0bd55a9698b5bff34">getBackupNode</a>(), backupMsg );
    } <span class="keywordflow">else</span> {
        <span class="keyword">delete</span> backupMsg;
    }
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aced8c7945b0f77560359167cc5f398f6"></a><!-- doxytag: member="PubSubMMOG::allowOldMoveMessages" ref="aced8c7945b0f77560359167cc5f398f6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPubSubMMOG.html#aced8c7945b0f77560359167cc5f398f6">PubSubMMOG::allowOldMoveMessages</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00111">111</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae02428124f2ac8a32da65ce4bcc7a927"></a><!-- doxytag: member="PubSubMMOG::AOIWidth" ref="ae02428124f2ac8a32da65ce4bcc7a927" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#ae02428124f2ac8a32da65ce4bcc7a927">PubSubMMOG::AOIWidth</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00105">105</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9cb86fc744b2f9b087a66e0af879f1fc"></a><!-- doxytag: member="PubSubMMOG::backupSubspaces" ref="a9cb86fc744b2f9b087a66e0af879f1fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>, <a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&gt; <a class="el" href="classPubSubMMOG.html#a9cb86fc744b2f9b087a66e0af879f1fc">PubSubMMOG::backupSubspaces</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00101">101</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2540cd40427d53404d3adbca173cfd6c"></a><!-- doxytag: member="PubSubMMOG::childPingTimer" ref="a2540cd40427d53404d3adbca173cfd6c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPubSubTimer.html">PubSubTimer</a>* <a class="el" href="classPubSubMMOG.html#a2540cd40427d53404d3adbca173cfd6c">PubSubMMOG::childPingTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00117">117</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6adc937050de85cfcffa4561b6daee84"></a><!-- doxytag: member="PubSubMMOG::currentRegionX" ref="a6adc937050de85cfcffa4561b6daee84" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classPubSubMMOG.html#a6adc937050de85cfcffa4561b6daee84">PubSubMMOG::currentRegionX</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00113">113</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa43137704c5ad5a9fecbff8a01ce38bc"></a><!-- doxytag: member="PubSubMMOG::currentRegionY" ref="aa43137704c5ad5a9fecbff8a01ce38bc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classPubSubMMOG.html#aa43137704c5ad5a9fecbff8a01ce38bc">PubSubMMOG::currentRegionY</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00113">113</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5c7d73c47298f65748e65abc506b9611"></a><!-- doxytag: member="PubSubMMOG::eventDeliveryTimer" ref="a5c7d73c47298f65748e65abc506b9611" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPubSubTimer.html">PubSubTimer</a>* <a class="el" href="classPubSubMMOG.html#a5c7d73c47298f65748e65abc506b9611">PubSubMMOG::eventDeliveryTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00118">118</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="aebf88e5c0a0f294c706c3281b1aae373"></a><!-- doxytag: member="PubSubMMOG::heartbeatTimer" ref="aebf88e5c0a0f294c706c3281b1aae373" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPubSubTimer.html">PubSubTimer</a>* <a class="el" href="classPubSubMMOG.html#aebf88e5c0a0f294c706c3281b1aae373">PubSubMMOG::heartbeatTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00116">116</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac2ff9ed8d82f2fd97f69343cd8ee78ac"></a><!-- doxytag: member="PubSubMMOG::intermediateSubspaces" ref="ac2ff9ed8d82f2fd97f69343cd8ee78ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>, <a class="el" href="classPubSubSubspaceIntermediate.html">PubSubSubspaceIntermediate</a>&gt; <a class="el" href="classPubSubMMOG.html#ac2ff9ed8d82f2fd97f69343cd8ee78ac">PubSubMMOG::intermediateSubspaces</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00102">102</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a04199b677abdfd25b29f9a5f79c19426"></a><!-- doxytag: member="PubSubMMOG::joinTimer" ref="a04199b677abdfd25b29f9a5f79c19426" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classPubSubMMOG.html#a04199b677abdfd25b29f9a5f79c19426">PubSubMMOG::joinTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00119">119</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1e1ba5fd3c791f3aa2172e6b055f68bb"></a><!-- doxytag: member="PubSubMMOG::lobbyServer" ref="a1e1ba5fd3c791f3aa2172e6b055f68bb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTransportAddress.html">TransportAddress</a> <a class="el" href="classPubSubMMOG.html#a1e1ba5fd3c791f3aa2172e6b055f68bb">PubSubMMOG::lobbyServer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00120">120</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1450e36b5a7103fe4581f271fac13340"></a><!-- doxytag: member="PubSubMMOG::lostMovementLists" ref="a1450e36b5a7103fe4581f271fac13340" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a1450e36b5a7103fe4581f271fac13340">PubSubMMOG::lostMovementLists</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00132">132</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7d310afbff3e729b6a33f8e6614de07e"></a><!-- doxytag: member="PubSubMMOG::maxChildren" ref="a7d310afbff3e729b6a33f8e6614de07e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a7d310afbff3e729b6a33f8e6614de07e">PubSubMMOG::maxChildren</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00109">109</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a219753e4fc3eae95cd21f70bc40017e7"></a><!-- doxytag: member="PubSubMMOG::maxMoveDelay" ref="a219753e4fc3eae95cd21f70bc40017e7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a219753e4fc3eae95cd21f70bc40017e7">PubSubMMOG::maxMoveDelay</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00115">115</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5a665dd74681081d669ea57efd5d83b0"></a><!-- doxytag: member="PubSubMMOG::moveListMessagesSize" ref="a5a665dd74681081d669ea57efd5d83b0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a5a665dd74681081d669ea57efd5d83b0">PubSubMMOG::moveListMessagesSize</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00130">130</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a228fe6f61d1fe510d1336296c4bf254c"></a><!-- doxytag: member="PubSubMMOG::movementRate" ref="a228fe6f61d1fe510d1336296c4bf254c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a228fe6f61d1fe510d1336296c4bf254c">PubSubMMOG::movementRate</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00114">114</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a122b6f4eacfc82a453cdabace026a0d5"></a><!-- doxytag: member="PubSubMMOG::moveMessagesSize" ref="a122b6f4eacfc82a453cdabace026a0d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a122b6f4eacfc82a453cdabace026a0d5">PubSubMMOG::moveMessagesSize</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00128">128</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0adb17b77190fd14c0979fe39a5889cc"></a><!-- doxytag: member="PubSubMMOG::numEventsCorrectTimeslot" ref="a0adb17b77190fd14c0979fe39a5889cc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a0adb17b77190fd14c0979fe39a5889cc">PubSubMMOG::numEventsCorrectTimeslot</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00124">124</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa809123a9ef7f64ea622400ed60a2d4c"></a><!-- doxytag: member="PubSubMMOG::numEventsWrongTimeslot" ref="aa809123a9ef7f64ea622400ed60a2d4c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#aa809123a9ef7f64ea622400ed60a2d4c">PubSubMMOG::numEventsWrongTimeslot</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00123">123</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae81f55efe5b21342597e408ff3474eee"></a><!-- doxytag: member="PubSubMMOG::numMoveListMessages" ref="ae81f55efe5b21342597e408ff3474eee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#ae81f55efe5b21342597e408ff3474eee">PubSubMMOG::numMoveListMessages</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00129">129</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a11ca86e89977d8bb4d1512a5e64ce8d3"></a><!-- doxytag: member="PubSubMMOG::numMoveMessages" ref="a11ca86e89977d8bb4d1512a5e64ce8d3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a11ca86e89977d8bb4d1512a5e64ce8d3">PubSubMMOG::numMoveMessages</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00127">127</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="aed031b28dd4fd6b2db5f68247ff742d7"></a><!-- doxytag: member="PubSubMMOG::numPubSubSignalingMessages" ref="aed031b28dd4fd6b2db5f68247ff742d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#aed031b28dd4fd6b2db5f68247ff742d7">PubSubMMOG::numPubSubSignalingMessages</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00125">125</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4051d53d8d09521b830246ca19b0004b"></a><!-- doxytag: member="PubSubMMOG::numSubspaces" ref="a4051d53d8d09521b830246ca19b0004b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a4051d53d8d09521b830246ca19b0004b">PubSubMMOG::numSubspaces</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00107">107</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a98fd6baf72474a184c902133581273fa"></a><!-- doxytag: member="PubSubMMOG::parentTimeout" ref="a98fd6baf72474a184c902133581273fa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a98fd6baf72474a184c902133581273fa">PubSubMMOG::parentTimeout</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00108">108</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a16f1ec7076f68484acd789057428a3cc"></a><!-- doxytag: member="PubSubMMOG::pubSubSignalingMessagesSize" ref="a16f1ec7076f68484acd789057428a3cc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a16f1ec7076f68484acd789057428a3cc">PubSubMMOG::pubSubSignalingMessagesSize</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00126">126</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8415fe6a47b3b961fd54f9e3b5f8d3f0"></a><!-- doxytag: member="PubSubMMOG::receivedMovementLists" ref="a8415fe6a47b3b961fd54f9e3b5f8d3f0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a8415fe6a47b3b961fd54f9e3b5f8d3f0">PubSubMMOG::receivedMovementLists</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00133">133</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4561eb4e380c7aea874ea622b9145603"></a><!-- doxytag: member="PubSubMMOG::respMoveListMessagesSize" ref="a4561eb4e380c7aea874ea622b9145603" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a4561eb4e380c7aea874ea622b9145603">PubSubMMOG::respMoveListMessagesSize</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00131">131</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4b4d32adfbffbd585d8a174d47b24db9"></a><!-- doxytag: member="PubSubMMOG::responsibleSubspaces" ref="a4b4d32adfbffbd585d8a174d47b24db9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classPubSubSubspaceId.html">PubSubSubspaceId</a>, <a class="el" href="classPubSubSubspaceResponsible.html">PubSubSubspaceResponsible</a>&gt; <a class="el" href="classPubSubMMOG.html#a4b4d32adfbffbd585d8a174d47b24db9">PubSubMMOG::responsibleSubspaces</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00100">100</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0535f1d205515626aaa20d25f8da3cda"></a><!-- doxytag: member="PubSubMMOG::subscribedSubspaces" ref="a0535f1d205515626aaa20d25f8da3cda" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt;<a class="el" href="classPubSubSubspace.html">PubSubSubspace</a>&gt; <a class="el" href="classPubSubMMOG.html#a0535f1d205515626aaa20d25f8da3cda">PubSubMMOG::subscribedSubspaces</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00099">99</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<a class="anchor" id="a45ee110f2b164e1902266585eaa1fb2c"></a><!-- doxytag: member="PubSubMMOG::subspaceSize" ref="a45ee110f2b164e1902266585eaa1fb2c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPubSubMMOG.html#a45ee110f2b164e1902266585eaa1fb2c">PubSubMMOG::subspaceSize</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="PubSubMMOG_8h_source.html#l00104">104</a> of file <a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="PubSubMMOG_8h_source.html">PubSubMMOG.h</a></li>
<li><a class="el" href="PubSubMMOG_8cc_source.html">PubSubMMOG.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="classPubSubMMOG.html">PubSubMMOG</a>      </li>

    <li class="footer">Generated on Thu Mar 6 2014 14:06:58 for OverSim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
