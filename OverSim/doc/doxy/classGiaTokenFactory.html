<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OverSim: GiaTokenFactory Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OverSim
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classGiaTokenFactory.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">GiaTokenFactory Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="GiaTokenFactory" -->
<p>This class handles the token allocation.  
 <a href="classGiaTokenFactory.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>&gt;</code></p>

<p><a href="classGiaTokenFactory-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory_1_1tokenCompareGiaNode.html">tokenCompareGiaNode</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#ab6533d1fbd2cdafdca832433dbcfc598">numInitStages</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets init stage.  <a href="#ab6533d1fbd2cdafdca832433dbcfc598"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#ac59c0b334e21fc7e778d01bc8f56c083">initialize</a> (int stage)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes this class and set some WATCH(variable) for OMNeT++.  <a href="#ac59c0b334e21fc7e778d01bc8f56c083"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a0f1ee462134cd1be34ed60b0c0ed77c7">handleMessages</a> (cMessage *msg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This module doesn't handle OMNeT++ messages.  <a href="#a0f1ee462134cd1be34ed60b0c0ed77c7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a87645f319c2af09c674c3ca2606794ff">setNeighbors</a> (<a class="el" href="classGiaNeighbors.html">GiaNeighbors</a> *<a class="el" href="classGiaTokenFactory.html#a504d20663cfbe685a8747047a5cef2b7">neighbors</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set neighbors.  <a href="#a87645f319c2af09c674c3ca2606794ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#aac4b3e60794e454e1b3e3a8103aefcba">setMaxHopCount</a> (uint32_t <a class="el" href="classGiaTokenFactory.html#a686ce1242cbc2e49d11b188b7d190a47">maxHopCount</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum hop count.  <a href="#aac4b3e60794e454e1b3e3a8103aefcba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#af739a228698812535386a8c8240ab57a">grantToken</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a token to a <a class="el" href="classGiaNode.html" title="This class represents a node in gia overlay network.">GiaNode</a>.  <a href="#af739a228698812535386a8c8240ab57a"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::priority_queue<br class="typebreak"/>
&lt; <a class="el" href="structFullGiaNodeInfo.html">FullGiaNodeInfo</a>, std::vector<br class="typebreak"/>
&lt; <a class="el" href="structFullGiaNodeInfo.html">FullGiaNodeInfo</a> &gt;<br class="typebreak"/>
, <a class="el" href="classGiaTokenFactory_1_1tokenCompareGiaNode.html">tokenCompareGiaNode</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a1778fb623c63ff065b8c642edceb45ac">TokenQueue</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#ac44cb31076f47f3f8890b75f1238faab">createPriorityQueue</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates priority queue.  <a href="#ac44cb31076f47f3f8890b75f1238faab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a08d8a2241e5175929d43a1fe7d58d492">clearTokenQueue</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears tokenQueue.  <a href="#a08d8a2241e5175929d43a1fe7d58d492"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a1b16071840523141b10e541bfd1f93cd">updateQueueVector</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Update TokenQueue-Vector (for OMNeT++ WATCH)  <a href="#a1b16071840523141b10e541bfd1f93cd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a705f719c36d8917132fa2d6c03ed503a">updateSentTokens</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Increase sentTokens at neighbor-node which is on top of priority queue.  <a href="#a705f719c36d8917132fa2d6c03ed503a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#ad50915d7f95078b204a8feba37bf4dc6">sendToken</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends token to node on top of priority queue.  <a href="#ad50915d7f95078b204a8feba37bf4dc6"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGia.html">Gia</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a743c066ad61d01acabe62ec53a82b7fd">gia</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGiaTokenFactory.html#a1778fb623c63ff065b8c642edceb45ac">TokenQueue</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d">tokenQueue</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">prioriry queue of all current neighbors  <a href="#a0a893b31f842a0ea7cd91259f6535e4d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGiaNeighbors.html">GiaNeighbors</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a504d20663cfbe685a8747047a5cef2b7">neighbors</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to our current neighbors  <a href="#a504d20663cfbe685a8747047a5cef2b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classGiaNode.html">GiaNode</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a0c3b945827785c3bd221a8189551f184">tokenQueueVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#a686ce1242cbc2e49d11b188b7d190a47">maxHopCount</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">a vector of the priority queue (to visualize current priority state)  <a href="#a686ce1242cbc2e49d11b188b7d190a47"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGiaTokenFactory.html#abf7c30c8cc655e2026fbbd24cc7da5be">stat_sentTokens</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">number of sent tokens  <a href="#abf7c30c8cc655e2026fbbd24cc7da5be"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This class handles the token allocation. </p>
<p>It grants the next token to the node which has fewest tokens. If some nodes have the same amount of granted tokens, the node with the highest capacity will obtain the token. </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00045">45</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>
</div><hr/><h2>Member Typedef Documentation</h2>
<a class="anchor" id="a1778fb623c63ff065b8c642edceb45ac"></a><!-- doxytag: member="GiaTokenFactory::TokenQueue" ref="a1778fb623c63ff065b8c642edceb45ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::priority_queue&lt;<a class="el" href="structFullGiaNodeInfo.html">FullGiaNodeInfo</a>, std::vector&lt;<a class="el" href="structFullGiaNodeInfo.html">FullGiaNodeInfo</a>&gt;, <a class="el" href="classGiaTokenFactory_1_1tokenCompareGiaNode.html">tokenCompareGiaNode</a>&gt; <a class="el" href="classGiaTokenFactory.html#a1778fb623c63ff065b8c642edceb45ac">GiaTokenFactory::TokenQueue</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00098">98</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a08d8a2241e5175929d43a1fe7d58d492"></a><!-- doxytag: member="GiaTokenFactory::clearTokenQueue" ref="a08d8a2241e5175929d43a1fe7d58d492" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::clearTokenQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clears tokenQueue. </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00097">97</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00083">createPriorityQueue()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">while</span>( !<a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.empty() )
        <a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.pop();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac44cb31076f47f3f8890b75f1238faab"></a><!-- doxytag: member="GiaTokenFactory::createPriorityQueue" ref="ac44cb31076f47f3f8890b75f1238faab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::createPriorityQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates priority queue. </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00083">83</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00062">grantToken()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classGiaTokenFactory.html#a08d8a2241e5175929d43a1fe7d58d492" title="Clears tokenQueue.">clearTokenQueue</a>();
    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code" href="classGiaTokenFactory.html#a504d20663cfbe685a8747047a5cef2b7" title="pointer to our current neighbors">neighbors</a>-&gt;<a class="code" href="classGiaNeighbors.html#a6c49fd1378ad958ffbf7a875c31441ba">getSize</a>(); i++ ) {
        <a class="code" href="structFullGiaNodeInfo.html">FullGiaNodeInfo</a> temp;
        temp.<a class="code" href="structFullGiaNodeInfo.html#aecd7f9fe09c1b41ee423da7c2a7457c1">node</a>= <a class="code" href="classGiaTokenFactory.html#a504d20663cfbe685a8747047a5cef2b7" title="pointer to our current neighbors">neighbors</a>-&gt;<a class="code" href="classGiaNeighbors.html#a471c71a864b492b71739a7a4809f7f4a" title="Get neighbor at position.">get</a>(i);
        temp.<a class="code" href="structFullGiaNodeInfo.html#aa3be8ff94a4e06570dbc082c0af35a53">info</a> = <a class="code" href="classGiaTokenFactory.html#a504d20663cfbe685a8747047a5cef2b7" title="pointer to our current neighbors">neighbors</a>-&gt;<a class="code" href="classGiaNeighbors.html#a471c71a864b492b71739a7a4809f7f4a" title="Get neighbor at position.">get</a>(temp.<a class="code" href="structFullGiaNodeInfo.html#aecd7f9fe09c1b41ee423da7c2a7457c1">node</a>);
        <span class="comment">//temp.setCapacity(tempInfo-&gt;capacity);</span>
        <span class="comment">//temp.setSentTokens(tempInfo-&gt;sentTokens);</span>

        <a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.push(temp);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="af739a228698812535386a8c8240ab57a"></a><!-- doxytag: member="GiaTokenFactory::grantToken" ref="af739a228698812535386a8c8240ab57a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::grantToken </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends a token to a <a class="el" href="classGiaNode.html" title="This class represents a node in gia overlay network.">GiaNode</a>. </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00062">62</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>

<p>Referenced by <a class="el" href="Gia_8cc_source.html#l00872">Gia::forwardMessage()</a>, <a class="el" href="Gia_8cc_source.html#l00261">Gia::handleTimerEvent()</a>, and <a class="el" href="Gia_8cc_source.html#l01147">Gia::processSearchMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classGiaTokenFactory.html#a504d20663cfbe685a8747047a5cef2b7" title="pointer to our current neighbors">neighbors</a>-&gt;<a class="code" href="classGiaNeighbors.html#a6c49fd1378ad958ffbf7a875c31441ba">getSize</a>() == 0) <span class="keywordflow">return</span>;

    <span class="comment">// create priority queue</span>
    <a class="code" href="classGiaTokenFactory.html#ac44cb31076f47f3f8890b75f1238faab" title="Creates priority queue.">createPriorityQueue</a>();

    <span class="comment">// update sentTokenCount at node on top of priority queue</span>
    <a class="code" href="classGiaTokenFactory.html#a705f719c36d8917132fa2d6c03ed503a" title="Increase sentTokens at neighbor-node which is on top of priority queue.">updateSentTokens</a>();

    <span class="comment">// send token to top of queue</span>
    assert( <a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.size() );
    assert( !<a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.top().node.isUnspecified() );
    <a class="code" href="classGiaTokenFactory.html#a743c066ad61d01acabe62ec53a82b7fd">gia</a>-&gt;<a class="code" href="classGia.html#a2a3eb81ee841e9d81161b71664d2fcdf">sendToken</a>(<a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.top().node);

    <span class="comment">// increse statistic variable</span>
    <a class="code" href="classGiaTokenFactory.html#abf7c30c8cc655e2026fbbd24cc7da5be" title="number of sent tokens">stat_sentTokens</a>++;

    <a class="code" href="classGiaTokenFactory.html#a1b16071840523141b10e541bfd1f93cd" title="Update TokenQueue-Vector (for OMNeT++ WATCH)">updateQueueVector</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0f1ee462134cd1be34ed60b0c0ed77c7"></a><!-- doxytag: member="GiaTokenFactory::handleMessages" ref="a0f1ee462134cd1be34ed60b0c0ed77c7" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::handleMessages </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This module doesn't handle OMNeT++ messages. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>OMNeT++ message </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00047">47</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="yang_8cc.html#adb989392f8aada21b0f7ec2f7a41dc00">error</a>(<span class="stringliteral">&quot;this module doesn&#39;t handle messages, it runs only in initialize()&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac59c0b334e21fc7e778d01bc8f56c083"></a><!-- doxytag: member="GiaTokenFactory::initialize" ref="ac59c0b334e21fc7e778d01bc8f56c083" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::initialize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes this class and set some WATCH(variable) for OMNeT++. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">stage</td><td>Level of initialization (OMNeT++) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00033">33</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// wait until IPAddressResolver finished his initialization</span>
    <span class="keywordflow">if</span>(stage != <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532a58e83c497c7c8495e9c592ff3148b6b9" title="first stage for overlay modules (Tier 0 / KBR)">MIN_STAGE_OVERLAY</a>)
        <span class="keywordflow">return</span>;

    <a class="code" href="classGiaTokenFactory.html#a743c066ad61d01acabe62ec53a82b7fd">gia</a> = check_and_cast&lt;<a class="code" href="classGia.html" title="Gia overlay module.">Gia</a>*&gt;(getParentModule()-&gt;getSubmodule(<span class="stringliteral">&quot;gia&quot;</span>));

    <a class="code" href="classGiaTokenFactory.html#abf7c30c8cc655e2026fbbd24cc7da5be" title="number of sent tokens">stat_sentTokens</a> = 0;

    WATCH(stat_sentTokens);
    WATCH_VECTOR(<a class="code" href="classGiaTokenFactory.html#a0c3b945827785c3bd221a8189551f184">tokenQueueVector</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab6533d1fbd2cdafdca832433dbcfc598"></a><!-- doxytag: member="GiaTokenFactory::numInitStages" ref="ab6533d1fbd2cdafdca832433dbcfc598" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual int GiaTokenFactory::numInitStages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets init stage. </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00052">52</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">return</span> <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532af261a91f9b71ec40c7c7c7e18b3455ac" title="last stage for overlay modules (Tier 0 / KBR)">MAX_STAGE_OVERLAY</a> + 1;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ad50915d7f95078b204a8feba37bf4dc6"></a><!-- doxytag: member="GiaTokenFactory::sendToken" ref="ad50915d7f95078b204a8feba37bf4dc6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::sendToken </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends token to node on top of priority queue. </p>

</div>
</div>
<a class="anchor" id="aac4b3e60794e454e1b3e3a8103aefcba"></a><!-- doxytag: member="GiaTokenFactory::setMaxHopCount" ref="aac4b3e60794e454e1b3e3a8103aefcba" args="(uint32_t maxHopCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::setMaxHopCount </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>maxHopCount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set maximum hop count. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">maxHopCount</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00057">57</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>

<p>Referenced by <a class="el" href="Gia_8cc_source.html#l00124">Gia::changeState()</a>.</p>
<div class="fragment"><pre class="fragment">{
    this-&gt;<a class="code" href="classGiaTokenFactory.html#a686ce1242cbc2e49d11b188b7d190a47" title="a vector of the priority queue (to visualize current priority state)">maxHopCount</a> = <a class="code" href="classGiaTokenFactory.html#a686ce1242cbc2e49d11b188b7d190a47" title="a vector of the priority queue (to visualize current priority state)">maxHopCount</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a87645f319c2af09c674c3ca2606794ff"></a><!-- doxytag: member="GiaTokenFactory::setNeighbors" ref="a87645f319c2af09c674c3ca2606794ff" args="(GiaNeighbors *neighbors)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::setNeighbors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGiaNeighbors.html">GiaNeighbors</a> *&#160;</td>
          <td class="paramname"><em>neighbors</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set neighbors. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">neighbors</td><td>pointer to our neighborlist </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00052">52</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>

<p>Referenced by <a class="el" href="Gia_8cc_source.html#l00124">Gia::changeState()</a>.</p>
<div class="fragment"><pre class="fragment">{
    neighbors = nghbors;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1b16071840523141b10e541bfd1f93cd"></a><!-- doxytag: member="GiaTokenFactory::updateQueueVector" ref="a1b16071840523141b10e541bfd1f93cd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::updateQueueVector </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update TokenQueue-Vector (for OMNeT++ WATCH) </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00103">103</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00062">grantToken()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// fill tokenQueueVector</span>
    <a class="code" href="classGiaTokenFactory.html#a0c3b945827785c3bd221a8189551f184">tokenQueueVector</a>.clear();
    <span class="keywordflow">while</span> (!<a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.empty()) {
        <a class="code" href="classGiaTokenFactory.html#a0c3b945827785c3bd221a8189551f184">tokenQueueVector</a>.push_back(<a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.top().node);
        <a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.pop();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a705f719c36d8917132fa2d6c03ed503a"></a><!-- doxytag: member="GiaTokenFactory::updateSentTokens" ref="a705f719c36d8917132fa2d6c03ed503a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GiaTokenFactory::updateSentTokens </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Increase sentTokens at neighbor-node which is on top of priority queue. </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8cc_source.html#l00113">113</a> of file <a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00062">grantToken()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.empty()) <span class="keywordflow">return</span>;

    <a class="code" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d" title="prioriry queue of all current neighbors">tokenQueue</a>.top().info-&gt;sentTokens++;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a743c066ad61d01acabe62ec53a82b7fd"></a><!-- doxytag: member="GiaTokenFactory::gia" ref="a743c066ad61d01acabe62ec53a82b7fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGia.html">Gia</a>* <a class="el" href="classGiaTokenFactory.html#a743c066ad61d01acabe62ec53a82b7fd">GiaTokenFactory::gia</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00089">89</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00062">grantToken()</a>, and <a class="el" href="GiaTokenFactory_8cc_source.html#l00033">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a686ce1242cbc2e49d11b188b7d190a47"></a><!-- doxytag: member="GiaTokenFactory::maxHopCount" ref="a686ce1242cbc2e49d11b188b7d190a47" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classGiaTokenFactory.html#a686ce1242cbc2e49d11b188b7d190a47">GiaTokenFactory::maxHopCount</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>a vector of the priority queue (to visualize current priority state) </p>
<p>maximum hop count </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00102">102</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00057">setMaxHopCount()</a>.</p>

</div>
</div>
<a class="anchor" id="a504d20663cfbe685a8747047a5cef2b7"></a><!-- doxytag: member="GiaTokenFactory::neighbors" ref="a504d20663cfbe685a8747047a5cef2b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGiaNeighbors.html">GiaNeighbors</a>* <a class="el" href="classGiaTokenFactory.html#a504d20663cfbe685a8747047a5cef2b7">GiaTokenFactory::neighbors</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>pointer to our current neighbors </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00100">100</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00083">createPriorityQueue()</a>, <a class="el" href="GiaTokenFactory_8cc_source.html#l00062">grantToken()</a>, and <a class="el" href="GiaTokenFactory_8cc_source.html#l00052">setNeighbors()</a>.</p>

</div>
</div>
<a class="anchor" id="abf7c30c8cc655e2026fbbd24cc7da5be"></a><!-- doxytag: member="GiaTokenFactory::stat_sentTokens" ref="abf7c30c8cc655e2026fbbd24cc7da5be" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classGiaTokenFactory.html#abf7c30c8cc655e2026fbbd24cc7da5be">GiaTokenFactory::stat_sentTokens</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>number of sent tokens </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00105">105</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00062">grantToken()</a>, and <a class="el" href="GiaTokenFactory_8cc_source.html#l00033">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a0a893b31f842a0ea7cd91259f6535e4d"></a><!-- doxytag: member="GiaTokenFactory::tokenQueue" ref="a0a893b31f842a0ea7cd91259f6535e4d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGiaTokenFactory.html#a1778fb623c63ff065b8c642edceb45ac">TokenQueue</a> <a class="el" href="classGiaTokenFactory.html#a0a893b31f842a0ea7cd91259f6535e4d">GiaTokenFactory::tokenQueue</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>prioriry queue of all current neighbors </p>

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00099">99</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00097">clearTokenQueue()</a>, <a class="el" href="GiaTokenFactory_8cc_source.html#l00083">createPriorityQueue()</a>, <a class="el" href="GiaTokenFactory_8cc_source.html#l00062">grantToken()</a>, <a class="el" href="GiaTokenFactory_8cc_source.html#l00103">updateQueueVector()</a>, and <a class="el" href="GiaTokenFactory_8cc_source.html#l00113">updateSentTokens()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c3b945827785c3bd221a8189551f184"></a><!-- doxytag: member="GiaTokenFactory::tokenQueueVector" ref="a0c3b945827785c3bd221a8189551f184" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classGiaNode.html">GiaNode</a>&gt; <a class="el" href="classGiaTokenFactory.html#a0c3b945827785c3bd221a8189551f184">GiaTokenFactory::tokenQueueVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="GiaTokenFactory_8h_source.html#l00101">101</a> of file <a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a>.</p>

<p>Referenced by <a class="el" href="GiaTokenFactory_8cc_source.html#l00033">initialize()</a>, and <a class="el" href="GiaTokenFactory_8cc_source.html#l00103">updateQueueVector()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="GiaTokenFactory_8h_source.html">GiaTokenFactory.h</a></li>
<li><a class="el" href="GiaTokenFactory_8cc_source.html">GiaTokenFactory.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="classGiaTokenFactory.html">GiaTokenFactory</a>      </li>

    <li class="footer">Generated on Thu Mar 6 2014 14:06:48 for OverSim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
