<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OverSim: NeighborCache Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OverSim
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classNeighborCache.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">NeighborCache Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="NeighborCache" --><!-- doxytag: inherits="BaseApp" -->
<p><code>#include &lt;<a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for NeighborCache:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classNeighborCache.png" usemap="#NeighborCache_map" alt=""/>
  <map id="NeighborCache_map" name="NeighborCache_map">
<area href="classBaseApp.html" title="Base class for applications." alt="BaseApp" shape="rect" coords="57,112,162,136"/>
<area href="classBaseRpc.html" title="Base class for RPCs." alt="BaseRpc" shape="rect" coords="0,56,105,80"/>
<area href="classBaseTcpSupport.html" alt="BaseTcpSupport" shape="rect" coords="115,56,220,80"/>
<area href="classRpcListener.html" title="A Remote-Procedure-Call listener class." alt="RpcListener" shape="rect" coords="0,0,105,24"/>
</map>
 </div></div>

<p><a href="classNeighborCache-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structNeighborCache_1_1WaitingContext.html">WaitingContext</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#adbaa89b2beef3d6b0cf307bd3948efc5">~NeighborCache</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a2ce120e786b37cb5823d53f31ae82ff3">isEnabled</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a807c7e77f42e52bf22d1340e207125a6">getBootstrapNode</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#abfd044fbe032dede0011d4a7925c3949">piggybackOwnCoords</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classAbstractNcs.html">AbstractNcs</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#affdf04759fd1df8315954b8789d91eab">getNcsAccess</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a54e923d5f3f6ca83696e23cc466f8e09">getOverlayThisNode</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a23203e2d09c77efbba57a85212f2f9df">getNeighborCacheSize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a416f18a5fea738589845fd630d6cf071">isEntry</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">simtime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a8a19fa241b9d8eda9092a93a4a41b9bb">getNodeAge</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;handle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a393f2dab8d25fcc23ad3c53cf9228080">getNodeHandle</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;add)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">simtime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a23056db53fc60a2eaedf425b7370146e">getNodeTimeout</a> (const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;node)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Caclulation of reasonable timout value.  <a href="#a23056db53fc60a2eaedf425b7370146e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTransportAddress.html">TransportAddress</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a2172131cd1f7e5958ad3e8c359ca3109">getNearestNode</a> (uint8_t maxLayer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a850073aebd8d46ba5432ed79a62885c5">getAvgAbsPredictionError</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a07cb82893b7483ca7f247bad059b5a3e">getClosestNodes</a> (uint8_t number)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a125eb149eacf6814a06adbb5937bca19">getSpreadedNodes</a> (uint8_t number)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a057e94a37705dfab0ab1f91417603450">updateNode</a> (const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;add, simtime_t rtt, const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;srcRoute=<a class="el" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6">NodeHandle::UNSPECIFIED_NODE</a>, <a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> *ncsInfo=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a8b5247ae66c36e40addd51db3aa33a3c">updateNcsInfo</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node, <a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> *ncsInfo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a93099fadb692a42cbe4c0757f28cf0c3">setNodeTimeout</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;handle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structProx.html">Prox</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ab934be8fb503f9629cf6eb83e7d1b576">getProx</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node, <a class="el" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccb">NeighborCacheQueryType</a> type=NEIGHBORCACHE_AVAILABLE, int rpcId=-1, <a class="el" href="classProxListener.html">ProxListener</a> *listener=NULL, cPolymorphic *contextPointer=NULL)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the proximity of a node.  <a href="#ab934be8fb503f9629cf6eb83e7d1b576"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structProx.html">Prox</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a1d0b6dc71b5933f46f888100c8aaf70a">estimateProx</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates a <a class="el" href="structProx.html">Prox</a> value of node, in relation to this node, based on information collected by the overlay.  <a href="#a1d0b6dc71b5933f46f888100c8aaf70a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a5bfc95cec29a0c320e3586629fb85504">getNodeCoordsInfo</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the coordinate information of a node.  <a href="#a5bfc95cec29a0c320e3586629fb85504"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTreeManagement.html">TreeManagement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a8317329015f5923320d94ae628401de2">getTreeManager</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a pointer to the treeManager Module.  <a href="#a8317329015f5923320d94ae628401de2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::pair&lt; simtime_t, simtime_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#af02289b6b99c9b1e7c902175ef76d175">getMeanVarRtt</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node, bool returnVar)</td></tr>
<tr><td colspan="2"><h2><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef UNORDERED_MAP<br class="typebreak"/>
&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a>, <br class="typebreak"/>
<a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a> &gt;::iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aed1572b2a597a0654f4d355760aa5942">NeighborCacheIterator</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef UNORDERED_MAP<br class="typebreak"/>
&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a>, <br class="typebreak"/>
<a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a> &gt;<br class="typebreak"/>
::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a81f00b07e9a47f134156759e5b878443">NeighborCacheConstIterator</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::multimap<br class="typebreak"/>
&lt; simtime_t, <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt;<br class="typebreak"/>
::iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a7f7da64944cfeee91fcecb1d5fb23dd9">neighborCacheExpireMapIterator</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a9d114395eec6daa793b36bca06e24a22">initializeApp</a> (int stage)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes derived class-attributes  <a href="#a9d114395eec6daa793b36bca06e24a22"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aaad39bfe85c0214910e38f774d53ab1a">finishApp</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">collects statistical data of derived app  <a href="#aaad39bfe85c0214910e38f774d53ab1a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="CommonMessages__m_8h.html#aad57ef0110fe8675eb299d467148bc5e">CompType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aa6aafdbff910a02b3dc631a57f2b3ac4">getThisCompType</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the component type of this module.  <a href="#aa6aafdbff910a02b3dc631a57f2b3ac4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a54e488bca853c3d1b4ea1480fefc81e8">handleTimerEvent</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aab267d208202e7bf8dc1c7aecc66b550">queryProx</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node, int rpcId, <a class="el" href="classProxListener.html">ProxListener</a> *listener, cPolymorphic *contextPointer)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a pingNode call based on parameters from a getProx call.  <a href="#aab267d208202e7bf8dc1c7aecc66b550"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a0b7a352cb7d5eb83c9a04b1e0f52a5d0">handleRpcCall</a> (<a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *msg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Coord / RTT measuring rpc stuff goes here.  <a href="#a0b7a352cb7d5eb83c9a04b1e0f52a5d0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a4981e919440eb9decd3c8f75cb3d68ac">handleReadyMessage</a> (<a class="el" href="classCompReadyMessage.html">CompReadyMessage</a> *msg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">handle ready message - build tree topology  <a href="#a4981e919440eb9decd3c8f75cb3d68ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">simtime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a1ba760d3b98f17dd3951ba64ec54e30f">getRttBasedTimeout</a> (const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;node)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">simtime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aa6f7beabed784d0269bfde141217557c">getNcsBasedTimeout</a> (const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;node)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a4f8b972def963e1508ec598fb5f87644">callbackDiscoveryFinished</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;nearNode)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGlobalStatistics.html">GlobalStatistics</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad">globalStatistics</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to <a class="el" href="classGlobalStatistics.html" title="Module to record global statistics.">GlobalStatistics</a> module in this node  <a href="#a0ffa19a84d406ad8de4b86148a5879ad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">UNORDERED_MAP<br class="typebreak"/>
&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a>, <br class="typebreak"/>
<a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d">neighborCache</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to the neighbor cache  <a href="#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::multimap&lt; simtime_t, <br class="typebreak"/>
<a class="el" href="classTransportAddress.html">TransportAddress</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NodeVector_8h.html#a4dd14fd4e10a709d35fafe4967a28a68">ProxAddressVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99">NeighborCacheRttState</a> { <a class="el" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a>, 
<a class="el" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>, 
<a class="el" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">RTTSTATE_TIMEOUT</a>, 
<a class="el" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::vector<br class="typebreak"/>
&lt; <a class="el" href="structNeighborCache_1_1WaitingContext.html">WaitingContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aa690fa08dd5460980e15bae581ef04d4">WaitingContexts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::pair&lt; simtime_t, <br class="typebreak"/>
<a class="el" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99">NeighborCacheRttState</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ad6b6e27419b9657874d3517f2cc62dcf">Rtt</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#acd2bd11282ed8d69d6291946a184b127">cleanupCache</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a77a2ecd09d989f19bc2c0cf7e9f0e5b8">updateEntry</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;address, simtime_t insertTime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structProx.html">Prox</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ad9e7edece1f862fc607302542a62879b">getCoordinateBasedProx</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ac08424d2bc22ec75e91b2da484d3075d">recordNcsEstimationError</a> (const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;handle, simtime_t rtt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a414a936f37e71490de6af0eda317fa83">insertNodeContext</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;handle, cPolymorphic *context, <a class="el" href="classProxListener.html">ProxListener</a> *rpcListener, int rpcId)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNeighborCache.html#aa690fa08dd5460980e15bae581ef04d4">NeighborCache::WaitingContexts</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a2dae7f2c34de3d5ce4e9032f0b00c07b">getNodeContexts</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;handle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNeighborCache.html#ad6b6e27419b9657874d3517f2cc62dcf">Rtt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ab94f734ab0667605962f2bb4f315e9f1">getNodeRtt</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;add)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ab3c80224821887880caf9192c4d83a8e">pingResponse</a> (<a class="el" href="classPingResponse.html">PingResponse</a> *response, cPolymorphic *context, int rpcId, simtime_t rtt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aef4fca6b3c22482d4424f83d7656ddc1">pingTimeout</a> (<a class="el" href="classPingCall.html">PingCall</a> *call, const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;dest, cPolymorphic *context, int rpcId)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a0df75e09a10623f6ad9e45ee05f20938">prepareOverlay</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ab3b6bdb65927ffa2d71496c0351c54f2">setCbrNodeId</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a14ea96324f1a0c102dee609d89cff72a">enableNeighborCache</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aeff6d75027528c27a7424fafc0fd5ae0">collectClosestNodes</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">simtime_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ab3ba13a3310b16ef691ee52eac897c72">rttExpirationTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aacdd8a0ee2a9e893e21caf58cceb8576">maxSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a4dab83c82964a5be2da87477aeb7f6f1">discoveryFinished</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a54211a9fd7c6562ff15323e5b9863814">misses</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a39da5066d1b99988174cc8546564600b">hits</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAbstractNcs.html">AbstractNcs</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTreeManagement.html">TreeManagement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGlobalViewBuilder.html">GlobalViewBuilder</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a3597f3dbce17346140258f34d17b4209">capReqFinished</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a9921c0eaa97c6836b731327abe0f0829">ncsPiggybackOwnCoords</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a35eddfa8e8b64ba9cdbe138f8067d07f">useNcsForTimeout</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStdProxComparator.html">StdProxComparator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ac8feda3e317250804eeb41b727b4456c">proxComparator</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDiscoveryMode.html">DiscoveryMode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCoordBasedRouting.html">CoordBasedRouting</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccb">NeighborCacheQueryType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a11a4145a2f976de746ffb5eb80b8720e">defaultQueryType</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccb">NeighborCacheQueryType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a88e4d57df1eece811a04c75c2eb61c00">defaultQueryTypeI</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccb">NeighborCacheQueryType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a8a01390ead6fc76dcc7d76e5e2253481">defaultQueryTypeQ</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a850be66fd299373b7843c92378b4d54a">landmarkTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a0a24e2ba7ad8f0328e4b4b829eae9e63">cbrTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a>, <br class="typebreak"/>
std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ad25610d40940fb6395a623bcb3b4a612">lastAbsoluteErrorPerNode</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a22a9c8f9d8054711dd9b4c972940fdcd">numMsg</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a3a41df8495c9a6b70fc715e308a8ea2d">absoluteError</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a2a635befdb541a1d491b23fe52616370">relativeError</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a5de22621c8d7fa8bbe85e49d3b6b8927">numRttErrorToHigh</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a86b66679e384f12f73bd4dbcc770f8e6">numRttErrorToLow</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a825fc8881da994d38c7574ecfc110f4d">rttHistory</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a05ae665acfd7d6504d624d69a95428ef">timeoutAccuracyLimit</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a306e1f0b6cdea15e32762ce421d1734a">coordsDummy</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#abf8f22a91e7e5bb6095df851e586858f">RTT_TIMEOUT_ADJUSTMENT</a> = 1.3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ab645ed14a47c403b86243192fcbfa27c">NCS_TIMEOUT_CONSTANT</a> = 0.350</td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a936e38853be592103df5f12cd5d5924a">Nps</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aede157b6cef68cd553f881605bae6687">SimpleUnderlayNCS</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#aa4eb45f96f21fd5aa25a058b3477139e">TreeManagement</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a3a28c1eff4d9ebfab15f049d8b665ecd">GlobalViewBuilder</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#a44f490d79205f6b037374da5cd72ba9a">DiscoveryMode</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNeighborCache.html#ac08e4d48d12d21383076ed55ae3959a3">operator&lt;&lt;</a> (std::ostream &amp;os, const <a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a> &amp;entry)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00078">78</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>
</div><hr/><h2>Member Typedef Documentation</h2>
<a class="anchor" id="a81f00b07e9a47f134156759e5b878443"></a><!-- doxytag: member="NeighborCache::NeighborCacheConstIterator" ref="a81f00b07e9a47f134156759e5b878443" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef UNORDERED_MAP&lt;<a class="el" href="classTransportAddress.html">TransportAddress</a>, <a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a>&gt;::const_iterator <a class="el" href="classNeighborCache.html#a81f00b07e9a47f134156759e5b878443">NeighborCache::NeighborCacheConstIterator</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00214">214</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7f7da64944cfeee91fcecb1d5fb23dd9"></a><!-- doxytag: member="NeighborCache::neighborCacheExpireMapIterator" ref="a7f7da64944cfeee91fcecb1d5fb23dd9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::multimap&lt;simtime_t, <a class="el" href="classTransportAddress.html">TransportAddress</a>&gt;::iterator <a class="el" href="classNeighborCache.html#a7f7da64944cfeee91fcecb1d5fb23dd9">NeighborCache::neighborCacheExpireMapIterator</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00217">217</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

</div>
</div>
<a class="anchor" id="aed1572b2a597a0654f4d355760aa5942"></a><!-- doxytag: member="NeighborCache::NeighborCacheIterator" ref="aed1572b2a597a0654f4d355760aa5942" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef UNORDERED_MAP&lt;<a class="el" href="classTransportAddress.html">TransportAddress</a>, <a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a>&gt;::iterator <a class="el" href="classNeighborCache.html#aed1572b2a597a0654f4d355760aa5942">NeighborCache::NeighborCacheIterator</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00213">213</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad6b6e27419b9657874d3517f2cc62dcf"></a><!-- doxytag: member="NeighborCache::Rtt" ref="ad6b6e27419b9657874d3517f2cc62dcf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::pair&lt;simtime_t, <a class="el" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99">NeighborCacheRttState</a>&gt; <a class="el" href="classNeighborCache.html#ad6b6e27419b9657874d3517f2cc62dcf">NeighborCache::Rtt</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00169">169</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa690fa08dd5460980e15bae581ef04d4"></a><!-- doxytag: member="NeighborCache::WaitingContexts" ref="aa690fa08dd5460980e15bae581ef04d4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="structNeighborCache_1_1WaitingContext.html">WaitingContext</a>&gt; <a class="el" href="classNeighborCache.html#aa690fa08dd5460980e15bae581ef04d4">NeighborCache::WaitingContexts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00152">152</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

</div>
</div>
<hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="aefe728f567b9040c8c01c8bbf93d9c99"></a><!-- doxytag: member="NeighborCache::NeighborCacheRttState" ref="aefe728f567b9040c8c01c8bbf93d9c99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99">NeighborCache::NeighborCacheRttState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f"></a><!-- doxytag: member="RTTSTATE_VALID" ref="aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f" args="" -->RTTSTATE_VALID</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea"></a><!-- doxytag: member="RTTSTATE_UNKNOWN" ref="aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea" args="" -->RTTSTATE_UNKNOWN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c"></a><!-- doxytag: member="RTTSTATE_TIMEOUT" ref="aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c" args="" -->RTTSTATE_TIMEOUT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0"></a><!-- doxytag: member="RTTSTATE_WAITING" ref="aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0" args="" -->RTTSTATE_WAITING</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00162">162</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>
<div class="fragment"><pre class="fragment">                               {
        <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a>,
        <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>,
        <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">RTTSTATE_TIMEOUT</a>,
        <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>
    };
</pre></div>
</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="adbaa89b2beef3d6b0cf307bd3948efc5"></a><!-- doxytag: member="NeighborCache::~NeighborCache" ref="adbaa89b2beef3d6b0cf307bd3948efc5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NeighborCache::~NeighborCache </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00222">222</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">delete</span> <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>;
    <span class="keyword">delete</span> <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>;
    <span class="keyword">delete</span> <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>;
    <span class="keyword">delete</span> <a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a>;
    <span class="keyword">delete</span> <a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>;
    <span class="keyword">delete</span> <a class="code" href="classNeighborCache.html#ac8feda3e317250804eeb41b727b4456c">proxComparator</a>;
    cancelAndDelete(<a class="code" href="classNeighborCache.html#a0a24e2ba7ad8f0328e4b4b829eae9e63">cbrTimer</a>);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a4f8b972def963e1508ec598fb5f87644"></a><!-- doxytag: member="NeighborCache::callbackDiscoveryFinished" ref="a4f8b972def963e1508ec598fb5f87644" args="(const TransportAddress &amp;nearNode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::callbackDiscoveryFinished </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>nearNode</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="acd2bd11282ed8d69d6291946a184b127"></a><!-- doxytag: member="NeighborCache::cleanupCache" ref="acd2bd11282ed8d69d6291946a184b127" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool NeighborCache::cleanupCache </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00501">501</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00233">insertNodeContext()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00991">queryProx()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00289">setNodeTimeout()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00421">updateNcsInfo()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
    uint32_t size = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size();

    <span class="keywordflow">if</span> (size &gt; <a class="code" href="classNeighborCache.html#aacdd8a0ee2a9e893e21caf58cceb8576">maxSize</a>) {
        <a class="code" href="classNeighborCache.html#a7f7da64944cfeee91fcecb1d5fb23dd9">neighborCacheExpireMapIterator</a> it;
        <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; (size - (<a class="code" href="classNeighborCache.html#aacdd8a0ee2a9e893e21caf58cceb8576">maxSize</a> / 2)); ++i) {
            it = <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.begin();
            <span class="keywordflow">if</span> ((<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[it-&gt;second].rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>) ||
                    (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[it-&gt;second].insertTime == simTime())) {
                <span class="keywordflow">break</span>;
            }
            <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.erase(it-&gt;second);
            <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.erase(it);
            result = <span class="keyword">true</span>;
        }
    }
    assert(<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size() == <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.size());
    <span class="keywordflow">return</span> result;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1d0b6dc71b5933f46f888100c8aaf70a"></a><!-- doxytag: member="NeighborCache::estimateProx" ref="a1d0b6dc71b5933f46f888100c8aaf70a" args="(const TransportAddress &amp;node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structProx.html">Prox</a> NeighborCache::estimateProx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Estimates a <a class="el" href="structProx.html">Prox</a> value of node, in relation to this node, based on information collected by the overlay. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The node whose proximity will be requested. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The RTT value if one is found in the cache, or else a <a class="el" href="structProx.html">Prox</a> estimate. </dd></dl>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00976">976</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method(<span class="stringliteral">&quot;estimateProx()&quot;</span>);

    <a class="code" href="classNeighborCache.html#ad6b6e27419b9657874d3517f2cc62dcf">Rtt</a> rtt = <a class="code" href="classNeighborCache.html#ab94f734ab0667605962f2bb4f315e9f1">getNodeRtt</a>(node);

    <span class="keywordflow">if</span> (rtt.second != <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>) <span class="keywordflow">return</span> rtt.first;

    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> &amp;&amp; <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(node)) {
        <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#ad9e7edece1f862fc607302542a62879b">getCoordinateBasedProx</a>(node);
    }

    <span class="keywordflow">return</span> <a class="code" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aaad39bfe85c0214910e38f774d53ab1a"></a><!-- doxytag: member="NeighborCache::finishApp" ref="aaad39bfe85c0214910e38f774d53ab1a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::finishApp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>collects statistical data of derived app </p>

<p>Reimplemented from <a class="el" href="classBaseApp.html#a9702f80de642a3e090aaf5bedea8e4a6">BaseApp</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00194">194</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> ((<a class="code" href="classNeighborCache.html#a54211a9fd7c6562ff15323e5b9863814">misses</a> + <a class="code" href="classNeighborCache.html#a39da5066d1b99988174cc8546564600b">hits</a>) != 0) {
        <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>
        -&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;NeighborCache: Ping hit rate&quot;</span>,
                    ((<span class="keywordtype">double</span>)<a class="code" href="classNeighborCache.html#a39da5066d1b99988174cc8546564600b">hits</a> / (<span class="keywordtype">double</span>)(<a class="code" href="classNeighborCache.html#a54211a9fd7c6562ff15323e5b9863814">misses</a> + <a class="code" href="classNeighborCache.html#a39da5066d1b99988174cc8546564600b">hits</a>)));
    }


    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> &amp;&amp; <a class="code" href="classNeighborCache.html#a22a9c8f9d8054711dd9b4c972940fdcd">numMsg</a> &gt; 0) {
        <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;NeighborCache: NCS absolute RTT error&quot;</span>,
                                    <a class="code" href="classNeighborCache.html#a3a41df8495c9a6b70fc715e308a8ea2d">absoluteError</a> / (<span class="keywordtype">double</span>)<a class="code" href="classNeighborCache.html#a22a9c8f9d8054711dd9b4c972940fdcd">numMsg</a>);
        <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;NeighborCache: NCS relative RTT error&quot;</span>,
                                    <a class="code" href="classNeighborCache.html#a2a635befdb541a1d491b23fe52616370">relativeError</a> / (<span class="keywordtype">double</span>)numMsg);
        <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;NeighborCache: number of messages/s&quot;</span>,
                                    numMsg / SIMTIME_DBL(simTime() - <a class="code" href="classBaseApp.html#ac365b8c1cb45fb1e37f95535936a0f31" title="simTime when the App has been created">creationTime</a>));
        <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;NeighborCache: NCS percentage of RTT errors to high&quot;</span>,
                                    (<span class="keywordtype">double</span>)<a class="code" href="classNeighborCache.html#a5de22621c8d7fa8bbe85e49d3b6b8927">numRttErrorToHigh</a> / (<span class="keywordtype">double</span>)numMsg);
        <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;NeighborCache: NCS percentage of RTT errors to low&quot;</span>,
                                    (<span class="keywordtype">double</span>)<a class="code" href="classNeighborCache.html#a86b66679e384f12f73bd4dbcc770f8e6">numRttErrorToLow</a> / (<span class="keywordtype">double</span>)numMsg);
    }

    <span class="keywordflow">if</span>(<a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>) {
        <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>-&gt;<a class="code" href="classTreeManagement.html#a92e01ba568e4da809c0ecff163c340f3" title="finish module and collect statistical data">finishTreeManagement</a>();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a850073aebd8d46ba5432ed79a62885c5"></a><!-- doxytag: member="NeighborCache::getAvgAbsPredictionError" ref="a850073aebd8d46ba5432ed79a62885c5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double NeighborCache::getAvgAbsPredictionError </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00597">597</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="SVivaldi_8cc_source.html#l00043">SVivaldi::calcError()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">/*</span>
<span class="comment">    //TODO retain and consider the last measured RTTs not the last error(s)</span>
<span class="comment">    double absoluteDiff = 0.0;</span>
<span class="comment">    uint32_t numNeighbors = 0;</span>
<span class="comment"></span>
<span class="comment">    for (std::map&lt;TransportAddress, std::vector&lt;double&gt; &gt;::iterator it =</span>
<span class="comment">        lastAbsoluteErrorPerNode.begin(); it != lastAbsoluteErrorPerNode.end();</span>
<span class="comment">        it++) {</span>
<span class="comment">        double tempAbsoluteDiff = 0.0;</span>
<span class="comment">        for (uint32_t i = 0; i &lt; it-&gt;second.size(); i++) {</span>
<span class="comment">            tempAbsoluteDiff += it-&gt;second.at(i);</span>
<span class="comment">        }</span>
<span class="comment">        absoluteDiff += (tempAbsoluteDiff / it-&gt;second.size());</span>
<span class="comment">        numNeighbors++;</span>
<span class="comment">    }</span>
<span class="comment"></span>
<span class="comment">    absoluteDiff /= numNeighbors;</span>
<span class="comment">    return (absoluteDiff &gt; 1.0) ? 1.0 : absoluteDiff;</span>
<span class="comment">     */</span>

    <span class="comment">// old version</span>
    <span class="comment">//if (neighborCache.size() &lt; 2 || sampleSize == 0) return 1.0;</span>

    <span class="keywordtype">double</span> absoluteDiff = 0;
    uint32_t numNeighbors = 0;
    uint32_t sampleSize = 10; <span class="comment">//test</span>

    <span class="keywordflow">for</span> (std::map&lt;simtime_t, TransportAddress&gt;::reverse_iterator it =
            <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.rbegin();
            it != <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.rend() &amp;&amp;
                    numNeighbors &lt; sampleSize; ++it) {
        NeighborCacheEntry&amp; cacheEntry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[it-&gt;second];


        <span class="keywordtype">double</span> dist = <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#afb2c12a5b86a18f15f7a47a95d8bfc4e">getOwnNcsInfo</a>().<a class="code" href="classAbstractNcsNodeInfo.html#aeafc338042632a38a41e25bf203aa169">getDistance</a>(*cacheEntry.coordsInfo);

        <span class="keywordflow">if</span> (dist != 0 &amp;&amp; cacheEntry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a>) {
            <span class="keywordtype">double</span> predictionError = fabs(dist - SIMTIME_DBL(cacheEntry.rtt));

            <span class="comment">//test: error weighted</span>
            <span class="comment">//if (it-&gt;second.coordErr &lt; 1) {</span>
            <span class="comment">//    predictionError /= it-&gt;second.coordErr;</span>
            <span class="comment">//}</span>
            <span class="comment">//test: age weighted</span>
            <span class="comment">//if ((simTime() - it-&gt;second.insertTime) &gt; 1) {</span>
            <span class="comment">//    predictionError /= (simTime() - it-&gt;second.insertTime);</span>
            <span class="comment">//}</span>

            numNeighbors++;
            absoluteDiff += predictionError;
        }
    }
    assert(numNeighbors != 0);
    absoluteDiff /= numNeighbors;

    <span class="keywordflow">return</span> (absoluteDiff &gt; 1.0) ? 1.0 : absoluteDiff;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a807c7e77f42e52bf22d1340e207125a6"></a><!-- doxytag: member="NeighborCache::getBootstrapNode" ref="a807c7e77f42e52bf22d1340e207125a6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp; NeighborCache::getBootstrapNode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01172">1172</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classTransportAddress.html#ac1709545db722cbbce1367034142d31f" title="TransportAddress without specified ip and port.">TransportAddress::UNSPECIFIED_NODE</a>;
    <span class="comment">//TODO failed bootstrap nodes are only detected and removed from nc</span>
    <span class="comment">// if rpcs are used for joining</span>

    <span class="comment">// return close node (discovery mode)</span>
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>) {
        <span class="keywordflow">for</span> (uint16_t i = 0; i &lt; <a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>-&gt;size(); ++i) {
            <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count((*<a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>)[i]) &gt; 0 &amp;&amp;
                    <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[(*closestNodes)[i]].rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a>) {
                <span class="comment">//std::cout &lt;&lt; (*closestNodes)[i].getProx().proximity &lt;&lt; &quot;\n&quot;&lt;&lt; std::endl;</span>
                <span class="keywordflow">return</span> (*<a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>)[i];
            }
        }
    }

    <span class="comment">// return known alive node</span>
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size() &gt; 0) {
        <a class="code" href="classNeighborCache.html#a81f00b07e9a47f134156759e5b878443">NeighborCacheConstIterator</a> it = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.begin();
        <span class="keywordflow">while</span> (it != <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.end() &amp;&amp;
                it-&gt;second.rttState != <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a>) ++it;
        <span class="keywordflow">if</span> (it != <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.end()) {
            <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.begin()-&gt;first;
        }
    }
    <span class="keywordflow">return</span> <a class="code" href="classTransportAddress.html#ac1709545db722cbbce1367034142d31f" title="TransportAddress without specified ip and port.">TransportAddress::UNSPECIFIED_NODE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a07cb82893b7483ca7f247bad059b5a3e"></a><!-- doxytag: member="NeighborCache::getClosestNodes" ref="a07cb82893b7483ca7f247bad059b5a3e" args="(uint8_t number)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; * NeighborCache::getClosestNodes </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00558">558</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="DiscoveryMode_8cc_source.html#l00097">DiscoveryMode::handleRpcCall()</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::vector&lt;TransportAddress&gt;* nodes =
            <span class="keyword">new</span> std::vector&lt;TransportAddress&gt;();

    <span class="keywordflow">for</span> (uint8_t i = 0; (i &lt; number &amp;&amp; i &lt; <a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>-&gt;size()); ++i) {
        nodes-&gt;push_back((*<a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>)[i]);
    }

    <span class="keywordflow">return</span> nodes;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad9e7edece1f862fc607302542a62879b"></a><!-- doxytag: member="NeighborCache::getCoordinateBasedProx" ref="ad9e7edece1f862fc607302542a62879b" args="(const TransportAddress &amp;node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structProx.html">Prox</a> NeighborCache::getCoordinateBasedProx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01016">1016</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00976">estimateProx()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l01036">recordNcsEstimationError()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> &amp;&amp; <a class="code" href="classNeighborCache.html#a416f18a5fea738589845fd630d6cf071">isEntry</a>(node)) {
        <span class="keyword">const</span> <a class="code" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a>* temp = <a class="code" href="classNeighborCache.html#a5bfc95cec29a0c320e3586629fb85504" title="Returns the coordinate information of a node.">getNodeCoordsInfo</a>(node);
        <span class="keywordflow">if</span> (temp) <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#a448ab29cb9bd376b3181f1e5f282a98c">getCoordinateBasedProx</a>(*temp);
    }
    <span class="keywordflow">return</span> <a class="code" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af02289b6b99c9b1e7c902175ef76d175"></a><!-- doxytag: member="NeighborCache::getMeanVarRtt" ref="af02289b6b99c9b1e7c902175ef76d175" args="(const TransportAddress &amp;node, bool returnVar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; simtime_t, simtime_t &gt; NeighborCache::getMeanVarRtt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>returnVar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01076">1076</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01118">getRttBasedTimeout()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(node) == 0) {
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;NeighborCache.cc: getMeanVarRtt was asked for&quot;</span>
                <span class="stringliteral">&quot;a non-existent node reference.&quot;</span>);
    }

    uint16_t size = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node].lastRtts.size();
    <span class="keywordflow">if</span> (size == 0) <span class="keywordflow">return</span> std::make_pair(-1.0,-1.0);

    simtime_t rttSum = 0;
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++){
        rttSum += <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node].lastRtts[i];
    }
    simtime_t meanRtt = rttSum / size;
    <span class="keywordflow">if</span> (!returnVar) {
        <span class="keywordflow">return</span> std::make_pair(meanRtt, -1.0);
    }
    <span class="keywordflow">if</span> (size == 1) {
        <span class="keywordflow">return</span> std::make_pair(meanRtt, 0.0);
    }

    <span class="keywordtype">double</span> sum = 0.0;
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++){
        simtime_t tempRtt = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node].lastRtts.at(i) - meanRtt;
        sum += (SIMTIME_DBL(tempRtt) * SIMTIME_DBL(tempRtt));
    }

    <span class="keywordflow">return</span> std::make_pair(meanRtt, (sum / size));
}
</pre></div>
</div>
</div>
<a class="anchor" id="affdf04759fd1df8315954b8789d91eab"></a><!-- doxytag: member="NeighborCache::getNcsAccess" ref="affdf04759fd1df8315954b8789d91eab" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classAbstractNcs.html">AbstractNcs</a>&amp; NeighborCache::getNcsAccess </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00264">264</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="GlobalViewBuilder_8cc_source.html#l00069">GlobalViewBuilder::cleanup()</a>, <a class="el" href="Landmark_8cc_source.html#l00079">Landmark::finishApp()</a>, <a class="el" href="GlobalViewBuilder_8cc_source.html#l00224">GlobalViewBuilder::handleCoordSendTimer()</a>, <a class="el" href="Landmark_8cc_source.html#l00039">Landmark::initializeApp()</a>, <a class="el" href="BaseRpc_8cc_source.html#l00293">BaseRpc::internalHandleRpcMessage()</a>, <a class="el" href="DiscoveryMode_8cc_source.html#l00233">DiscoveryMode::sendNewRequest()</a>, <a class="el" href="BaseRpc_8cc_source.html#l00532">BaseRpc::sendRpcResponse()</a>, and <a class="el" href="DiscoveryMode_8cc_source.html#l00066">DiscoveryMode::stop()</a>.</p>
<div class="fragment"><pre class="fragment">                                            {
        <span class="keywordflow">if</span> (!<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;No NCS activated&quot;</span>);
        <span class="keywordflow">else</span> <span class="keywordflow">return</span> *<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>;
    };
</pre></div>
</div>
</div>
<a class="anchor" id="aa6f7beabed784d0269bfde141217557c"></a><!-- doxytag: member="NeighborCache::getNcsBasedTimeout" ref="aa6f7beabed784d0269bfde141217557c" args="(const NodeHandle &amp;node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t NeighborCache::getNcsBasedTimeout </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01145">1145</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01109">getNodeTimeout()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">double</span> timeout = -1;
    <a class="code" href="structProx.html">Prox</a> prox = <a class="code" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>;

    <span class="comment">// check if an entry is available in NeighborCache</span>
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a416f18a5fea738589845fd630d6cf071">isEntry</a>(node)) {
        prox = <a class="code" href="classNeighborCache.html#ab934be8fb503f9629cf6eb83e7d1b576" title="Gets the proximity of a node.">getProx</a>(node, <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccbab3073985667b1e3eb2215dbd96359fa9">NEIGHBORCACHE_ESTIMATED</a>);

        <span class="keywordflow">if</span> (prox != <a class="code" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>  &amp;&amp; prox != <a class="code" href="structProx.html#a5ded765f6344797ea0e9c35c85cd61af">Prox::PROX_TIMEOUT</a> &amp;&amp;
                prox.<a class="code" href="structProx.html#aeb8eca3cac2c681c5e7f1060fcbd7b6f">proximity</a> &gt; 0 &amp;&amp; prox.<a class="code" href="structProx.html#a74cc898fbab0f32238e92c530c27183c">accuracy</a> &gt; <a class="code" href="classNeighborCache.html#a05ae665acfd7d6504d624d69a95428ef">timeoutAccuracyLimit</a>) {
            timeout = prox.<a class="code" href="structProx.html#aeb8eca3cac2c681c5e7f1060fcbd7b6f">proximity</a> + (6 * (1 - prox.<a class="code" href="structProx.html#a74cc898fbab0f32238e92c530c27183c">accuracy</a>));
            timeout += <a class="code" href="classNeighborCache.html#ab645ed14a47c403b86243192fcbfa27c">NCS_TIMEOUT_CONSTANT</a>;
        } <span class="keywordflow">else</span> <span class="keywordflow">return</span> -1;

        <span class="keywordflow">if</span> (<span class="comment">/*timeout &gt; SIMTIME_DBL(defaultTimeout) ||*/</span> timeout &lt; 0)
            <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">return</span> timeout;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2172131cd1f7e5958ad3e8c359ca3109"></a><!-- doxytag: member="NeighborCache::getNearestNode" ref="a2172131cd1f7e5958ad3e8c359ca3109" args="(uint8_t maxLayer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTransportAddress.html">TransportAddress</a> NeighborCache::getNearestNode </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>maxLayer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00537">537</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classTransportAddress.html" title="This class implements a common transport address.">TransportAddress</a> nearestNode = <a class="code" href="classTransportAddress.html#ac1709545db722cbbce1367034142d31f" title="TransportAddress without specified ip and port.">TransportAddress::UNSPECIFIED_NODE</a>;
    simtime_t nearestNodeRtt = MAXTIME;
    <a class="code" href="classNeighborCache.html#aed1572b2a597a0654f4d355760aa5942">NeighborCacheIterator</a> it;

    <span class="keywordflow">for</span>(it = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.begin(); it != <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.end(); it++ ) {
        <span class="keywordflow">if</span> (it-&gt;second.rtt &lt; nearestNodeRtt &amp;&amp;
                it-&gt;second.rtt &gt; 0 <span class="comment">/*&amp;&amp;</span>
<span class="comment">            it-&gt;second.coordsInfo.npsLayer &lt; maxLayer+1 &amp;&amp;</span>
<span class="comment">            it-&gt;second.coordsInfo.npsLayer &gt; 0*/</span>) {
            nearestNode.<a class="code" href="classTransportAddress.html#a1c7b834dc2e6e738f1f4db8711a12814" title="Sets the ip address, port and NAT type.">setIp</a>(it-&gt;first.getIp());
            nearestNodeRtt = it-&gt;second.rtt;
            nearestNode.<a class="code" href="classTransportAddress.html#a46a1b53760e5f2d3f8af8c9591160a48" title="sets this-&gt;port to the given port">setPort</a>(it-&gt;second.nodeRef.getPort());
        }
    }

    <span class="keywordflow">return</span> nearestNode;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a23203e2d09c77efbba57a85212f2f9df"></a><!-- doxytag: member="NeighborCache::getNeighborCacheSize" ref="a23203e2d09c77efbba57a85212f2f9df" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t NeighborCache::getNeighborCacheSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00271">271</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size(); };
</pre></div>
</div>
</div>
<a class="anchor" id="a8a19fa241b9d8eda9092a93a4a41b9bb"></a><!-- doxytag: member="NeighborCache::getNodeAge" ref="a8a19fa241b9d8eda9092a93a4a41b9bb" args="(const TransportAddress &amp;handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t NeighborCache::getNodeAge </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00492">492</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(address) == 0) {
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;NeighborCache.cc: getNodeAge was asked for &quot;</span>
                <span class="stringliteral">&quot;a non-existent address.&quot;</span>);
    }
    <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[address].insertTime;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2dae7f2c34de3d5ce4e9032f0b00c07b"></a><!-- doxytag: member="NeighborCache::getNodeContexts" ref="a2dae7f2c34de3d5ce4e9032f0b00c07b" args="(const TransportAddress &amp;handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNeighborCache.html#aa690fa08dd5460980e15bae581ef04d4">NeighborCache::WaitingContexts</a> NeighborCache::getNodeContexts </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00278">278</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00289">setNodeTimeout()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(handle) == 0)
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;NeighborCache error!&quot;</span>);
    <a class="code" href="classNeighborCache.html#aa690fa08dd5460980e15bae581ef04d4">WaitingContexts</a> temp = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[handle].waitingContexts;
    <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[handle].waitingContexts.clear();

    <span class="keywordflow">return</span> temp;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5bfc95cec29a0c320e3586629fb85504"></a><!-- doxytag: member="NeighborCache::getNodeCoordsInfo" ref="a5bfc95cec29a0c320e3586629fb85504" args="(const TransportAddress &amp;node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> * NeighborCache::getNodeCoordsInfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the coordinate information of a node. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The node whose coordinate information will be requested. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The coordinate information. </dd></dl>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01026">1026</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00209">Nps::coordsReqRpcResponse()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l01016">getCoordinateBasedProx()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(node) == 0) {
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;NeighborCache.cc: getNodeCoords was asked for &quot;</span>
                <span class="stringliteral">&quot;a non-existent node reference.&quot;</span>);
    }
    <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node].coordsInfo;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a393f2dab8d25fcc23ad3c53cf9228080"></a><!-- doxytag: member="NeighborCache::getNodeHandle" ref="a393f2dab8d25fcc23ad3c53cf9228080" args="(const TransportAddress &amp;add)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp; NeighborCache::getNodeHandle </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>add</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00483">483</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(add) == 0) {
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;NeighborCache.cc: getNodeHandle was asked for &quot;</span>
                <span class="stringliteral">&quot;a non-existent node reference.&quot;</span>);
    }
    <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[add].nodeRef;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab94f734ab0667605962f2bb4f315e9f1"></a><!-- doxytag: member="NeighborCache::getNodeRtt" ref="ab94f734ab0667605962f2bb4f315e9f1" args="(const TransportAddress &amp;add)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNeighborCache.html#ad6b6e27419b9657874d3517f2cc62dcf">NeighborCache::Rtt</a> NeighborCache::getNodeRtt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>add</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00457">457</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00209">Nps::coordsReqRpcResponse()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00976">estimateProx()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// cache disabled or entry not there</span>
    <span class="keywordflow">if</span> (!<a class="code" href="classNeighborCache.html#a14ea96324f1a0c102dee609d89cff72a">enableNeighborCache</a> ||
            add.<a class="code" href="classTransportAddress.html#a026e777c423ff2a0280edd2fa5472e74" title="indicates if TransportAddress is specified">isUnspecified</a>() ||
            (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(add) == 0)) {
        <a class="code" href="classNeighborCache.html#a54211a9fd7c6562ff15323e5b9863814">misses</a>++;
        <span class="keywordflow">return</span> std::make_pair(0.0, <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>);
    }

    NeighborCacheEntry &amp;entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[add];

    <span class="keywordflow">if</span> (entry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a> ||
            entry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>)
        <span class="keywordflow">return</span> std::make_pair(entry.rtt, entry.rttState);
    <span class="comment">// entry expired</span>
    <span class="keywordflow">if</span> ((simTime() - entry.insertTime) &gt;= <a class="code" href="classNeighborCache.html#ab3ba13a3310b16ef691ee52eac897c72">rttExpirationTime</a>) {
        entry.rttState = <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>;
        <span class="keywordflow">return</span> std::make_pair(entry.rtt, <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>);
    }
    <a class="code" href="classNeighborCache.html#a39da5066d1b99988174cc8546564600b">hits</a>++;
    assert(!(entry.rtt == 0.0 &amp;&amp; entry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a>));
    <span class="keywordflow">return</span> std::make_pair(entry.rtt, entry.rttState);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a23056db53fc60a2eaedf425b7370146e"></a><!-- doxytag: member="NeighborCache::getNodeTimeout" ref="a23056db53fc60a2eaedf425b7370146e" args="(const NodeHandle &amp;node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t NeighborCache::getNodeTimeout </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Caclulation of reasonable timout value. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>the node an RPC is sent to </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>recommended timeout value </dd></dl>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01109">1109</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="BaseRpc_8cc_source.html#l00173">BaseRpc::sendRpcCall()</a>.</p>
<div class="fragment"><pre class="fragment">{
    simtime_t timeout = <a class="code" href="classNeighborCache.html#a1ba760d3b98f17dd3951ba64ec54e30f">getRttBasedTimeout</a>(node);
    <span class="keywordflow">if</span> (timeout == -1 &amp;&amp; <a class="code" href="classNeighborCache.html#a35eddfa8e8b64ba9cdbe138f8067d07f">useNcsForTimeout</a> &amp;&amp; <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#aa6f7beabed784d0269bfde141217557c">getNcsBasedTimeout</a>(node);
    <span class="keywordflow">return</span> timeout;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a54e923d5f3f6ca83696e23cc466f8e09"></a><!-- doxytag: member="NeighborCache::getOverlayThisNode" ref="a54e923d5f3f6ca83696e23cc466f8e09" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classNodeHandle.html">NodeHandle</a>&amp; NeighborCache::getOverlayThisNode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00269">269</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="SimpleNcs_8cc_source.html#l00036">SimpleNcs::init()</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseRpc.html#ac3f420630d5618e81709c078b06fd9da" title="Returns the NodeHandle of this node.">getThisNode</a>(); };
</pre></div>
</div>
</div>
<a class="anchor" id="ab934be8fb503f9629cf6eb83e7d1b576"></a><!-- doxytag: member="NeighborCache::getProx" ref="ab934be8fb503f9629cf6eb83e7d1b576" args="(const TransportAddress &amp;node, NeighborCacheQueryType type=NEIGHBORCACHE_AVAILABLE, int rpcId=&#45;1, ProxListener *listener=NULL, cPolymorphic *contextPointer=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structProx.html">Prox</a> NeighborCache::getProx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccb">NeighborCacheQueryType</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code>NEIGHBORCACHE_AVAILABLE</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rpcId</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProxListener.html">ProxListener</a> *&#160;</td>
          <td class="paramname"><em>listener</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&#160;</td>
          <td class="paramname"><em>contextPointer</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets the proximity of a node. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The node whose proximity will be requested. </td></tr>
    <tr><td class="paramname">type</td><td>Request type. NEIGHBORCACHE_EXACT looks in the cache, and if no value is found, sends an RTT query to the node. NEIGHBORCACHE_AVAILABLE looks in the cache, and if no value is found returns <a class="el" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>. NEIGHBORCACHE_ESTIMATED looks in the cache, and if no value is found calculates an estimate based on information collected by the overlay. NEIGHBORCACHE_QUERY always sends an RTT query to the node and returns <a class="el" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>. </td></tr>
    <tr><td class="paramname">rpcId</td><td>Identifier sent to the RPC to identify the call. </td></tr>
    <tr><td class="paramname">listener</td><td>Module to be called back when an RTT response arrives. </td></tr>
    <tr><td class="paramname">contextPointer</td><td>Pointer sent to the RPC to identify the call. IMPORTANT: contextPointer gets deleted (only) if no Ping call is sent! So, *contextpointer may be undefined! </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The proximity value of node. </dd></dl>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00853">853</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="BasePastry_8cc_source.html#l00438">BasePastry::determineAliveTable()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01145">getNcsBasedTimeout()</a>, <a class="el" href="DiscoveryMode_8cc_source.html#l00140">DiscoveryMode::handleRpcResponse()</a>, <a class="el" href="Bamboo_8cc_source.html#l00455">Bamboo::lookupFinished()</a>, <a class="el" href="BasePastry_8cc_source.html#l00369">BasePastry::pingNodes()</a>, <a class="el" href="BasePastry_8cc_source.html#l00342">BasePastry::prePing()</a>, and <a class="el" href="Kademlia_8cc_source.html#l00320">Kademlia::routingAdd()</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method(<span class="stringliteral">&quot;getProx()&quot;</span>);

    <span class="keywordflow">if</span> (!<a class="code" href="classNeighborCache.html#a14ea96324f1a0c102dee609d89cff72a">enableNeighborCache</a>) {
        <a class="code" href="classNeighborCache.html#aab267d208202e7bf8dc1c7aecc66b550" title="Sends a pingNode call based on parameters from a getProx call.">queryProx</a>(node, rpcId, listener, contextPointer);
        <span class="keywordflow">return</span> <a class="code" href="structProx.html#abf2f5f92914e5e617c5ef157ea5ffc86">Prox::PROX_WAITING</a>;
    }

    <span class="keywordflow">if</span> (node == <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseRpc.html#ac3f420630d5618e81709c078b06fd9da" title="Returns the NodeHandle of this node.">getThisNode</a>()) {
        <span class="keyword">delete</span> contextPointer;
        <span class="keywordflow">return</span> <a class="code" href="structProx.html#ae33fb924891e14e0161708bfadf8f033">Prox::PROX_SELF</a>;
    }

    <span class="keywordflow">if</span> (node.<a class="code" href="classTransportAddress.html#a026e777c423ff2a0280edd2fa5472e74" title="indicates if TransportAddress is specified">isUnspecified</a>()) {
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Prox queried for undefined TransportAddress!&quot;</span>);
        <span class="keyword">delete</span> contextPointer;
        <span class="keywordflow">return</span> <a class="code" href="structProx.html#a5ded765f6344797ea0e9c35c85cd61af">Prox::PROX_TIMEOUT</a>;
    }

    <span class="keywordtype">bool</span> sendQuery = <span class="keyword">false</span>;
    <a class="code" href="structProx.html">Prox</a> result = <a class="code" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>;
    <a class="code" href="classNeighborCache.html#ad6b6e27419b9657874d3517f2cc62dcf">Rtt</a> rtt = <a class="code" href="classNeighborCache.html#ab94f734ab0667605962f2bb4f315e9f1">getNodeRtt</a>(node);

    <span class="comment">//countGetProxTotal++;</span>
    <span class="keywordflow">if</span> (type == <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba751bede7ee708c74811f4bd49ee74cea">NEIGHBORCACHE_DEFAULT</a>) type = <a class="code" href="classNeighborCache.html#a11a4145a2f976de746ffb5eb80b8720e">defaultQueryType</a>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccbaa7fa0fb5215e636f2694f8d021d44f8b">NEIGHBORCACHE_DEFAULT_IMMEDIATELY</a>) type = <a class="code" href="classNeighborCache.html#a88e4d57df1eece811a04c75c2eb61c00">defaultQueryTypeI</a>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba03b4a3e8219995ffea0a4c9572d7f0bf">NEIGHBORCACHE_DEFAULT_QUERY</a>) type = <a class="code" href="classNeighborCache.html#a8a01390ead6fc76dcc7d76e5e2253481">defaultQueryTypeQ</a>;

    <span class="keywordflow">switch</span>(type) {
    <span class="keywordflow">case</span> <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba5a3faf832a3994bb6c8aa459a653e7f8">NEIGHBORCACHE_EXACT</a>:
        <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">RTTSTATE_TIMEOUT</a>) {
            <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a8a19fa241b9d8eda9092a93a4a41b9bb">getNodeAge</a>(node) == simTime()) {
                <span class="comment">// right now, we got a time-out, so no new ping is sent</span>
                result = <a class="code" href="structProx.html#a5ded765f6344797ea0e9c35c85cd61af">Prox::PROX_TIMEOUT</a>;
            } <span class="keywordflow">else</span>{
                <span class="comment">// if timeout, return unknown???, and send a query!</span>
                result = <a class="code" href="structProx.html#abf2f5f92914e5e617c5ef157ea5ffc86">Prox::PROX_WAITING</a>;
                sendQuery = <span class="keyword">true</span>;
            }
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>) {
            <span class="comment">// if a query was sent, return WAITING</span>
            result = <a class="code" href="structProx.html#abf2f5f92914e5e617c5ef157ea5ffc86">Prox::PROX_WAITING</a>;
            sendQuery = <span class="keyword">true</span>; <span class="comment">//just inserting a context, no real ping is sent</span>
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>) {
            <span class="comment">// if no entry known, send a query and return UNKNOWN</span>
            result = <a class="code" href="structProx.html#abf2f5f92914e5e617c5ef157ea5ffc86">Prox::PROX_WAITING</a>; <span class="comment">//???</span>
            sendQuery = <span class="keyword">true</span>;
        } <span class="keywordflow">else</span> {
            <span class="comment">// else, return whatever we have</span>
            result = rtt.first;
        }
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccbab2c99c532f604e6029aacc815fd1f67e">NEIGHBORCACHE_EXACT_TIMEOUT</a>:
        <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">RTTSTATE_TIMEOUT</a>) {
            <span class="comment">// if timeout, return that</span>
            result = <a class="code" href="structProx.html#a5ded765f6344797ea0e9c35c85cd61af">Prox::PROX_TIMEOUT</a>;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>) {
            <span class="comment">// if a query was sent, return WAITING;</span>
            result = <a class="code" href="structProx.html#abf2f5f92914e5e617c5ef157ea5ffc86">Prox::PROX_WAITING</a>;
            sendQuery = <span class="keyword">true</span>; <span class="comment">//just inserting a context, no real ping is sent</span>
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>) {
            <span class="comment">// if no entry known, send a query and return UNKNOWN</span>
            result = <a class="code" href="structProx.html#abf2f5f92914e5e617c5ef157ea5ffc86">Prox::PROX_WAITING</a>; <span class="comment">//???</span>
            sendQuery = <span class="keyword">true</span>;
        } <span class="keywordflow">else</span> {
            <span class="comment">// else, return whatever we have</span>
            result = rtt.first;
        }
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccbab3073985667b1e3eb2215dbd96359fa9">NEIGHBORCACHE_ESTIMATED</a>:
        <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">RTTSTATE_TIMEOUT</a>) {
            <span class="comment">// if timeout, return that</span>
            result = <a class="code" href="structProx.html#a5ded765f6344797ea0e9c35c85cd61af">Prox::PROX_TIMEOUT</a>;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>) {
            <span class="comment">// if a query was sent, return an estimate</span>
            result = <a class="code" href="classNeighborCache.html#a1d0b6dc71b5933f46f888100c8aaf70a" title="Estimates a Prox value of node, in relation to this node, based on information collected by the overl...">estimateProx</a>(node);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>) {
            <span class="comment">// if no entry known, return an estimate</span>
            result = <a class="code" href="classNeighborCache.html#a1d0b6dc71b5933f46f888100c8aaf70a" title="Estimates a Prox value of node, in relation to this node, based on information collected by the overl...">estimateProx</a>(node);
        } <span class="keywordflow">else</span> {
            <span class="comment">// else return whatever we have</span>
            result = rtt.first;
        }
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba1a4aaeee725859332274f6df4a4a64c1">NEIGHBORCACHE_AVAILABLE</a>:
        <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">RTTSTATE_TIMEOUT</a>) {
            <span class="comment">// if timeout, return that.</span>
            result = <a class="code" href="structProx.html#a5ded765f6344797ea0e9c35c85cd61af">Prox::PROX_TIMEOUT</a>;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>) {
            <span class="comment">// if a query was sent return WAITING</span>
            result = <a class="code" href="structProx.html#abf2f5f92914e5e617c5ef157ea5ffc86">Prox::PROX_WAITING</a>;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rtt.second == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">RTTSTATE_UNKNOWN</a>) {
            <span class="comment">// if a query was sent return WAITING</span>
            result = <a class="code" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>;
        } <span class="keywordflow">else</span> {
            <span class="comment">// else return what we have</span>
            result = rtt.first;
        }
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba46557811e0915cca5028188f13edf357">NEIGHBORCACHE_QUERY</a>:
        <span class="comment">// simply send a query and return WAITING</span>
        result = <a class="code" href="structProx.html#abf2f5f92914e5e617c5ef157ea5ffc86">Prox::PROX_WAITING</a>;
        sendQuery = <span class="keyword">true</span>;
        <span class="keywordflow">break</span>;
    <span class="keywordflow">default</span>:
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Unknown query type!&quot;</span>);
        <span class="keywordflow">break</span>;

    }
    <span class="keywordflow">if</span> (sendQuery) {
        <span class="keywordflow">if</span> (!<a class="code" href="classNeighborCache.html#a414a936f37e71490de6af0eda317fa83">insertNodeContext</a>(node, contextPointer, listener, rpcId)) {
            <a class="code" href="classNeighborCache.html#aab267d208202e7bf8dc1c7aecc66b550" title="Sends a pingNode call based on parameters from a getProx call.">queryProx</a>(node, rpcId, listener, contextPointer);
        }
    } <span class="keywordflow">else</span> <span class="keyword">delete</span> contextPointer;

    <span class="keywordflow">return</span> result;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1ba760d3b98f17dd3951ba64ec54e30f"></a><!-- doxytag: member="NeighborCache::getRttBasedTimeout" ref="a1ba760d3b98f17dd3951ba64ec54e30f" args="(const NodeHandle &amp;node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t NeighborCache::getRttBasedTimeout </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01118">1118</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01109">getNodeTimeout()</a>.</p>
<div class="fragment"><pre class="fragment">{
    simtime_t timeout = -1;

    <span class="comment">// check if an entry is available in NeighborCache</span>
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a416f18a5fea738589845fd630d6cf071">isEntry</a>(node)) {
        std::pair&lt;simtime_t, simtime_t&gt; temp = <a class="code" href="classNeighborCache.html#af02289b6b99c9b1e7c902175ef76d175">getMeanVarRtt</a>(node, <span class="keyword">true</span>);
        simtime_t meanRtt = temp.first;
        simtime_t varRtt = temp.second;

        <span class="comment">// TODO return value even if node has timed out</span>
        <span class="keywordflow">if</span> (meanRtt == -1) <span class="keywordflow">return</span> -1;
        <span class="keywordflow">if</span> (varRtt &gt; 0) {
            <span class="comment">// like TCP</span>
            timeout = meanRtt + 4 * varRtt;
        } <span class="keywordflow">else</span> {
            <span class="comment">// only one RTT is available</span>
            timeout = meanRtt * 1.2;
        }
        <span class="comment">// adjustment</span>
        timeout *= <a class="code" href="classNeighborCache.html#abf8f22a91e7e5bb6095df851e586858f">RTT_TIMEOUT_ADJUSTMENT</a>;
        <span class="comment">//if (timeout &gt; SIMTIME_DBL(defaultTimeout)) return -1;</span>
    }
    <span class="keywordflow">return</span> timeout;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a125eb149eacf6814a06adbb5937bca19"></a><!-- doxytag: member="NeighborCache::getSpreadedNodes" ref="a125eb149eacf6814a06adbb5937bca19" args="(uint8_t number)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; * NeighborCache::getSpreadedNodes </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00570">570</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="DiscoveryMode_8cc_source.html#l00097">DiscoveryMode::handleRpcCall()</a>.</p>
<div class="fragment"><pre class="fragment">{
    std::vector&lt;TransportAddress&gt;* nodes =
            <span class="keyword">new</span> std::vector&lt;TransportAddress&gt;;

    <a class="code" href="classNeighborCache.html#a81f00b07e9a47f134156759e5b878443">NeighborCacheConstIterator</a> it = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.begin();
    <span class="keywordflow">for</span> (uint8_t i = 0; (i &lt; number &amp;&amp; i &lt; <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size()); ++i) {
        nodes-&gt;push_back((it++)-&gt;first);
    }

    <span class="comment">/*if (dynamic_cast&lt;BasePastry*&gt;(overlay)) {</span>
<span class="comment">        BasePastry* pastry = static_cast&lt;BasePastry*&gt;(overlay);</span>
<span class="comment">        std::vector&lt;TransportAddress&gt;* spreadedNodes = pastry-&gt;get</span>
<span class="comment">    }*/</span>

    <span class="keywordflow">return</span> nodes;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa6aafdbff910a02b3dc631a57f2b3ac4"></a><!-- doxytag: member="NeighborCache::getThisCompType" ref="aa6aafdbff910a02b3dc631a57f2b3ac4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="CommonMessages__m_8h.html#aad57ef0110fe8675eb299d467148bc5e">CompType</a> NeighborCache::getThisCompType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the component type of this module. </p>
<p>This method is overloaded by BaseOverlay/BaseApp and returns the appropriate component type of this module.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the component type of this module </dd></dl>

<p>Reimplemented from <a class="el" href="classBaseApp.html#a5125ad4468014966598aeb9630242a45">BaseApp</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00225">225</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="TreeManagement_8cc_source.html#l00293">TreeManagement::checkTreeChildNodes()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00138">TreeManagement::handleRpcTimeout()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00423">TreeManagement::registerAtParent()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00272">TreeManagement::sendChildReleaseCall()</a>, <a class="el" href="Nps_8cc_source.html#l00424">Nps::sendCoordsReqCall()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00662">TreeManagement::sendMessageToChildren()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00634">TreeManagement::sendMessageToParent()</a>, <a class="el" href="DiscoveryMode_8cc_source.html#l00233">DiscoveryMode::sendNewRequest()</a>, and <a class="el" href="DiscoveryMode_8cc_source.html#l00034">DiscoveryMode::start()</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="CommonMessages__m_8h.html#aad57ef0110fe8675eb299d467148bc5ead65752bbf62b380b2d957b69477f5742">NEIGHBORCACHE_COMP</a>; };
</pre></div>
</div>
</div>
<a class="anchor" id="a8317329015f5923320d94ae628401de2"></a><!-- doxytag: member="NeighborCache::getTreeManager" ref="a8317329015f5923320d94ae628401de2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTreeManagement.html">TreeManagement</a> * NeighborCache::getTreeManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a pointer to the treeManager Module. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>treeManager Module </dd></dl>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01167">1167</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="GlobalViewBuilder_8cc_source.html#l00224">GlobalViewBuilder::handleCoordSendTimer()</a>, and <a class="el" href="GlobalViewBuilder_8cc_source.html#l00033">GlobalViewBuilder::initializeViewBuilder()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4981e919440eb9decd3c8f75cb3d68ac"></a><!-- doxytag: member="NeighborCache::handleReadyMessage" ref="a4981e919440eb9decd3c8f75cb3d68ac" args="(CompReadyMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::handleReadyMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCompReadyMessage.html">CompReadyMessage</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>handle ready message - build tree topology </p>

<p>Reimplemented from <a class="el" href="classBaseApp.html#a4f1c969fd41786127717f15e8a357130">BaseApp</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00658">658</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// bootstrap list is ready</span>
    <span class="keywordflow">if</span> (readyMsg-&gt;getReady() &amp;&amp; readyMsg-&gt;getComp() == <a class="code" href="CommonMessages__m_8h.html#aad57ef0110fe8675eb299d467148bc5ea6b7871eeda317b7934cc8fb0b84899c5">BOOTSTRAPLIST_COMP</a>) {
        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a>) {
            <a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a>-&gt;<a class="code" href="classDiscoveryMode.html#ac622d18bed247256c8375008cd899ae5">start</a>(<a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseOverlay.html#aab1198e37993729eaf87350d5b83f9a0">getBootstrapList</a>().<a class="code" href="classBootstrapList.html#ac351433be1d43bbf8cbb871e9f9e1f69" title="Get a bootstrap node from the bootstrap list.">getBootstrapNode</a>());
        } <span class="keywordflow">else</span> {
            <span class="comment">// inform overlay</span>
            <a class="code" href="classNeighborCache.html#a0df75e09a10623f6ad9e45ee05f20938">prepareOverlay</a>();
        }
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (readyMsg-&gt;getReady() &amp;&amp; readyMsg-&gt;getComp() == <a class="code" href="CommonMessages__m_8h.html#aad57ef0110fe8675eb299d467148bc5ead1b904580b02f8adaa1ab2de239c4c79">OVERLAY_COMP</a>) {
        <span class="comment">// overlay is ready, build up tree</span>
        <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> = <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseRpc.html#ac3f420630d5618e81709c078b06fd9da" title="Returns the NodeHandle of this node.">getThisNode</a>();
        <span class="keywordflow">if</span>(<a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>) {
            <span class="comment">//std::cout &lt;&lt; thisNode &lt;&lt; &quot;treeManager-&gt;startTreeBuilding()&quot; &lt;&lt; std::endl;</span>
            <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>-&gt;<a class="code" href="classTreeManagement.html#adc6f93b4af76efcd31a605b77789421d">startTreeBuilding</a>();
            <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>) {
                <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#a6dc363b6ab217e8625b771d5fc7b0cc7">cleanup</a>();
                <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#aa8ae1389d89de7cbcb03c13ba68895fb">start</a>();
            }
        }
    } <span class="comment">//else {</span>
        <span class="comment">//TODO</span>
    <span class="comment">//}</span>
    <span class="keyword">delete</span> readyMsg;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0b7a352cb7d5eb83c9a04b1e0f52a5d0"></a><!-- doxytag: member="NeighborCache::handleRpcCall" ref="a0b7a352cb7d5eb83c9a04b1e0f52a5d0" args="(BaseCallMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool NeighborCache::handleRpcCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Coord / RTT measuring rpc stuff goes here. </p>

<p>Reimplemented from <a class="el" href="classBaseRpc.html#a20e77c3e0c203762a5b582ffebe3ba4b">BaseRpc</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00814">814</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">bool</span> messageHandled = <span class="keyword">false</span>;<span class="comment">//TODO</span>

    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> &amp;&amp; !messageHandled) {
        messageHandled = <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#ad4866b8d1f605a32ec74e27eef5bfcd4">handleRpcCall</a>(msg); <span class="comment">//TODO</span>
    }
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a> &amp;&amp; !messageHandled) {
        messageHandled = <a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a>-&gt;<a class="code" href="classDiscoveryMode.html#a3105fd0ad97e5d66f443450c23bb3dbf">handleRpcCall</a>(msg);
    }

    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a> &amp;&amp; !messageHandled) {
        messageHandled = <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>-&gt;<a class="code" href="classTreeManagement.html#aa525eb5ac9d59a285d481736e6b280f1">handleRpcCall</a>(msg);

        <span class="keywordflow">if</span>(<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a> &amp;&amp; !messageHandled) {
            messageHandled = <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#a4f62de45a0457486749cabcad83802e8">handleRpcCall</a>(msg);
        }
    }

    <span class="keywordflow">return</span> messageHandled;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a54e488bca853c3d1b4ea1480fefc81e8"></a><!-- doxytag: member="NeighborCache::handleTimerEvent" ref="a54e488bca853c3d1b4ea1480fefc81e8" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::handleTimerEvent </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classBaseRpc.html#ab893c156412e38caa62fe058b229899b">BaseRpc</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00780">780</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (msg == <a class="code" href="classNeighborCache.html#a0a24e2ba7ad8f0328e4b4b829eae9e63">cbrTimer</a>) {
        <span class="comment">// TODO duplicate code</span>
        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#a5e5999c901d2785118175fbce25b4005">isCapValid</a>() &amp;&amp;
            (<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSimpleNcs.html">SimpleNcs</a>*<span class="keyword">&gt;</span>(<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) || (dynamic_cast&lt;SVivaldi*&gt;(<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) &amp;&amp;
            <span class="keyword">static_cast&lt;</span><a class="code" href="classSVivaldi.html">SVivaldi</a>*<span class="keyword">&gt;</span>(<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>)-&gt;getLoss() &gt; 0.95 &amp;&amp;
            <span class="keyword">static_cast&lt;</span><a class="code" href="classSVivaldi.html">SVivaldi</a>*<span class="keyword">&gt;</span>(<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>)-&gt;getOwnError() &lt; 0.2))) { <span class="comment">//TODO</span>
            <a class="code" href="classNeighborCache.html#ab3b6bdb65927ffa2d71496c0351c54f2">setCbrNodeId</a>();
            <span class="comment">//std::cout &lt;&lt; thisNode.getIp() &lt;&lt; &quot; NeighborCache::handleTimerEvent(): setCbrNodeId(); overlay-&gt;join(thisNode.getKey())&quot; &lt;&lt; std::endl;</span>
            <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseOverlay.html#acb8855faa86247ae37ab894891d9f4dd" title="Join the overlay with a given nodeID.">join</a>(<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>());
            <span class="keywordflow">return</span>;
        } <span class="keywordflow">else</span> {
            <span class="comment">//assert(false);</span>
            <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseOverlay.html#acb8855faa86247ae37ab894891d9f4dd" title="Join the overlay with a given nodeID.">join</a>();
            <span class="keywordflow">return</span>;
            <span class="comment">//scheduleAt(simTime() + uniform(0, 5000), cbrTimer); //TODO</span>
        }
        <span class="keywordflow">return</span>;
    }
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) {
        <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#a162e9b1dc50c85190c0da04b58fc0053">handleTimerEvent</a>(msg);
    }

    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>) {
        <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>-&gt;<a class="code" href="classTreeManagement.html#ab63a46fb93d9225b4ce80385d3fd36da">handleTimerEvent</a>(msg);
    }

    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>) {
        <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#ad63b3d40bc4a4025edb25f6801dc8a83">handleTimerEvent</a>(msg);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9d114395eec6daa793b36bca06e24a22"></a><!-- doxytag: member="NeighborCache::initializeApp" ref="a9d114395eec6daa793b36bca06e24a22" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::initializeApp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>initializes derived class-attributes </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">stage</td><td>the init stage </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classBaseApp.html#ac9a059a2cfb67f4c38f462bb1383e795">BaseApp</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00073">73</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (stage == <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532a4d4d9a4da2e3c3b4ae4de11cc55b20de">MAX_STAGE_COMPONENTS</a>) {
        <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.clear();
        <a class="code" href="hashWatch_8h.html#ae15520d5e275d3c6aef5da79fb633201" title="Makes unordered_maps inspectable in Tkenv.">WATCH_UNORDERED_MAP</a>(<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>);

        <a class="code" href="classNeighborCache.html#a14ea96324f1a0c102dee609d89cff72a">enableNeighborCache</a> = par(<span class="stringliteral">&quot;enableNeighborCache&quot;</span>);
        <a class="code" href="classNeighborCache.html#ab3ba13a3310b16ef691ee52eac897c72">rttExpirationTime</a> = par(<span class="stringliteral">&quot;rttExpirationTime&quot;</span>);
        <a class="code" href="classNeighborCache.html#aacdd8a0ee2a9e893e21caf58cceb8576">maxSize</a> = par(<span class="stringliteral">&quot;maxSize&quot;</span>);
        <span class="comment">//doDiscovery = par(&quot;doDiscovery&quot;);</span>
        <a class="code" href="classNeighborCache.html#aeff6d75027528c27a7424fafc0fd5ae0">collectClosestNodes</a> = par(<span class="stringliteral">&quot;collectClosestNodes&quot;</span>);
        <a class="code" href="classNeighborCache.html#a9921c0eaa97c6836b731327abe0f0829">ncsPiggybackOwnCoords</a> = par(<span class="stringliteral">&quot;ncsPiggybackOwnCoords&quot;</span>);
        <a class="code" href="classNeighborCache.html#a35eddfa8e8b64ba9cdbe138f8067d07f">useNcsForTimeout</a> = par(<span class="stringliteral">&quot;useNcsForTimeout&quot;</span>);

        <span class="comment">// set default query types</span>
        std::string temp = par(<span class="stringliteral">&quot;defaultQueryType&quot;</span>).stdstringValue();
        <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;exact&quot;</span>)
            <a class="code" href="classNeighborCache.html#a11a4145a2f976de746ffb5eb80b8720e">defaultQueryType</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba5a3faf832a3994bb6c8aa459a653e7f8">NEIGHBORCACHE_EXACT</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;exact_timeout&quot;</span>)
            <a class="code" href="classNeighborCache.html#a11a4145a2f976de746ffb5eb80b8720e">defaultQueryType</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccbab2c99c532f604e6029aacc815fd1f67e">NEIGHBORCACHE_EXACT_TIMEOUT</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;available&quot;</span>)
            <a class="code" href="classNeighborCache.html#a11a4145a2f976de746ffb5eb80b8720e">defaultQueryType</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba1a4aaeee725859332274f6df4a4a64c1">NEIGHBORCACHE_AVAILABLE</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;estimated&quot;</span>)
            <a class="code" href="classNeighborCache.html#a11a4145a2f976de746ffb5eb80b8720e">defaultQueryType</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccbab3073985667b1e3eb2215dbd96359fa9">NEIGHBORCACHE_ESTIMATED</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">throw</span> cRuntimeError((std::string(<span class="stringliteral">&quot;Wrong query type: &quot;</span>)
        + temp).c_str());

        temp = par(<span class="stringliteral">&quot;defaultQueryTypeI&quot;</span>).stdstringValue();
        <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;available&quot;</span>)
            <a class="code" href="classNeighborCache.html#a88e4d57df1eece811a04c75c2eb61c00">defaultQueryTypeI</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba1a4aaeee725859332274f6df4a4a64c1">NEIGHBORCACHE_AVAILABLE</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;estimated&quot;</span>)
            <a class="code" href="classNeighborCache.html#a88e4d57df1eece811a04c75c2eb61c00">defaultQueryTypeI</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccbab3073985667b1e3eb2215dbd96359fa9">NEIGHBORCACHE_ESTIMATED</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">throw</span> cRuntimeError((std::string(<span class="stringliteral">&quot;Wrong query type (I): &quot;</span>)
        + temp).c_str());

        temp = par(<span class="stringliteral">&quot;defaultQueryTypeQ&quot;</span>).stdstringValue();
        <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;exact&quot;</span>)
            <a class="code" href="classNeighborCache.html#a8a01390ead6fc76dcc7d76e5e2253481">defaultQueryTypeQ</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba5a3faf832a3994bb6c8aa459a653e7f8">NEIGHBORCACHE_EXACT</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;exact_timeout&quot;</span>)
            <a class="code" href="classNeighborCache.html#a8a01390ead6fc76dcc7d76e5e2253481">defaultQueryTypeQ</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccbab2c99c532f604e6029aacc815fd1f67e">NEIGHBORCACHE_EXACT_TIMEOUT</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;query&quot;</span>)
            <a class="code" href="classNeighborCache.html#a8a01390ead6fc76dcc7d76e5e2253481">defaultQueryTypeQ</a> = <a class="code" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccba46557811e0915cca5028188f13edf357">NEIGHBORCACHE_QUERY</a>;
        <span class="keywordflow">else</span> <span class="keywordflow">throw</span> cRuntimeError((std::string(<span class="stringliteral">&quot;Wrong query type (Q): &quot;</span>)
        + temp).c_str());

        temp = par(<span class="stringliteral">&quot;ncsType&quot;</span>).stdstringValue();
        <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;none&quot;</span>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> = NULL;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;vivaldi&quot;</span>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> = <span class="keyword">new</span> <a class="code" href="classVivaldi.html">Vivaldi</a>();
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;svivaldi&quot;</span>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> = <span class="keyword">new</span> <a class="code" href="classSVivaldi.html">SVivaldi</a>();
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;gnp&quot;</span>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> = <span class="keyword">new</span> <a class="code" href="classNeighborCache.html#a936e38853be592103df5f12cd5d5924a">Nps</a>(); <span class="comment">//TODO</span>
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;nps&quot;</span>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> = <span class="keyword">new</span> <a class="code" href="classNeighborCache.html#a936e38853be592103df5f12cd5d5924a">Nps</a>();
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;simple&quot;</span>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> = <span class="keyword">new</span> <a class="code" href="classSimpleNcs.html">SimpleNcs</a>();
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp == <span class="stringliteral">&quot;simpleunderlayncs&quot;</span>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> = <span class="keyword">new</span> <a class="code" href="classNeighborCache.html#aede157b6cef68cd553f881605bae6687">SimpleUnderlayNCS</a>(); <span class="comment">//TODO</span>
        <span class="keywordflow">else</span> <span class="keywordflow">throw</span> cRuntimeError((std::string(<span class="stringliteral">&quot;Wrong NCS type: &quot;</span>)
        + temp).c_str());

        <span class="keywordflow">if</span> (par(<span class="stringliteral">&quot;doDiscovery&quot;</span>)) {
            <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aeff6d75027528c27a7424fafc0fd5ae0">collectClosestNodes</a> == 0) {
                <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Discovery Mode with collectClosestNodes = 0&quot;</span>);
            }
            <a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a> = <span class="keyword">new</span> <a class="code" href="classNeighborCache.html#a44f490d79205f6b037374da5cd72ba9a">DiscoveryMode</a>();
            <a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a>-&gt;<a class="code" href="classDiscoveryMode.html#a332eda4f6161c9c842a0b2cae3bff0ea">init</a>(<span class="keyword">this</span>);
            <a class="code" href="classNeighborCache.html#a4dab83c82964a5be2da87477aeb7f6f1">discoveryFinished</a> = <span class="keyword">false</span>;
        } <span class="keywordflow">else</span> {
            <a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a> = NULL;
        }
        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aeff6d75027528c27a7424fafc0fd5ae0">collectClosestNodes</a> &gt; 0) {
            <a class="code" href="classNeighborCache.html#ac8feda3e317250804eeb41b727b4456c">proxComparator</a> = <span class="keyword">new</span> <a class="code" href="classStdProxComparator.html">StdProxComparator</a>();
            <a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a> = <span class="keyword">new</span> <a class="code" href="NodeVector_8h.html#a4dd14fd4e10a709d35fafe4967a28a68">ProxAddressVector</a>(<a class="code" href="classNeighborCache.html#aeff6d75027528c27a7424fafc0fd5ae0">collectClosestNodes</a>, NULL,
                                                 <a class="code" href="classNeighborCache.html#ac8feda3e317250804eeb41b727b4456c">proxComparator</a>, NULL,
                                                 <a class="code" href="classNeighborCache.html#aeff6d75027528c27a7424fafc0fd5ae0">collectClosestNodes</a>, 0);
            WATCH_VECTOR(*<a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>);
        } <span class="keywordflow">else</span> {
            <a class="code" href="classNeighborCache.html#ac8feda3e317250804eeb41b727b4456c">proxComparator</a> = NULL;
            <a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a> = NULL;
        }


        <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a> = NULL;
        <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a> = NULL;

        <span class="keywordflow">if</span>(par(<span class="stringliteral">&quot;treeMgmtEnableTreeManagement&quot;</span>)) {
            <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a> = <span class="keyword">new</span> <a class="code" href="classNeighborCache.html#aa4eb45f96f21fd5aa25a058b3477139e">TreeManagement</a>();
            <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>-&gt;<a class="code" href="classTreeManagement.html#aeaefcafce57423835ea11edc0ee0c3b6">init</a>(<span class="keyword">this</span>);

            <span class="keywordflow">if</span>(par(<span class="stringliteral">&quot;gvbEnableGlobalViewBuilder&quot;</span>)) {
                <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a> = <span class="keyword">new</span> <a class="code" href="classNeighborCache.html#a3a28c1eff4d9ebfab15f049d8b665ecd">GlobalViewBuilder</a>();
                <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#abd89f32ef4f20291e1e06a6d0a58fb13" title=".cc">initializeViewBuilder</a>(<span class="keyword">this</span>, <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>);
                <a class="code" href="classNeighborCache.html#a3597f3dbce17346140258f34d17b4209">capReqFinished</a> = <span class="keyword">false</span>;
            }

            <a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>-&gt;<a class="code" href="classTreeManagement.html#a38a402c913d3f099131fb46984851746">addMsgClient</a>(<span class="stringliteral">&quot;ViewBuilder&quot;</span>, <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>);
        }


        <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a> = <a class="code" href="classGlobalStatisticsAccess.html" title="Gives access to the GlobalStatistics module.">GlobalStatisticsAccess</a>().<a class="code" href="classGlobalStatisticsAccess.html#ac00f1d00c91c814f250788d315bde4fe" title="returns the GlobalStatistics module">get</a>();
        <a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a> = <a class="code" href="classCoordBasedRoutingAccess.html" title="Gives access to the CoordBasedRouting.">CoordBasedRoutingAccess</a>().<a class="code" href="classCoordBasedRoutingAccess.html#a52ae7545ba854d93787e15fb4f4bf0a6">get</a>();

        <a class="code" href="classNeighborCache.html#a0a24e2ba7ad8f0328e4b4b829eae9e63">cbrTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;cbrTimer&quot;</span>);

        <a class="code" href="classNeighborCache.html#a54211a9fd7c6562ff15323e5b9863814">misses</a> = 0;
        <a class="code" href="classNeighborCache.html#a39da5066d1b99988174cc8546564600b">hits</a> = 0;

        <a class="code" href="classNeighborCache.html#a825fc8881da994d38c7574ecfc110f4d">rttHistory</a> = par(<span class="stringliteral">&quot;rttHistory&quot;</span>);
        <a class="code" href="classNeighborCache.html#a05ae665acfd7d6504d624d69a95428ef">timeoutAccuracyLimit</a> = par(<span class="stringliteral">&quot;timeoutAccuracyLimit&quot;</span>);

        <a class="code" href="classNeighborCache.html#a22a9c8f9d8054711dd9b4c972940fdcd">numMsg</a> = 0;
        <a class="code" href="classNeighborCache.html#a3a41df8495c9a6b70fc715e308a8ea2d">absoluteError</a> = 0.0;
        <a class="code" href="classNeighborCache.html#a2a635befdb541a1d491b23fe52616370">relativeError</a> = 0.0;
        <a class="code" href="classNeighborCache.html#a5de22621c8d7fa8bbe85e49d3b6b8927">numRttErrorToHigh</a> = 0;
        <a class="code" href="classNeighborCache.html#a86b66679e384f12f73bd4dbcc770f8e6">numRttErrorToLow</a> = 0;
        <a class="code" href="classNeighborCache.html#ad25610d40940fb6395a623bcb3b4a612">lastAbsoluteErrorPerNode</a>.clear();
        WATCH(<a class="code" href="classNeighborCache.html#a3a41df8495c9a6b70fc715e308a8ea2d">absoluteError</a>);
        WATCH(<a class="code" href="classNeighborCache.html#a2a635befdb541a1d491b23fe52616370">relativeError</a>);
        WATCH(<a class="code" href="classNeighborCache.html#a22a9c8f9d8054711dd9b4c972940fdcd">numMsg</a>);
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stage == <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532a57dc8beae2d53b30da5ebbb84b8eb94e" title="first stage for overlay application modules (Tier 1)">MIN_STAGE_TIER_1</a>) {
        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#ab7fa98f9830542958ad75f715abf2b61">init</a>(<span class="keyword">this</span>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a414a936f37e71490de6af0eda317fa83"></a><!-- doxytag: member="NeighborCache::insertNodeContext" ref="a414a936f37e71490de6af0eda317fa83" args="(const TransportAddress &amp;handle, cPolymorphic *context, ProxListener *rpcListener, int rpcId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool NeighborCache::insertNodeContext </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProxListener.html">ProxListener</a> *&#160;</td>
          <td class="paramname"><em>rpcListener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rpcId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00233">233</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (!<a class="code" href="classNeighborCache.html#a14ea96324f1a0c102dee609d89cff72a">enableNeighborCache</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(handle) == 0) {
        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[handle];

        entry.insertTime = simTime();
        entry.rttState = <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>;

        <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.insert(std::make_pair(entry.insertTime,
                                                     handle));

        <a class="code" href="classNeighborCache.html#acd2bd11282ed8d69d6291946a184b127">cleanupCache</a>();

        assert(<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size() == <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.size());
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    } <span class="keywordflow">else</span> {
        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[handle];

        <span class="comment">// waiting?</span>
        <span class="keywordflow">if</span> (entry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>) {
            WaitingContext temp(rpcListener, context, rpcId);
            entry.waitingContexts.push_back(temp);

            <span class="keywordflow">return</span> <span class="keyword">true</span>;
        } <span class="keywordflow">else</span> {
            <span class="keywordflow">if</span> (entry.waitingContexts.size() &gt; 0) {
                <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;not waiting for response,&quot;</span>
                        <span class="stringliteral">&quot; but additional contexts found!&quot;</span>);
            }

            <a class="code" href="classNeighborCache.html#a77a2ecd09d989f19bc2c0cf7e9f0e5b8">updateEntry</a>(handle, entry.insertTime);

            entry.rttState = <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">RTTSTATE_WAITING</a>;
            entry.insertTime = simTime();

            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2ce120e786b37cb5823d53f31ae82ff3"></a><!-- doxytag: member="NeighborCache::isEnabled" ref="a2ce120e786b37cb5823d53f31ae82ff3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool NeighborCache::isEnabled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00258">258</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="BasePastry_8cc_source.html#l00057">BasePastry::baseInit()</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classNeighborCache.html#a14ea96324f1a0c102dee609d89cff72a">enableNeighborCache</a>; };
</pre></div>
</div>
</div>
<a class="anchor" id="a416f18a5fea738589845fd630d6cf071"></a><!-- doxytag: member="NeighborCache::isEntry" ref="a416f18a5fea738589845fd630d6cf071" args="(const TransportAddress &amp;node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool NeighborCache::isEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00589">589</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01016">getCoordinateBasedProx()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01145">getNcsBasedTimeout()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l01118">getRttBasedTimeout()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(node) &gt; 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abfd044fbe032dede0011d4a7925c3949"></a><!-- doxytag: member="NeighborCache::piggybackOwnCoords" ref="abfd044fbe032dede0011d4a7925c3949" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool NeighborCache::piggybackOwnCoords </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00262">262</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="BaseRpc_8cc_source.html#l00532">BaseRpc::sendRpcResponse()</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> (<a class="code" href="classNeighborCache.html#a9921c0eaa97c6836b731327abe0f0829">ncsPiggybackOwnCoords</a> &amp;&amp; <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> != NULL); };
</pre></div>
</div>
</div>
<a class="anchor" id="ab3c80224821887880caf9192c4d83a8e"></a><!-- doxytag: member="NeighborCache::pingResponse" ref="ab3c80224821887880caf9192c4d83a8e" args="(PingResponse *response, cPolymorphic *context, int rpcId, simtime_t rtt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::pingResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPingResponse.html">PingResponse</a> *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rpcId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>rtt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classBaseRpc.html#afdf8ba10dc92ed3d351c8a7472c2093e">BaseRpc</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00836">836</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">                                                           {
    <span class="keywordflow">if</span>(<a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>) {
        <span class="comment">//treeManager-&gt;pingResponse(response, context, rpcId, rtt);</span>
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="aef4fca6b3c22482d4424f83d7656ddc1"></a><!-- doxytag: member="NeighborCache::pingTimeout" ref="aef4fca6b3c22482d4424f83d7656ddc1" args="(PingCall *call, const TransportAddress &amp;dest, cPolymorphic *context, int rpcId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::pingTimeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPingCall.html">PingCall</a> *&#160;</td>
          <td class="paramname"><em>call</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rpcId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classBaseRpc.html#afd90e156e9aa1dff7e4e99f50b2c9b51">BaseRpc</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00844">844</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">                                                                  {
    <span class="keywordflow">if</span>(<a class="code" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">treeManager</a>) {
        <span class="comment">//treeManager-&gt;pingTimeout(call, dest, context, rpcId);</span>
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0df75e09a10623f6ad9e45ee05f20938"></a><!-- doxytag: member="NeighborCache::prepareOverlay" ref="a0df75e09a10623f6ad9e45ee05f20938" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::prepareOverlay </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00705">705</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00209">Nps::coordsReqRpcResponse()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00658">handleReadyMessage()</a>, <a class="el" href="GlobalViewBuilder_8cc_source.html#l00160">GlobalViewBuilder::handleRpcResponse()</a>, and <a class="el" href="DiscoveryMode_8cc_source.html#l00066">DiscoveryMode::stop()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> ((!<a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a> || <a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a>-&gt;<a class="code" href="classDiscoveryMode.html#a4223226a7d7caca94c2e7b5a9f604097">isFinished</a>()) &amp;&amp;
        (!<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a> || <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#a77d0b11983f93cdc01a8ec95319be791">isCapReady</a>()) &amp;&amp;
        (!<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> || <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#a6b1e719e74653d4b8e7ee70a4862105f">isReady</a>())) {
        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> &amp;&amp; <a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>) {
            <span class="keywordflow">if</span> (!(<a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#aacff616bb863c37a7ef540b6f9b8228a">changeIdLater</a>() &amp;&amp; <a class="code" href="classBaseApp.html#a0587e13700e8641eec8143628dfd34cd" title="pointer to UnderlayConfigurator in this node">underlayConfigurator</a>-&gt;<a class="code" href="classUnderlayConfigurator.html#a00c2e85286a38799c7a04edb52ae6e76" title="still in initialization phase?">isInInitPhase</a>()) &amp;&amp;
                (!<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a> || <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#a5e5999c901d2785118175fbce25b4005">isCapValid</a>()) &amp;&amp;
                ((dynamic_cast&lt;Nps*&gt;(<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) || dynamic_cast&lt;SimpleNcs*&gt;(<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) ||
                 (dynamic_cast&lt;SVivaldi*&gt;(<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) &amp;&amp;
                  static_cast&lt;SVivaldi*&gt;(<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>)-&gt;getLoss() &gt; 0.95)))) { <span class="comment">//TODO</span>
                <a class="code" href="classNeighborCache.html#ab3b6bdb65927ffa2d71496c0351c54f2">setCbrNodeId</a>();
                <a class="code" href="classBaseApp.html#a3e030ef74292c6c2ffba4957d3275353">sendReadyMessage</a>(<span class="keyword">true</span>, <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>());
                <span class="keywordflow">return</span>;
            } <span class="keywordflow">else</span> {
                <a class="code" href="classBaseApp.html#a3e030ef74292c6c2ffba4957d3275353">sendReadyMessage</a>();
                <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#aacff616bb863c37a7ef540b6f9b8228a">changeIdLater</a>() &amp;&amp; <a class="code" href="classBaseApp.html#a0587e13700e8641eec8143628dfd34cd" title="pointer to UnderlayConfigurator in this node">underlayConfigurator</a>-&gt;<a class="code" href="classUnderlayConfigurator.html#a00c2e85286a38799c7a04edb52ae6e76" title="still in initialization phase?">isInInitPhase</a>()) {
                    scheduleAt(uniform(<a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#a1dc2fea0b8591bf97fcc34d6e4e2f46f">getChangeIdStart</a>(),
                                       <a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#a6dda44575b2598c3e28b2a7fe299a3f4">getChangeIdStop</a>()),
                                       <a class="code" href="classNeighborCache.html#a0a24e2ba7ad8f0328e4b4b829eae9e63">cbrTimer</a>); <span class="comment">//TODO</span>
                }
            }
        }
        <a class="code" href="classBaseApp.html#a3e030ef74292c6c2ffba4957d3275353">sendReadyMessage</a>();
        <span class="keywordflow">return</span>;
    }
    <span class="comment">//std::cout &lt;&lt; &quot;nc&quot; &lt;&lt; std::endl;</span>

    <span class="keywordflow">if</span> ((!<a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a> || <a class="code" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">discoveryMode</a>-&gt;<a class="code" href="classDiscoveryMode.html#a4223226a7d7caca94c2e7b5a9f604097">isFinished</a>()) &amp;&amp;
        (<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a> &amp;&amp; !<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#a77d0b11983f93cdc01a8ec95319be791">isCapReady</a>()) &amp;&amp;
        (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a> &amp;&amp; <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#a6b1e719e74653d4b8e7ee70a4862105f">isReady</a>())) {
        <span class="keyword">const</span> <a class="code" href="classTransportAddress.html" title="This class implements a common transport address.">TransportAddress</a>&amp; bootstrapNode =
            <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseOverlay.html#aab1198e37993729eaf87350d5b83f9a0">getBootstrapList</a>().<a class="code" href="classBootstrapList.html#ac351433be1d43bbf8cbb871e9f9e1f69" title="Get a bootstrap node from the bootstrap list.">getBootstrapNode</a>();
        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a> &amp;&amp; !bootstrapNode.<a class="code" href="classTransportAddress.html#a026e777c423ff2a0280edd2fa5472e74" title="indicates if TransportAddress is specified">isUnspecified</a>() &amp;&amp; <span class="keyword">true</span>) { <span class="comment">//TODO</span>
            <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#a7b729fbb8bd93471b8fbb0cf81eca4ef">sendCapRequest</a>(bootstrapNode);
            <span class="keywordflow">return</span>;
        }
        <span class="comment">// first node</span>
        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a> &amp;&amp; <a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#aacff616bb863c37a7ef540b6f9b8228a">changeIdLater</a>() &amp;&amp; <a class="code" href="classBaseApp.html#a0587e13700e8641eec8143628dfd34cd" title="pointer to UnderlayConfigurator in this node">underlayConfigurator</a>-&gt;<a class="code" href="classUnderlayConfigurator.html#a00c2e85286a38799c7a04edb52ae6e76" title="still in initialization phase?">isInInitPhase</a>()) {
            scheduleAt(uniform(<a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#a1dc2fea0b8591bf97fcc34d6e4e2f46f">getChangeIdStart</a>(),
                               <a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#a6dda44575b2598c3e28b2a7fe299a3f4">getChangeIdStop</a>()),
                               <a class="code" href="classNeighborCache.html#a0a24e2ba7ad8f0328e4b4b829eae9e63">cbrTimer</a>); <span class="comment">//TODO</span>
        }
        <a class="code" href="classBaseApp.html#a3e030ef74292c6c2ffba4957d3275353">sendReadyMessage</a>();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aab267d208202e7bf8dc1c7aecc66b550"></a><!-- doxytag: member="NeighborCache::queryProx" ref="aab267d208202e7bf8dc1c7aecc66b550" args="(const TransportAddress &amp;node, int rpcId, ProxListener *listener, cPolymorphic *contextPointer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::queryProx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rpcId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProxListener.html">ProxListener</a> *&#160;</td>
          <td class="paramname"><em>listener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&#160;</td>
          <td class="paramname"><em>contextPointer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends a pingNode call based on parameters from a getProx call. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>The node to which the pingNode call will be sent. </td></tr>
    <tr><td class="paramname">rpcId</td><td>The rpcId that was passed to getProx. </td></tr>
    <tr><td class="paramname">listener</td><td>The listener that was passed to getProx. </td></tr>
    <tr><td class="paramname">contextPointer</td><td>The pointer that was passed to getProx. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00991">991</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method(<span class="stringliteral">&quot;queryProx()&quot;</span>);

    WaitingContext temp(listener, contextPointer, rpcId);

    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(node) == 0) {
        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node];

        entry.waitingContexts.push_back(temp);
        <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.insert(std::make_pair(entry.insertTime, node));
        <a class="code" href="classNeighborCache.html#acd2bd11282ed8d69d6291946a184b127">cleanupCache</a>();
    } <span class="keywordflow">else</span> {
        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node];
        entry.waitingContexts.push_back(temp);
    }
    assert(<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size() == <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.size());

    <span class="comment">// TODO: this ping traffic is accounted application data traffic!</span>
    <a class="code" href="classBaseRpc.html#a421904b1b501580efed12e6490d3324a" title="ping a node by its TransportAddress">pingNode</a>(node, -1, 0, NULL, <span class="stringliteral">&quot;PING&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac08424d2bc22ec75e91b2da484d3075d"></a><!-- doxytag: member="NeighborCache::recordNcsEstimationError" ref="ac08424d2bc22ec75e91b2da484d3075d" args="(const NodeHandle &amp;handle, simtime_t rtt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::recordNcsEstimationError </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>rtt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l01036">1036</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (!<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) <span class="keywordflow">return</span>;

    <span class="comment">// Check if data collection can start</span>
    <span class="keywordflow">if</span> (!<a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#ac7fcc2200ed2da08e8f8b8b957c0c1dd">isMeasuring</a>()) <span class="keywordflow">return</span>;

    <a class="code" href="structProx.html">Prox</a> prox = <a class="code" href="classNeighborCache.html#ad9e7edece1f862fc607302542a62879b">getCoordinateBasedProx</a>(handle);
    <span class="keywordflow">if</span> (prox == <a class="code" href="structProx.html#aa7ac832a04fe61863222d8631526647b">Prox::PROX_UNKNOWN</a>) <span class="keywordflow">return</span>;

    <span class="comment">//calculate absolute rtt error of the last message</span>
    <span class="keywordtype">double</span> tempRttError = prox.<a class="code" href="structProx.html#aeb8eca3cac2c681c5e7f1060fcbd7b6f">proximity</a> - SIMTIME_DBL(rtt);

    <span class="comment">/*</span>
<span class="comment">    std::cout &lt;&lt; &quot;prox.proximity = &quot; &lt;&lt; prox.proximity</span>
<span class="comment">              &lt;&lt; &quot;, SIMTIME_DBL(rtt) = &quot; &lt;&lt; SIMTIME_DBL(rtt)</span>
<span class="comment">              &lt;&lt; &quot;, error = &quot; &lt;&lt; tempRttError</span>
<span class="comment">              &lt;&lt; &quot;, relativeError = &quot; &lt;&lt; (tempRttError / SIMTIME_DBL(rtt))</span>
<span class="comment">              &lt;&lt; std::endl;</span>
<span class="comment">     */</span>

    <span class="keywordflow">if</span> (tempRttError &lt; 0){
        tempRttError *= -1;
        ++<a class="code" href="classNeighborCache.html#a86b66679e384f12f73bd4dbcc770f8e6">numRttErrorToLow</a>;
    } <span class="keywordflow">else</span> ++<a class="code" href="classNeighborCache.html#a5de22621c8d7fa8bbe85e49d3b6b8927">numRttErrorToHigh</a>;

    <a class="code" href="classNeighborCache.html#a22a9c8f9d8054711dd9b4c972940fdcd">numMsg</a>++;
    <a class="code" href="classNeighborCache.html#a3a41df8495c9a6b70fc715e308a8ea2d">absoluteError</a> += tempRttError;
    <a class="code" href="classNeighborCache.html#a2a635befdb541a1d491b23fe52616370">relativeError</a> += (tempRttError / SIMTIME_DBL(rtt));

    <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#aa41614baf1d51fab0904abb41b642234" title="Record a value to a global cOutVector defined by name.">recordOutVector</a>(<span class="stringliteral">&quot;NCS: measured RTTs&quot;</span>,
                                      SIMTIME_DBL(rtt));
    <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#aa41614baf1d51fab0904abb41b642234" title="Record a value to a global cOutVector defined by name.">recordOutVector</a>(<span class="stringliteral">&quot;NCS: absolute Rtt Error&quot;</span>,
                                      tempRttError);
    <a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>-&gt;<a class="code" href="classGlobalStatistics.html#aa41614baf1d51fab0904abb41b642234" title="Record a value to a global cOutVector defined by name.">recordOutVector</a>(<span class="stringliteral">&quot;NCS: relative Rtt Error&quot;</span>,
                                      (tempRttError / SIMTIME_DBL(rtt)));
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab3b6bdb65927ffa2d71496c0351c54f2"></a><!-- doxytag: member="NeighborCache::setCbrNodeId" ref="ab3b6bdb65927ffa2d71496c0351c54f2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::setCbrNodeId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00753">753</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00780">handleTimerEvent()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00705">prepareOverlay()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> std::vector&lt;double&gt;&amp; coords = <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#afb2c12a5b86a18f15f7a47a95d8bfc4e">getOwnNcsInfo</a>().<a class="code" href="classAbstractNcsNodeInfo.html#abf74d96cce7b22eb017f382b2394936f">getCoords</a>();
    <span class="keyword">const</span> <a class="code" href="CoordBasedRouting_8h.html#ad91d7d67c95c2e1de279d6c2a96d241e">AP</a>* cap = (<a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a> ? <a class="code" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">globalViewBuilder</a>-&gt;<a class="code" href="classGlobalViewBuilder.html#a06688f06738200cfd819a21387cf1473">getCAP</a>() : NULL);
    <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#af3992f1fda9ea42dc10bf4739e47700a" title="saves given key to NodeHandle::key">setKey</a>(<a class="code" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#ad1d30e6d5378c12e3796a550e18563a0" title="returns a NodeID with given length and prefix according to coords&#39; area.">getNodeId</a>(coords,
                                                 <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseOverlay.html#afcab85a6c5a4f8aa70a65ecabaa78180">getBitsPerDigit</a>(),
                                                 <a class="code" href="classOverlayKey.html#af855a4dfc0e5dc0d2afc6b87fa1d7426" title="Returns the length in number of bits.">OverlayKey::getLength</a>(),
                                                 cap));

    EV &lt;&lt; <span class="stringliteral">&quot;[NeighborCache::setCbrNodeId() @ &quot;</span>
            &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
            &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]&quot;</span>
            &lt;&lt; <span class="stringliteral">&quot;\n    -&gt; nodeID ( 2): &quot;</span>
            &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(2)
            &lt;&lt; <span class="stringliteral">&quot;\n    -&gt; nodeID (16): &quot;</span>
            &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; endl;
    <span class="comment">/*</span>
<span class="comment">    std::cout &lt;&lt; &quot;[NeighborCache::setCbrNodeId() @ &quot;</span>
<span class="comment">              &lt;&lt; thisNode.getIp()</span>
<span class="comment">              &lt;&lt; &quot; (&quot; &lt;&lt; thisNode.getKey().toString(16) &lt;&lt; &quot;)]&quot;</span>
<span class="comment">              &lt;&lt; &quot;\n    -&gt; nodeID ( 2): &quot;</span>
<span class="comment">              &lt;&lt; thisNode.getKey().toString(2)</span>
<span class="comment">              &lt;&lt; &quot;\n    -&gt; nodeID (16): &quot;</span>
<span class="comment">              &lt;&lt; thisNode.getKey().toString(16) &lt;&lt; std::endl;*/</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a93099fadb692a42cbe4c0757f28cf0c3"></a><!-- doxytag: member="NeighborCache::setNodeTimeout" ref="a93099fadb692a42cbe4c0757f28cf0c3" args="(const TransportAddress &amp;handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::setNodeTimeout </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00289">289</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="BaseRpc_8cc_source.html#l00293">BaseRpc::internalHandleRpcMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//if (!enableNeighborCache) return;</span>

    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(handle) == 0) {
        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[handle];

        entry.insertTime = simTime();
        entry.rttState = <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">RTTSTATE_TIMEOUT</a>;

        <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.insert(std::make_pair(entry.insertTime,
                                                     handle));
        <a class="code" href="classNeighborCache.html#acd2bd11282ed8d69d6291946a184b127">cleanupCache</a>();
    } <span class="keywordflow">else</span> {
        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[handle];

        <a class="code" href="classNeighborCache.html#a77a2ecd09d989f19bc2c0cf7e9f0e5b8">updateEntry</a>(handle, entry.insertTime);

        entry.insertTime = simTime();
        entry.rttState = <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">RTTSTATE_TIMEOUT</a>;

        <a class="code" href="classNeighborCache.html#aa690fa08dd5460980e15bae581ef04d4">WaitingContexts</a> waitingContexts = <a class="code" href="classNeighborCache.html#a2dae7f2c34de3d5ce4e9032f0b00c07b">getNodeContexts</a>(handle);

        <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; waitingContexts.size(); ++i) {
            assert(waitingContexts[i].proxListener || !waitingContexts[i].proxContext);
            <span class="keywordflow">if</span> (waitingContexts[i].proxListener) {
                waitingContexts[i].proxListener-&gt;proxCallback(handle,
                                                              waitingContexts[i].<span class="keywordtype">id</span>,
                                                              waitingContexts[i].proxContext,
                                                              <a class="code" href="structProx.html#a5ded765f6344797ea0e9c35c85cd61af">Prox::PROX_TIMEOUT</a>);
            }
        }
    }
    assert(<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size() == <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.size());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a77a2ecd09d989f19bc2c0cf7e9f0e5b8"></a><!-- doxytag: member="NeighborCache::updateEntry" ref="a77a2ecd09d989f19bc2c0cf7e9f0e5b8" args="(const TransportAddress &amp;address, simtime_t insertTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::updateEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>insertTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00524">524</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00233">insertNodeContext()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00289">setNodeTimeout()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00421">updateNcsInfo()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classNeighborCache.html#a7f7da64944cfeee91fcecb1d5fb23dd9">neighborCacheExpireMapIterator</a> it =
            <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.lower_bound(insertTime);
    <span class="keywordflow">while</span> (it-&gt;second != address) ++it;
    <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.erase(it);
    <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.insert(std::make_pair(simTime(),
                                                 address));
    assert(<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size() == <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.size());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8b5247ae66c36e40addd51db3aa33a3c"></a><!-- doxytag: member="NeighborCache::updateNcsInfo" ref="a8b5247ae66c36e40addd51db3aa33a3c" args="(const TransportAddress &amp;node, AbstractNcsNodeInfo *ncsInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::updateNcsInfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> *&#160;</td>
          <td class="paramname"><em>ncsInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00421">421</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method_Silent();

    EV &lt;&lt; <span class="stringliteral">&quot;[NeighborCache::updateNcsInfo() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
               &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
               &lt;&lt; <span class="stringliteral">&quot;    inserting new NcsInfo of node &quot;</span> &lt;&lt; node.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
               &lt;&lt; endl;

    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(node) == 0) {
        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node];

        entry.insertTime = simTime();
        entry.coordsInfo = ncsInfo;

        <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.insert(std::make_pair(entry.insertTime, node));

        <a class="code" href="classNeighborCache.html#acd2bd11282ed8d69d6291946a184b127">cleanupCache</a>();
    } <span class="keywordflow">else</span> {
        <a class="code" href="classNeighborCache.html#a77a2ecd09d989f19bc2c0cf7e9f0e5b8">updateEntry</a>(node, <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node].insertTime);

        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[node];

        <span class="keywordflow">if</span> (ncsInfo) {
            <span class="keywordflow">if</span> (entry.coordsInfo) {
                entry.coordsInfo-&gt;update(*ncsInfo);
                <span class="keyword">delete</span> ncsInfo;
            } <span class="keywordflow">else</span> {
                entry.coordsInfo = ncsInfo;
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a057e94a37705dfab0ab1f91417603450"></a><!-- doxytag: member="NeighborCache::updateNode" ref="a057e94a37705dfab0ab1f91417603450" args="(const NodeHandle &amp;add, simtime_t rtt, const NodeHandle &amp;srcRoute=NodeHandle::UNSPECIFIED_NODE, AbstractNcsNodeInfo *ncsInfo=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NeighborCache::updateNode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&#160;</td>
          <td class="paramname"><em>rtt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&#160;</td>
          <td class="paramname"><em>srcRoute</em> = <code><a class="el" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6">NodeHandle::UNSPECIFIED_NODE</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> *&#160;</td>
          <td class="paramname"><em>ncsInfo</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00326">326</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00209">Nps::coordsReqRpcResponse()</a>, and <a class="el" href="BaseRpc_8cc_source.html#l00293">BaseRpc::internalHandleRpcMessage()</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method_Silent();

    <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a> = <a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseRpc.html#ac3f420630d5618e81709c078b06fd9da" title="Returns the NodeHandle of this node.">getThisNode</a>(); <span class="comment">// Daniel TODO</span>

    EV &lt;&lt; <span class="stringliteral">&quot;[NeighborCache::updateNode() @ &quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
       &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n&quot;</span>
       &lt;&lt; <span class="stringliteral">&quot;    inserting rtt(&quot;</span> &lt;&lt; SIMTIME_DBL(rtt) &lt;&lt; <span class="stringliteral">&quot;) of node &quot;</span> &lt;&lt; add.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
       &lt;&lt; endl;

    <span class="keywordflow">if</span> (rtt &lt;= 0) {
        <span class="keyword">delete</span> ncsInfo;
        <span class="keywordflow">return</span>; <span class="comment">//TODO broose</span>
    }

    <span class="keywordtype">bool</span> deleteInfo = <span class="keyword">false</span>;

    <span class="comment">//if (enableNeighborCache) {</span>
    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.count(add) == 0) {

        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[add];

        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>) {
            <span class="comment">//std::cout &lt;&lt; &quot;closestNodes-&gt;add(ProxTransportAddress(&quot; &lt;&lt; add &lt;&lt; &quot;, rtt));&quot; &lt;&lt; std::endl;</span>
            <a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>-&gt;<a class="code" href="classBaseKeySortedVector.html#afbcdfbd9680a475cceb48ccc841140cd" title="adds an element of type T in increasing order to the NodeVector and returns the position of the added...">add</a>(<a class="code" href="classProxTransportAddress.html">ProxTransportAddress</a>(add, rtt));
        }

        entry.insertTime = simTime();
        entry.rtt = rtt;
        entry.rttState = <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a>;
        entry.nodeRef = add;
        entry.coordsInfo = ncsInfo;
        entry.lastRtts.push_back(rtt);

        <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.insert(std::make_pair(entry.insertTime, add));

        <a class="code" href="classNeighborCache.html#acd2bd11282ed8d69d6291946a184b127">cleanupCache</a>();
    } <span class="keywordflow">else</span> {

        <a class="code" href="classNeighborCache.html#a77a2ecd09d989f19bc2c0cf7e9f0e5b8">updateEntry</a>(add, <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[add].insertTime);

        NeighborCacheEntry&amp; entry = <a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>[add];

        <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>) {
            <span class="comment">//std::cout &lt;&lt; &quot;closestNodes-&gt;add(ProxTransportAddress(&quot; &lt;&lt; add &lt;&lt; &quot;, rtt));&quot; &lt;&lt; std::endl;</span>
            <a class="code" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">closestNodes</a>-&gt;<a class="code" href="classBaseKeySortedVector.html#afbcdfbd9680a475cceb48ccc841140cd" title="adds an element of type T in increasing order to the NodeVector and returns the position of the added...">add</a>(<a class="code" href="classProxTransportAddress.html">ProxTransportAddress</a>(add, rtt));
        }

        entry.insertTime = simTime();
        <span class="keywordflow">if</span> (entry.rttState != <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a> || entry.rtt &gt; rtt)
            entry.rtt = rtt;
        entry.rttState = <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">RTTSTATE_VALID</a>;
        entry.nodeRef = add;

        entry.lastRtts.push_back(rtt);
        <span class="keywordflow">if</span> (entry.lastRtts.size()  &gt; <a class="code" href="classNeighborCache.html#a825fc8881da994d38c7574ecfc110f4d">rttHistory</a>) {
            entry.lastRtts.pop_front();
        }

        <span class="keywordflow">if</span> (ncsInfo) {
            <span class="keywordflow">if</span> (entry.coordsInfo) {
                entry.coordsInfo-&gt;update(*ncsInfo);
                deleteInfo = <span class="keyword">true</span>;
            } <span class="keywordflow">else</span> {
                entry.coordsInfo = ncsInfo;
            }
        }

        <a class="code" href="classNeighborCache.html#aa690fa08dd5460980e15bae581ef04d4">WaitingContexts</a> waitingContexts = <a class="code" href="classNeighborCache.html#a2dae7f2c34de3d5ce4e9032f0b00c07b">getNodeContexts</a>(add);

        <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; waitingContexts.size(); ++i) {
            <span class="keywordflow">if</span> (waitingContexts[i].proxListener) {
                waitingContexts[i].proxListener
                -&gt;proxCallback(add,
                               waitingContexts[i].<span class="keywordtype">id</span>,
                               waitingContexts[i].proxContext,
                               <a class="code" href="structProx.html">Prox</a>(rtt, 1));
            }
        }
    }
    assert(<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" title="pointer to the neighbor cache">neighborCache</a>.size() == <a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.size());

    <a class="code" href="classNeighborCache.html#ac08424d2bc22ec75e91b2da484d3075d">recordNcsEstimationError</a>(add, rtt);


    <span class="keywordflow">if</span> (<a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>) <a class="code" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">ncs</a>-&gt;<a class="code" href="classAbstractNcs.html#aa967cf8c9d1c8ef4ab4c8f269256ea61">processCoordinates</a>(rtt, *ncsInfo);

    <span class="comment">// delete ncsInfo if old info is used</span>
    <span class="keywordflow">if</span> (deleteInfo) <span class="keyword">delete</span> ncsInfo;
}
</pre></div>
</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="a44f490d79205f6b037374da5cd72ba9a"></a><!-- doxytag: member="NeighborCache::DiscoveryMode" ref="a44f490d79205f6b037374da5cd72ba9a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classDiscoveryMode.html">DiscoveryMode</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00084">84</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a3a28c1eff4d9ebfab15f049d8b665ecd"></a><!-- doxytag: member="NeighborCache::GlobalViewBuilder" ref="a3a28c1eff4d9ebfab15f049d8b665ecd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classGlobalViewBuilder.html">GlobalViewBuilder</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00083">83</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a936e38853be592103df5f12cd5d5924a"></a><!-- doxytag: member="NeighborCache::Nps" ref="a936e38853be592103df5f12cd5d5924a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classNps.html">Nps</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00080">80</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="ac08e4d48d12d21383076ed55ae3959a3"></a><!-- doxytag: member="NeighborCache::operator&lt;&lt;" ref="ac08e4d48d12d21383076ed55ae3959a3" args="(std::ostream &amp;os, const NeighborCacheEntry &amp;entry)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a> &amp;&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8cc_source.html#l00045">45</a> of file <a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (entry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99ad335b9827dedaf0b54e8f8f85a9ed56f">NeighborCache::RTTSTATE_VALID</a>) {
        os &lt;&lt; entry.rtt;
    } <span class="keywordflow">else</span> {
        <span class="keywordflow">if</span> (entry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99add78d4f762a1db85d7609729b2a5267c">NeighborCache::RTTSTATE_TIMEOUT</a>) os &lt;&lt; <span class="stringliteral">&quot;TIMEOUT&quot;</span>;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (entry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a9bcd0d18a9801aa587532affb6374eea">NeighborCache::RTTSTATE_UNKNOWN</a>) os &lt;&lt; <span class="stringliteral">&quot;UNKNOWN&quot;</span>;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (entry.rttState == <a class="code" href="classNeighborCache.html#aefe728f567b9040c8c01c8bbf93d9c99a8a3460a12b4cd0b4d6d89d58fffc3ac0">NeighborCache::RTTSTATE_WAITING</a>) os &lt;&lt; <span class="stringliteral">&quot;WAITING&quot;</span>;
    }
    os &lt;&lt; <span class="stringliteral">&quot; (inserted: &quot;</span> &lt;&lt; entry.insertTime;

    os &lt;&lt; <span class="stringliteral">&quot;, #contexts: &quot;</span>
            &lt;&lt; entry.waitingContexts.size();

    <span class="keywordflow">if</span> (!entry.nodeRef.isUnspecified()) os &lt;&lt;  <span class="stringliteral">&quot;, &lt;KEY&gt;&quot;</span>;


    <span class="comment">//TODO entry.coordsInfo</span>

    os &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;

    <span class="keywordflow">return</span> os;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aede157b6cef68cd553f881605bae6687"></a><!-- doxytag: member="NeighborCache::SimpleUnderlayNCS" ref="aede157b6cef68cd553f881605bae6687" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classSimpleUnderlayNCS.html">SimpleUnderlayNCS</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00081">81</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="aa4eb45f96f21fd5aa25a058b3477139e"></a><!-- doxytag: member="NeighborCache::TreeManagement" ref="aa4eb45f96f21fd5aa25a058b3477139e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classTreeManagement.html">TreeManagement</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00082">82</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a3a41df8495c9a6b70fc715e308a8ea2d"></a><!-- doxytag: member="NeighborCache::absoluteError" ref="a3a41df8495c9a6b70fc715e308a8ea2d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classNeighborCache.html#a3a41df8495c9a6b70fc715e308a8ea2d">NeighborCache::absoluteError</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00132">132</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l01036">recordNcsEstimationError()</a>.</p>

</div>
</div>
<a class="anchor" id="a3597f3dbce17346140258f34d17b4209"></a><!-- doxytag: member="NeighborCache::capReqFinished" ref="a3597f3dbce17346140258f34d17b4209" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classNeighborCache.html#a3597f3dbce17346140258f34d17b4209">NeighborCache::capReqFinished</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00106">106</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a0a24e2ba7ad8f0328e4b4b829eae9e63"></a><!-- doxytag: member="NeighborCache::cbrTimer" ref="a0a24e2ba7ad8f0328e4b4b829eae9e63" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classNeighborCache.html#a0a24e2ba7ad8f0328e4b4b829eae9e63">NeighborCache::cbrTimer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00124">124</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00780">handleTimerEvent()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00705">prepareOverlay()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00222">~NeighborCache()</a>.</p>

</div>
</div>
<a class="anchor" id="a5102f8173d859bf7431989d46e75395a"></a><!-- doxytag: member="NeighborCache::closestNodes" ref="a5102f8173d859bf7431989d46e75395a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NodeVector_8h.html#a4dd14fd4e10a709d35fafe4967a28a68">ProxAddressVector</a>* <a class="el" href="classNeighborCache.html#a5102f8173d859bf7431989d46e75395a">NeighborCache::closestNodes</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00219">219</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01172">getBootstrapNode()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00558">getClosestNodes()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00222">~NeighborCache()</a>.</p>

</div>
</div>
<a class="anchor" id="aeff6d75027528c27a7424fafc0fd5ae0"></a><!-- doxytag: member="NeighborCache::collectClosestNodes" ref="aeff6d75027528c27a7424fafc0fd5ae0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="classNeighborCache.html#aeff6d75027528c27a7424fafc0fd5ae0">NeighborCache::collectClosestNodes</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00090">90</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a7cc33529f354fc9c21f5cbebf4cbdfc2"></a><!-- doxytag: member="NeighborCache::coordBasedRouting" ref="a7cc33529f354fc9c21f5cbebf4cbdfc2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoordBasedRouting.html">CoordBasedRouting</a>* <a class="el" href="classNeighborCache.html#a7cc33529f354fc9c21f5cbebf4cbdfc2">NeighborCache::coordBasedRouting</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00115">115</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00705">prepareOverlay()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00753">setCbrNodeId()</a>.</p>

</div>
</div>
<a class="anchor" id="a306e1f0b6cdea15e32762ce421d1734a"></a><!-- doxytag: member="NeighborCache::coordsDummy" ref="a306e1f0b6cdea15e32762ce421d1734a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; double &gt; <a class="el" href="classNeighborCache.html#a306e1f0b6cdea15e32762ce421d1734a">NeighborCache::coordsDummy</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00126">126</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a11a4145a2f976de746ffb5eb80b8720e"></a><!-- doxytag: member="NeighborCache::defaultQueryType" ref="a11a4145a2f976de746ffb5eb80b8720e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccb">NeighborCacheQueryType</a> <a class="el" href="classNeighborCache.html#a11a4145a2f976de746ffb5eb80b8720e">NeighborCache::defaultQueryType</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00117">117</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a88e4d57df1eece811a04c75c2eb61c00"></a><!-- doxytag: member="NeighborCache::defaultQueryTypeI" ref="a88e4d57df1eece811a04c75c2eb61c00" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccb">NeighborCacheQueryType</a> <a class="el" href="classNeighborCache.html#a88e4d57df1eece811a04c75c2eb61c00">NeighborCache::defaultQueryTypeI</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00118">118</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a8a01390ead6fc76dcc7d76e5e2253481"></a><!-- doxytag: member="NeighborCache::defaultQueryTypeQ" ref="a8a01390ead6fc76dcc7d76e5e2253481" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NeighborCache_8h.html#ada3b7deab861ead8c817d583da336ccb">NeighborCacheQueryType</a> <a class="el" href="classNeighborCache.html#a8a01390ead6fc76dcc7d76e5e2253481">NeighborCache::defaultQueryTypeQ</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00119">119</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a4dab83c82964a5be2da87477aeb7f6f1"></a><!-- doxytag: member="NeighborCache::discoveryFinished" ref="a4dab83c82964a5be2da87477aeb7f6f1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classNeighborCache.html#a4dab83c82964a5be2da87477aeb7f6f1">NeighborCache::discoveryFinished</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00093">93</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a13751f12b261fdf63d0a44cd42cb4836"></a><!-- doxytag: member="NeighborCache::discoveryMode" ref="a13751f12b261fdf63d0a44cd42cb4836" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDiscoveryMode.html">DiscoveryMode</a>* <a class="el" href="classNeighborCache.html#a13751f12b261fdf63d0a44cd42cb4836">NeighborCache::discoveryMode</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00114">114</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00658">handleReadyMessage()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00814">handleRpcCall()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00705">prepareOverlay()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00222">~NeighborCache()</a>.</p>

</div>
</div>
<a class="anchor" id="a14ea96324f1a0c102dee609d89cff72a"></a><!-- doxytag: member="NeighborCache::enableNeighborCache" ref="a14ea96324f1a0c102dee609d89cff72a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classNeighborCache.html#a14ea96324f1a0c102dee609d89cff72a">NeighborCache::enableNeighborCache</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00088">88</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00457">getNodeRtt()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00853">getProx()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00233">insertNodeContext()</a>, and <a class="el" href="NeighborCache_8h_source.html#l00258">isEnabled()</a>.</p>

</div>
</div>
<a class="anchor" id="a0ffa19a84d406ad8de4b86148a5879ad"></a><!-- doxytag: member="NeighborCache::globalStatistics" ref="a0ffa19a84d406ad8de4b86148a5879ad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGlobalStatistics.html">GlobalStatistics</a>* <a class="el" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad">NeighborCache::globalStatistics</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>pointer to <a class="el" href="classGlobalStatistics.html" title="Module to record global statistics.">GlobalStatistics</a> module in this node </p>

<p>Reimplemented from <a class="el" href="classBaseApp.html#a70bdab2d4ea3553205115f057194f692">BaseApp</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00186">186</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00209">Nps::coordsReqRpcResponse()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00728">TreeManagement::finishTreeManagement()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00097">TreeManagement::handleRpcCall()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00114">TreeManagement::handleRpcResponse()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01036">recordNcsEstimationError()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00423">TreeManagement::registerAtParent()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00272">TreeManagement::sendChildReleaseCall()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00662">TreeManagement::sendMessageToChildren()</a>, <a class="el" href="TreeManagement_8cc_source.html#l00634">TreeManagement::sendMessageToParent()</a>, <a class="el" href="GlobalViewBuilder_8cc_source.html#l00289">GlobalViewBuilder::spreadGlobalView()</a>, and <a class="el" href="DiscoveryMode_8cc_source.html#l00066">DiscoveryMode::stop()</a>.</p>

</div>
</div>
<a class="anchor" id="ac5f48962709290d0d62ebfe2b94da14a"></a><!-- doxytag: member="NeighborCache::globalViewBuilder" ref="ac5f48962709290d0d62ebfe2b94da14a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGlobalViewBuilder.html">GlobalViewBuilder</a>* <a class="el" href="classNeighborCache.html#ac5f48962709290d0d62ebfe2b94da14a">NeighborCache::globalViewBuilder</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00105">105</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00658">handleReadyMessage()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00814">handleRpcCall()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00780">handleTimerEvent()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00705">prepareOverlay()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00753">setCbrNodeId()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00222">~NeighborCache()</a>.</p>

</div>
</div>
<a class="anchor" id="a39da5066d1b99988174cc8546564600b"></a><!-- doxytag: member="NeighborCache::hits" ref="a39da5066d1b99988174cc8546564600b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classNeighborCache.html#a39da5066d1b99988174cc8546564600b">NeighborCache::hits</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00096">96</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00457">getNodeRtt()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a850be66fd299373b7843c92378b4d54a"></a><!-- doxytag: member="NeighborCache::landmarkTimer" ref="a850be66fd299373b7843c92378b4d54a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classNeighborCache.html#a850be66fd299373b7843c92378b4d54a">NeighborCache::landmarkTimer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00123">123</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad25610d40940fb6395a623bcb3b4a612"></a><!-- doxytag: member="NeighborCache::lastAbsoluteErrorPerNode" ref="ad25610d40940fb6395a623bcb3b4a612" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classTransportAddress.html">TransportAddress</a>, std::vector&lt;double&gt; &gt; <a class="el" href="classNeighborCache.html#ad25610d40940fb6395a623bcb3b4a612">NeighborCache::lastAbsoluteErrorPerNode</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00130">130</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="aacdd8a0ee2a9e893e21caf58cceb8576"></a><!-- doxytag: member="NeighborCache::maxSize" ref="aacdd8a0ee2a9e893e21caf58cceb8576" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classNeighborCache.html#aacdd8a0ee2a9e893e21caf58cceb8576">NeighborCache::maxSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00092">92</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00501">cleanupCache()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a54211a9fd7c6562ff15323e5b9863814"></a><!-- doxytag: member="NeighborCache::misses" ref="a54211a9fd7c6562ff15323e5b9863814" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classNeighborCache.html#a54211a9fd7c6562ff15323e5b9863814">NeighborCache::misses</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00095">95</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00457">getNodeRtt()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="aea802dc1c5065f1abd3756079f47fce3"></a><!-- doxytag: member="NeighborCache::ncs" ref="aea802dc1c5065f1abd3756079f47fce3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAbstractNcs.html">AbstractNcs</a>* <a class="el" href="classNeighborCache.html#aea802dc1c5065f1abd3756079f47fce3">NeighborCache::ncs</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00103">103</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00976">estimateProx()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00597">getAvgAbsPredictionError()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01016">getCoordinateBasedProx()</a>, <a class="el" href="NeighborCache_8h_source.html#l00264">getNcsAccess()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01109">getNodeTimeout()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00814">handleRpcCall()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00780">handleTimerEvent()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8h_source.html#l00262">piggybackOwnCoords()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00705">prepareOverlay()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01036">recordNcsEstimationError()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00753">setCbrNodeId()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00222">~NeighborCache()</a>.</p>

</div>
</div>
<a class="anchor" id="ab645ed14a47c403b86243192fcbfa27c"></a><!-- doxytag: member="NeighborCache::NCS_TIMEOUT_CONSTANT" ref="ab645ed14a47c403b86243192fcbfa27c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double <a class="el" href="classNeighborCache.html#ab645ed14a47c403b86243192fcbfa27c">NeighborCache::NCS_TIMEOUT_CONSTANT</a> = 0.350<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00180">180</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01145">getNcsBasedTimeout()</a>.</p>

</div>
</div>
<a class="anchor" id="a9921c0eaa97c6836b731327abe0f0829"></a><!-- doxytag: member="NeighborCache::ncsPiggybackOwnCoords" ref="a9921c0eaa97c6836b731327abe0f0829" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classNeighborCache.html#a9921c0eaa97c6836b731327abe0f0829">NeighborCache::ncsPiggybackOwnCoords</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00108">108</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, and <a class="el" href="NeighborCache_8h_source.html#l00262">piggybackOwnCoords()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f9e10ff6b8ac2ecb0f8126f77a8ad4d"></a><!-- doxytag: member="NeighborCache::neighborCache" ref="a6f9e10ff6b8ac2ecb0f8126f77a8ad4d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UNORDERED_MAP&lt;<a class="el" href="classTransportAddress.html">TransportAddress</a>, <a class="el" href="structNeighborCache_1_1NeighborCacheEntry.html">NeighborCacheEntry</a>&gt; <a class="el" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d">NeighborCache::neighborCache</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>pointer to the neighbor cache </p>

<p>Reimplemented from <a class="el" href="classBaseRpc.html#ad80237130dc2316d0d76ac6757c50f4f">BaseRpc</a>.</p>

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00212">212</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00501">cleanupCache()</a>, <a class="el" href="Nps_8cc_source.html#l00209">Nps::coordsReqRpcResponse()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00976">estimateProx()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00597">getAvgAbsPredictionError()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01172">getBootstrapNode()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01076">getMeanVarRtt()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00537">getNearestNode()</a>, <a class="el" href="NeighborCache_8h_source.html#l00271">getNeighborCacheSize()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00492">getNodeAge()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00278">getNodeContexts()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01026">getNodeCoordsInfo()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00483">getNodeHandle()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00457">getNodeRtt()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00570">getSpreadedNodes()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00233">insertNodeContext()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00589">isEntry()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00991">queryProx()</a>, <a class="el" href="Nps_8cc_source.html#l00378">Nps::setLandmarkSet()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00289">setNodeTimeout()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00524">updateEntry()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00421">updateNcsInfo()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>.</p>

</div>
</div>
<a class="anchor" id="a13fe4a3a70c426257244008e5e1fd0f9"></a><!-- doxytag: member="NeighborCache::neighborCacheExpireMap" ref="a13fe4a3a70c426257244008e5e1fd0f9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::multimap&lt;simtime_t, <a class="el" href="classTransportAddress.html">TransportAddress</a>&gt; <a class="el" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">NeighborCache::neighborCacheExpireMap</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00216">216</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00501">cleanupCache()</a>, <a class="el" href="Nps_8cc_source.html#l00209">Nps::coordsReqRpcResponse()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00597">getAvgAbsPredictionError()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00233">insertNodeContext()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00991">queryProx()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00289">setNodeTimeout()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00524">updateEntry()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00421">updateNcsInfo()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>.</p>

</div>
</div>
<a class="anchor" id="a22a9c8f9d8054711dd9b4c972940fdcd"></a><!-- doxytag: member="NeighborCache::numMsg" ref="a22a9c8f9d8054711dd9b4c972940fdcd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classNeighborCache.html#a22a9c8f9d8054711dd9b4c972940fdcd">NeighborCache::numMsg</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00131">131</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l01036">recordNcsEstimationError()</a>.</p>

</div>
</div>
<a class="anchor" id="a5de22621c8d7fa8bbe85e49d3b6b8927"></a><!-- doxytag: member="NeighborCache::numRttErrorToHigh" ref="a5de22621c8d7fa8bbe85e49d3b6b8927" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classNeighborCache.html#a5de22621c8d7fa8bbe85e49d3b6b8927">NeighborCache::numRttErrorToHigh</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00134">134</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l01036">recordNcsEstimationError()</a>.</p>

</div>
</div>
<a class="anchor" id="a86b66679e384f12f73bd4dbcc770f8e6"></a><!-- doxytag: member="NeighborCache::numRttErrorToLow" ref="a86b66679e384f12f73bd4dbcc770f8e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classNeighborCache.html#a86b66679e384f12f73bd4dbcc770f8e6">NeighborCache::numRttErrorToLow</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00135">135</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l01036">recordNcsEstimationError()</a>.</p>

</div>
</div>
<a class="anchor" id="ac8feda3e317250804eeb41b727b4456c"></a><!-- doxytag: member="NeighborCache::proxComparator" ref="ac8feda3e317250804eeb41b727b4456c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStdProxComparator.html">StdProxComparator</a>* <a class="el" href="classNeighborCache.html#ac8feda3e317250804eeb41b727b4456c">NeighborCache::proxComparator</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00112">112</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00222">~NeighborCache()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a635befdb541a1d491b23fe52616370"></a><!-- doxytag: member="NeighborCache::relativeError" ref="a2a635befdb541a1d491b23fe52616370" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classNeighborCache.html#a2a635befdb541a1d491b23fe52616370">NeighborCache::relativeError</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00133">133</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l01036">recordNcsEstimationError()</a>.</p>

</div>
</div>
<a class="anchor" id="abf8f22a91e7e5bb6095df851e586858f"></a><!-- doxytag: member="NeighborCache::RTT_TIMEOUT_ADJUSTMENT" ref="abf8f22a91e7e5bb6095df851e586858f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double <a class="el" href="classNeighborCache.html#abf8f22a91e7e5bb6095df851e586858f">NeighborCache::RTT_TIMEOUT_ADJUSTMENT</a> = 1.3<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00179">179</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01118">getRttBasedTimeout()</a>.</p>

</div>
</div>
<a class="anchor" id="ab3ba13a3310b16ef691ee52eac897c72"></a><!-- doxytag: member="NeighborCache::rttExpirationTime" ref="ab3ba13a3310b16ef691ee52eac897c72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="classNeighborCache.html#ab3ba13a3310b16ef691ee52eac897c72">NeighborCache::rttExpirationTime</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00091">91</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00457">getNodeRtt()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="a825fc8881da994d38c7574ecfc110f4d"></a><!-- doxytag: member="NeighborCache::rttHistory" ref="a825fc8881da994d38c7574ecfc110f4d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classNeighborCache.html#a825fc8881da994d38c7574ecfc110f4d">NeighborCache::rttHistory</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00136">136</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00326">updateNode()</a>.</p>

</div>
</div>
<a class="anchor" id="a05ae665acfd7d6504d624d69a95428ef"></a><!-- doxytag: member="NeighborCache::timeoutAccuracyLimit" ref="a05ae665acfd7d6504d624d69a95428ef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classNeighborCache.html#a05ae665acfd7d6504d624d69a95428ef">NeighborCache::timeoutAccuracyLimit</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00137">137</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01145">getNcsBasedTimeout()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<a class="anchor" id="ae33c98df5571a15f537ea51fd9298a6d"></a><!-- doxytag: member="NeighborCache::treeManager" ref="ae33c98df5571a15f537ea51fd9298a6d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTreeManagement.html">TreeManagement</a>* <a class="el" href="classNeighborCache.html#ae33c98df5571a15f537ea51fd9298a6d">NeighborCache::treeManager</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00104">104</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l00194">finishApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l01167">getTreeManager()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00658">handleReadyMessage()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00814">handleRpcCall()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00780">handleTimerEvent()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00836">pingResponse()</a>, <a class="el" href="NeighborCache_8cc_source.html#l00844">pingTimeout()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00222">~NeighborCache()</a>.</p>

</div>
</div>
<a class="anchor" id="a35eddfa8e8b64ba9cdbe138f8067d07f"></a><!-- doxytag: member="NeighborCache::useNcsForTimeout" ref="a35eddfa8e8b64ba9cdbe138f8067d07f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classNeighborCache.html#a35eddfa8e8b64ba9cdbe138f8067d07f">NeighborCache::useNcsForTimeout</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NeighborCache_8h_source.html#l00110">110</a> of file <a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a>.</p>

<p>Referenced by <a class="el" href="NeighborCache_8cc_source.html#l01109">getNodeTimeout()</a>, and <a class="el" href="NeighborCache_8cc_source.html#l00073">initializeApp()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="NeighborCache_8h_source.html">NeighborCache.h</a></li>
<li><a class="el" href="NeighborCache_8cc_source.html">NeighborCache.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="classNeighborCache.html">NeighborCache</a>      </li>

    <li class="footer">Generated on Thu Mar 6 2014 14:06:53 for OverSim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
