<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OverSim: CSHA1 Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OverSim
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classCSHA1.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">CSHA1 Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="CSHA1" -->
<p><code>#include &lt;<a class="el" href="SHA1_8h_source.html">SHA1.h</a>&gt;</code></p>

<p><a href="classCSHA1-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7c">REPORT_TYPE</a> { <a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7ca6482f900c0505a51b7710486c00cc6a6">REPORT_HEX</a> =  0, 
<a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7cabe75c003144cc1f83fe2e77cb3179430">REPORT_DIGIT</a> =  1, 
<a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7ca23c7854236daebd38834b1baa0d0fc83">REPORT_HEX_SHORT</a> =  2
 }</td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#abf4b9e3a6ea653ca7aabbb076a7f3645">CSHA1</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a6677358e95741a25565165310c6cb0d7">~CSHA1</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a2473fd69604fc762000247867830c2a0">Reset</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a59536022ba64be584aed79c28f78d84c">Update</a> (const UINT_8 *pbData, UINT_32 uLen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#afa6e97d87a9e5fbafd9f00f5267c85db">HashFile</a> (const TCHAR *tszFileName)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#afbdaab3f2a2946d26a6144af3fec5fd8">Final</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a290089ec3f38863940c4757ebbdf4d6e">ReportHash</a> (TCHAR *tszReport, <a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7c">REPORT_TYPE</a> rtReportType=REPORT_HEX) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a31e5e1164c484945fb1f7dce969787e4">ReportHashStl</a> (std::basic_string&lt; TCHAR &gt; &amp;strOut, <a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7c">REPORT_TYPE</a> rtReportType=REPORT_HEX) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a736d60c74d29c605c5e62b3095ab7405">GetHash</a> (UINT_8 *pbDest20) const </td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#ab0f18a56653c27b0b5d91ebd7d561504">Transform</a> (UINT_32 *pState, const UINT_8 *pBuffer)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">UINT_32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a> [5]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">UINT_32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a> [2]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">UINT_32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a430cd7f3396057b8a74ddf09dc031681">m_reserved0</a> [1]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">UINT_8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a183aa7e77f79d3f14cfb91075a65fdc4">m_buffer</a> [64]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">UINT_8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a356dd315e89f1c5042084d7d3d8ac51f">m_digest</a> [20]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">UINT_32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a4aa07d3976aa188656803081ce7ca326">m_reserved1</a> [3]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">UINT_8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#a10499b68005c1e537339c9c78021b85e">m_workspace</a> [64]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="unionSHA1__WORKSPACE__BLOCK.html">SHA1_WORKSPACE_BLOCK</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSHA1.html#aea8f8f3d927719faabcbcd2025dab34f">m_block</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00221">221</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>
</div><hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="a7134dc8e588c0ccd2ec799cde26d9d7c"></a><!-- doxytag: member="CSHA1::REPORT_TYPE" ref="a7134dc8e588c0ccd2ec799cde26d9d7c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7c">CSHA1::REPORT_TYPE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a7134dc8e588c0ccd2ec799cde26d9d7ca6482f900c0505a51b7710486c00cc6a6"></a><!-- doxytag: member="REPORT_HEX" ref="a7134dc8e588c0ccd2ec799cde26d9d7ca6482f900c0505a51b7710486c00cc6a6" args="" -->REPORT_HEX</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a7134dc8e588c0ccd2ec799cde26d9d7cabe75c003144cc1f83fe2e77cb3179430"></a><!-- doxytag: member="REPORT_DIGIT" ref="a7134dc8e588c0ccd2ec799cde26d9d7cabe75c003144cc1f83fe2e77cb3179430" args="" -->REPORT_DIGIT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a7134dc8e588c0ccd2ec799cde26d9d7ca23c7854236daebd38834b1baa0d0fc83"></a><!-- doxytag: member="REPORT_HEX_SHORT" ref="a7134dc8e588c0ccd2ec799cde26d9d7ca23c7854236daebd38834b1baa0d0fc83" args="" -->REPORT_HEX_SHORT</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00226">226</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>
<div class="fragment"><pre class="fragment">        {
                <a class="code" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7ca6482f900c0505a51b7710486c00cc6a6">REPORT_HEX</a> = 0,
                <a class="code" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7cabe75c003144cc1f83fe2e77cb3179430">REPORT_DIGIT</a> = 1,
                <a class="code" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7ca23c7854236daebd38834b1baa0d0fc83">REPORT_HEX_SHORT</a> = 2
        };
</pre></div>
</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="abf4b9e3a6ea653ca7aabbb076a7f3645"></a><!-- doxytag: member="CSHA1::CSHA1" ref="abf4b9e3a6ea653ca7aabbb076a7f3645" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CSHA1::CSHA1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00046">46</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
        <a class="code" href="classCSHA1.html#aea8f8f3d927719faabcbcd2025dab34f">m_block</a> = (<a class="code" href="unionSHA1__WORKSPACE__BLOCK.html">SHA1_WORKSPACE_BLOCK</a>*)<a class="code" href="classCSHA1.html#a10499b68005c1e537339c9c78021b85e">m_workspace</a>;

        <a class="code" href="classCSHA1.html#a2473fd69604fc762000247867830c2a0">Reset</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6677358e95741a25565165310c6cb0d7"></a><!-- doxytag: member="CSHA1::~CSHA1" ref="a6677358e95741a25565165310c6cb0d7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CSHA1::~CSHA1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00054">54</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
        <a class="code" href="classCSHA1.html#a2473fd69604fc762000247867830c2a0">Reset</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="afbdaab3f2a2946d26a6144af3fec5fd8"></a><!-- doxytag: member="CSHA1::Final" ref="afbdaab3f2a2946d26a6144af3fec5fd8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSHA1::Final </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00173">173</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>

<p>Referenced by <a class="el" href="I3Identifier_8cc_source.html#l00129">I3Identifier::createFromHash()</a>, <a class="el" href="SimpleNcs_8cc_source.html#l00102">SimpleNcs::falsifyDelay()</a>, <a class="el" href="SimpleNodeEntry_8cc_source.html#l00224">SimpleNodeEntry::getFaultyDelay()</a>, <a class="el" href="DHT_8cc_source.html#l00417">DHT::handleGetRequest()</a>, and <a class="el" href="OverlayKey_8cc_source.html#l00651">OverlayKey::sha1()</a>.</p>
<div class="fragment"><pre class="fragment">{
        <a class="code" href="SHA1_8h.html#af5a2be58a28390f9a494538f34054637">UINT_32</a> i;

        <a class="code" href="SHA1_8h.html#aecffebc452f5b7100c06c3e132297ac4">UINT_8</a> pbFinalCount[8];
        <span class="keywordflow">for</span>(i = 0; i &lt; 8; ++i)
                pbFinalCount[i] = static_cast&lt;UINT_8&gt;((<a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>[((i &gt;= 4) ? 0 : 1)] &gt;&gt;
                        ((3 - (i &amp; 3)) * 8) ) &amp; 0xFF); <span class="comment">// Endian independent</span>

        <a class="code" href="classCSHA1.html#a59536022ba64be584aed79c28f78d84c">Update</a>((<a class="code" href="SHA1_8h.html#aecffebc452f5b7100c06c3e132297ac4">UINT_8</a>*)<span class="stringliteral">&quot;\200&quot;</span>, 1);

        <span class="keywordflow">while</span>((<a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>[0] &amp; 504) != 448)
                <a class="code" href="classCSHA1.html#a59536022ba64be584aed79c28f78d84c">Update</a>((<a class="code" href="SHA1_8h.html#aecffebc452f5b7100c06c3e132297ac4">UINT_8</a>*)<span class="stringliteral">&quot;\0&quot;</span>, 1);

        <a class="code" href="classCSHA1.html#a59536022ba64be584aed79c28f78d84c">Update</a>(pbFinalCount, 8); <span class="comment">// Cause a Transform()</span>

        <span class="keywordflow">for</span>(i = 0; i &lt; 20; ++i)
                <a class="code" href="classCSHA1.html#a356dd315e89f1c5042084d7d3d8ac51f">m_digest</a>[i] = static_cast&lt;UINT_8&gt;((<a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>[i &gt;&gt; 2] &gt;&gt; ((3 -
                        (i &amp; 3)) * 8)) &amp; 0xFF);

        <span class="comment">// Wipe variables for security reasons</span>
<span class="preprocessor">#ifdef SHA1_WIPE_VARIABLES</span>
<span class="preprocessor"></span>        memset(<a class="code" href="classCSHA1.html#a183aa7e77f79d3f14cfb91075a65fdc4">m_buffer</a>, 0, 64);
        memset(<a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>, 0, 20);
        memset(<a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>, 0, 8);
        memset(pbFinalCount, 0, 8);
        <a class="code" href="classCSHA1.html#ab0f18a56653c27b0b5d91ebd7d561504">Transform</a>(<a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>, <a class="code" href="classCSHA1.html#a183aa7e77f79d3f14cfb91075a65fdc4">m_buffer</a>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a736d60c74d29c605c5e62b3095ab7405"></a><!-- doxytag: member="CSHA1::GetHash" ref="a736d60c74d29c605c5e62b3095ab7405" args="(UINT_8 *pbDest20) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CSHA1::GetHash </td>
          <td>(</td>
          <td class="paramtype">UINT_8 *&#160;</td>
          <td class="paramname"><em>pbDest20</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00249">249</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>

<p>Referenced by <a class="el" href="I3Identifier_8cc_source.html#l00129">I3Identifier::createFromHash()</a>, <a class="el" href="SimpleNcs_8cc_source.html#l00102">SimpleNcs::falsifyDelay()</a>, <a class="el" href="SimpleNodeEntry_8cc_source.html#l00224">SimpleNodeEntry::getFaultyDelay()</a>, <a class="el" href="DHT_8cc_source.html#l00417">DHT::handleGetRequest()</a>, and <a class="el" href="OverlayKey_8cc_source.html#l00651">OverlayKey::sha1()</a>.</p>
<div class="fragment"><pre class="fragment">{
        <span class="keywordflow">if</span>(pbDest20 == NULL) <span class="keywordflow">return</span> <span class="keyword">false</span>;
        memcpy(pbDest20, <a class="code" href="classCSHA1.html#a356dd315e89f1c5042084d7d3d8ac51f">m_digest</a>, 20);
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afa6e97d87a9e5fbafd9f00f5267c85db"></a><!-- doxytag: member="CSHA1::HashFile" ref="afa6e97d87a9e5fbafd9f00f5267c85db" args="(const TCHAR *tszFileName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CSHA1::HashFile </td>
          <td>(</td>
          <td class="paramtype">const TCHAR *&#160;</td>
          <td class="paramname"><em>tszFileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00142">142</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
        <span class="keywordflow">if</span>(tszFileName == NULL) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        FILE* fpIn = <a class="code" href="SHA1_8h.html#a65d483a46d24b40308cab4b44d147d7f">_tfopen</a>(tszFileName, <a class="code" href="SHA1_8h.html#a4c71513b8c8c9769f63b5a1ce9434513">_T</a>(<span class="stringliteral">&quot;rb&quot;</span>));
        <span class="keywordflow">if</span>(fpIn == NULL) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <a class="code" href="SHA1_8h.html#aecffebc452f5b7100c06c3e132297ac4">UINT_8</a>* pbData = <span class="keyword">new</span> <a class="code" href="SHA1_8h.html#aecffebc452f5b7100c06c3e132297ac4">UINT_8</a>[<a class="code" href="SHA1_8cc.html#a877b9c89432081a8887c4001167f39d3">SHA1_MAX_FILE_BUFFER</a>];
        <span class="keywordflow">if</span>(pbData == NULL) { fclose(fpIn); <span class="keywordflow">return</span> <span class="keyword">false</span>; }

        <span class="keywordtype">bool</span> bSuccess = <span class="keyword">true</span>;
        <span class="keywordflow">while</span>(<span class="keyword">true</span>)
        {
                <span class="keyword">const</span> <span class="keywordtype">size_t</span> uRead = fread(pbData, 1, <a class="code" href="SHA1_8cc.html#a877b9c89432081a8887c4001167f39d3">SHA1_MAX_FILE_BUFFER</a>, fpIn);

                <span class="keywordflow">if</span>(uRead &gt; 0)
                        <a class="code" href="classCSHA1.html#a59536022ba64be584aed79c28f78d84c">Update</a>(pbData, static_cast&lt;UINT_32&gt;(uRead));

                <span class="keywordflow">if</span>(uRead &lt; <a class="code" href="SHA1_8cc.html#a877b9c89432081a8887c4001167f39d3">SHA1_MAX_FILE_BUFFER</a>)
                {
                        <span class="keywordflow">if</span>(feof(fpIn) == 0) bSuccess = <span class="keyword">false</span>;
                        <span class="keywordflow">break</span>;
                }
        }

        fclose(fpIn);
        <span class="keyword">delete</span>[] pbData;
        <span class="keywordflow">return</span> bSuccess;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a290089ec3f38863940c4757ebbdf4d6e"></a><!-- doxytag: member="CSHA1::ReportHash" ref="a290089ec3f38863940c4757ebbdf4d6e" args="(TCHAR *tszReport, REPORT_TYPE rtReportType=REPORT_HEX) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CSHA1::ReportHash </td>
          <td>(</td>
          <td class="paramtype">TCHAR *&#160;</td>
          <td class="paramname"><em>tszReport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7c">REPORT_TYPE</a>&#160;</td>
          <td class="paramname"><em>rtReportType</em> = <code>REPORT_HEX</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00204">204</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>

<p>Referenced by <a class="el" href="SHA1_8cc_source.html#l00240">ReportHashStl()</a>.</p>
<div class="fragment"><pre class="fragment">{
        <span class="keywordflow">if</span>(tszReport == NULL) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <a class="code" href="SHA1_8h.html#a65c91f8d7af3c67b8a21e089fdddd0fe">TCHAR</a> tszTemp[16];

        <span class="keywordflow">if</span>((rtReportType == <a class="code" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7ca6482f900c0505a51b7710486c00cc6a6">REPORT_HEX</a>) || (rtReportType == <a class="code" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7ca23c7854236daebd38834b1baa0d0fc83">REPORT_HEX_SHORT</a>))
        {
                <a class="code" href="SHA1_8h.html#aad0cc0637768c5eda50cb458f023066a">_sntprintf</a>(tszTemp, 15, <a class="code" href="SHA1_8h.html#a4c71513b8c8c9769f63b5a1ce9434513">_T</a>(<span class="stringliteral">&quot;%02X&quot;</span>), <a class="code" href="classCSHA1.html#a356dd315e89f1c5042084d7d3d8ac51f">m_digest</a>[0]);
                <a class="code" href="SHA1_8h.html#a181225a46a4d86ddcbcd23bfc0982dee">_tcscpy</a>(tszReport, tszTemp);

                <span class="keyword">const</span> <a class="code" href="SHA1_8h.html#a65c91f8d7af3c67b8a21e089fdddd0fe">TCHAR</a>* lpFmt = ((rtReportType == <a class="code" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7ca6482f900c0505a51b7710486c00cc6a6">REPORT_HEX</a>) ? <a class="code" href="SHA1_8h.html#a4c71513b8c8c9769f63b5a1ce9434513">_T</a>(<span class="stringliteral">&quot; %02X&quot;</span>) : <a class="code" href="SHA1_8h.html#a4c71513b8c8c9769f63b5a1ce9434513">_T</a>(<span class="stringliteral">&quot;%02X&quot;</span>));
                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 1; i &lt; 20; ++i)
                {
                        <a class="code" href="SHA1_8h.html#aad0cc0637768c5eda50cb458f023066a">_sntprintf</a>(tszTemp, 15, lpFmt, <a class="code" href="classCSHA1.html#a356dd315e89f1c5042084d7d3d8ac51f">m_digest</a>[i]);
                        <a class="code" href="SHA1_8h.html#a170b7aaa68da11593c3cb97699ca7500">_tcscat</a>(tszReport, tszTemp);
                }
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(rtReportType == <a class="code" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7cabe75c003144cc1f83fe2e77cb3179430">REPORT_DIGIT</a>)
        {
                <a class="code" href="SHA1_8h.html#aad0cc0637768c5eda50cb458f023066a">_sntprintf</a>(tszTemp, 15, <a class="code" href="SHA1_8h.html#a4c71513b8c8c9769f63b5a1ce9434513">_T</a>(<span class="stringliteral">&quot;%u&quot;</span>), <a class="code" href="classCSHA1.html#a356dd315e89f1c5042084d7d3d8ac51f">m_digest</a>[0]);
                <a class="code" href="SHA1_8h.html#a181225a46a4d86ddcbcd23bfc0982dee">_tcscpy</a>(tszReport, tszTemp);

                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 1; i &lt; 20; ++i)
                {
                        <a class="code" href="SHA1_8h.html#aad0cc0637768c5eda50cb458f023066a">_sntprintf</a>(tszTemp, 15, <a class="code" href="SHA1_8h.html#a4c71513b8c8c9769f63b5a1ce9434513">_T</a>(<span class="stringliteral">&quot; %u&quot;</span>), <a class="code" href="classCSHA1.html#a356dd315e89f1c5042084d7d3d8ac51f">m_digest</a>[i]);
                        <a class="code" href="SHA1_8h.html#a170b7aaa68da11593c3cb97699ca7500">_tcscat</a>(tszReport, tszTemp);
                }
        }
        <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a31e5e1164c484945fb1f7dce969787e4"></a><!-- doxytag: member="CSHA1::ReportHashStl" ref="a31e5e1164c484945fb1f7dce969787e4" args="(std::basic_string&lt; TCHAR &gt; &amp;strOut, REPORT_TYPE rtReportType=REPORT_HEX) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CSHA1::ReportHashStl </td>
          <td>(</td>
          <td class="paramtype">std::basic_string&lt; TCHAR &gt; &amp;&#160;</td>
          <td class="paramname"><em>strOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCSHA1.html#a7134dc8e588c0ccd2ec799cde26d9d7c">REPORT_TYPE</a>&#160;</td>
          <td class="paramname"><em>rtReportType</em> = <code>REPORT_HEX</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00240">240</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
        <a class="code" href="SHA1_8h.html#a65c91f8d7af3c67b8a21e089fdddd0fe">TCHAR</a> tszOut[84];
        <span class="keyword">const</span> <span class="keywordtype">bool</span> bResult = <a class="code" href="classCSHA1.html#a290089ec3f38863940c4757ebbdf4d6e">ReportHash</a>(tszOut, rtReportType);
        <span class="keywordflow">if</span>(bResult) strOut = tszOut;
        <span class="keywordflow">return</span> bResult;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2473fd69604fc762000247867830c2a0"></a><!-- doxytag: member="CSHA1::Reset" ref="a2473fd69604fc762000247867830c2a0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSHA1::Reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00060">60</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>

<p>Referenced by <a class="el" href="I3Identifier_8cc_source.html#l00129">I3Identifier::createFromHash()</a>, <a class="el" href="SHA1_8cc_source.html#l00046">CSHA1()</a>, <a class="el" href="SimpleNcs_8cc_source.html#l00102">SimpleNcs::falsifyDelay()</a>, <a class="el" href="SimpleNodeEntry_8cc_source.html#l00224">SimpleNodeEntry::getFaultyDelay()</a>, <a class="el" href="DHT_8cc_source.html#l00417">DHT::handleGetRequest()</a>, <a class="el" href="OverlayKey_8cc_source.html#l00651">OverlayKey::sha1()</a>, and <a class="el" href="SHA1_8cc_source.html#l00054">~CSHA1()</a>.</p>
<div class="fragment"><pre class="fragment">{
        <span class="comment">// SHA1 initialization constants</span>
        <a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>[0] = 0x67452301;
        <a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>[1] = 0xEFCDAB89;
        <a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>[2] = 0x98BADCFE;
        <a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>[3] = 0x10325476;
        <a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>[4] = 0xC3D2E1F0;

        <a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>[0] = 0;
        <a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>[1] = 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab0f18a56653c27b0b5d91ebd7d561504"></a><!-- doxytag: member="CSHA1::Transform" ref="ab0f18a56653c27b0b5d91ebd7d561504" args="(UINT_32 *pState, const UINT_8 *pBuffer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSHA1::Transform </td>
          <td>(</td>
          <td class="paramtype">UINT_32 *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const UINT_8 *&#160;</td>
          <td class="paramname"><em>pBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00073">73</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>

<p>Referenced by <a class="el" href="SHA1_8cc_source.html#l00173">Final()</a>, and <a class="el" href="SHA1_8cc_source.html#l00114">Update()</a>.</p>
<div class="fragment"><pre class="fragment">{
        <a class="code" href="SHA1_8h.html#af5a2be58a28390f9a494538f34054637">UINT_32</a> a = pState[0], b = pState[1], c = pState[2], d = pState[3], e = pState[4];

        memcpy(<a class="code" href="classCSHA1.html#aea8f8f3d927719faabcbcd2025dab34f">m_block</a>, pBuffer, 64);

        <span class="comment">// 4 rounds of 20 operations each, loop unrolled</span>
        <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(a,b,c,d,e, 0); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(e,a,b,c,d, 1); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(d,e,a,b,c, 2); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(c,d,e,a,b, 3);
        <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(b,c,d,e,a, 4); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(a,b,c,d,e, 5); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(e,a,b,c,d, 6); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(d,e,a,b,c, 7);
        <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(c,d,e,a,b, 8); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(b,c,d,e,a, 9); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(a,b,c,d,e,10); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(e,a,b,c,d,11);
        <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(d,e,a,b,c,12); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(c,d,e,a,b,13); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(b,c,d,e,a,14); <a class="code" href="SHA1_8cc.html#adec6ba398444beadbaecaa4f397b225c">S_R0</a>(a,b,c,d,e,15);
        <a class="code" href="SHA1_8cc.html#a44173215bbd5ed534369ca4392c74ef7">S_R1</a>(e,a,b,c,d,16); <a class="code" href="SHA1_8cc.html#a44173215bbd5ed534369ca4392c74ef7">S_R1</a>(d,e,a,b,c,17); <a class="code" href="SHA1_8cc.html#a44173215bbd5ed534369ca4392c74ef7">S_R1</a>(c,d,e,a,b,18); <a class="code" href="SHA1_8cc.html#a44173215bbd5ed534369ca4392c74ef7">S_R1</a>(b,c,d,e,a,19);
        <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(a,b,c,d,e,20); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(e,a,b,c,d,21); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(d,e,a,b,c,22); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(c,d,e,a,b,23);
        <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(b,c,d,e,a,24); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(a,b,c,d,e,25); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(e,a,b,c,d,26); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(d,e,a,b,c,27);
        <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(c,d,e,a,b,28); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(b,c,d,e,a,29); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(a,b,c,d,e,30); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(e,a,b,c,d,31);
        <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(d,e,a,b,c,32); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(c,d,e,a,b,33); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(b,c,d,e,a,34); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(a,b,c,d,e,35);
        <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(e,a,b,c,d,36); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(d,e,a,b,c,37); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(c,d,e,a,b,38); <a class="code" href="SHA1_8cc.html#a6d417639f54aa9cad31d8bfa1dee575a">S_R2</a>(b,c,d,e,a,39);
        <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(a,b,c,d,e,40); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(e,a,b,c,d,41); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(d,e,a,b,c,42); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(c,d,e,a,b,43);
        <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(b,c,d,e,a,44); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(a,b,c,d,e,45); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(e,a,b,c,d,46); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(d,e,a,b,c,47);
        <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(c,d,e,a,b,48); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(b,c,d,e,a,49); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(a,b,c,d,e,50); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(e,a,b,c,d,51);
        <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(d,e,a,b,c,52); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(c,d,e,a,b,53); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(b,c,d,e,a,54); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(a,b,c,d,e,55);
        <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(e,a,b,c,d,56); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(d,e,a,b,c,57); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(c,d,e,a,b,58); <a class="code" href="SHA1_8cc.html#afb83af0990eb773698f2ccf3a3dcf013">S_R3</a>(b,c,d,e,a,59);
        <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(a,b,c,d,e,60); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(e,a,b,c,d,61); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(d,e,a,b,c,62); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(c,d,e,a,b,63);
        <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(b,c,d,e,a,64); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(a,b,c,d,e,65); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(e,a,b,c,d,66); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(d,e,a,b,c,67);
        <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(c,d,e,a,b,68); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(b,c,d,e,a,69); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(a,b,c,d,e,70); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(e,a,b,c,d,71);
        <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(d,e,a,b,c,72); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(c,d,e,a,b,73); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(b,c,d,e,a,74); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(a,b,c,d,e,75);
        <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(e,a,b,c,d,76); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(d,e,a,b,c,77); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(c,d,e,a,b,78); <a class="code" href="SHA1_8cc.html#a261228645c08398fdf507a55a9f5e209">S_R4</a>(b,c,d,e,a,79);

        <span class="comment">// Add the working vars back into state</span>
        pState[0] += a;
        pState[1] += b;
        pState[2] += c;
        pState[3] += d;
        pState[4] += e;

        <span class="comment">// Wipe variables</span>
<span class="preprocessor">#ifdef SHA1_WIPE_VARIABLES</span>
<span class="preprocessor"></span>        a = b = c = d = e = 0;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a59536022ba64be584aed79c28f78d84c"></a><!-- doxytag: member="CSHA1::Update" ref="a59536022ba64be584aed79c28f78d84c" args="(const UINT_8 *pbData, UINT_32 uLen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CSHA1::Update </td>
          <td>(</td>
          <td class="paramtype">const UINT_8 *&#160;</td>
          <td class="paramname"><em>pbData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT_32&#160;</td>
          <td class="paramname"><em>uLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8cc_source.html#l00114">114</a> of file <a class="el" href="SHA1_8cc_source.html">SHA1.cc</a>.</p>

<p>Referenced by <a class="el" href="I3Identifier_8cc_source.html#l00129">I3Identifier::createFromHash()</a>, <a class="el" href="SimpleNcs_8cc_source.html#l00102">SimpleNcs::falsifyDelay()</a>, <a class="el" href="SHA1_8cc_source.html#l00173">Final()</a>, <a class="el" href="SimpleNodeEntry_8cc_source.html#l00224">SimpleNodeEntry::getFaultyDelay()</a>, <a class="el" href="DHT_8cc_source.html#l00417">DHT::handleGetRequest()</a>, <a class="el" href="SHA1_8cc_source.html#l00142">HashFile()</a>, and <a class="el" href="OverlayKey_8cc_source.html#l00651">OverlayKey::sha1()</a>.</p>
<div class="fragment"><pre class="fragment">{
        <a class="code" href="SHA1_8h.html#af5a2be58a28390f9a494538f34054637">UINT_32</a> j = ((<a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>[0] &gt;&gt; 3) &amp; 0x3F);

        <span class="keywordflow">if</span>((<a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>[0] += (uLen &lt;&lt; 3)) &lt; (uLen &lt;&lt; 3))
                ++<a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>[1]; <span class="comment">// Overflow</span>

        <a class="code" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">m_count</a>[1] += (uLen &gt;&gt; 29);

        <a class="code" href="SHA1_8h.html#af5a2be58a28390f9a494538f34054637">UINT_32</a> i;
        <span class="keywordflow">if</span>((j + uLen) &gt; 63)
        {
                i = 64 - j;
                memcpy(&amp;<a class="code" href="classCSHA1.html#a183aa7e77f79d3f14cfb91075a65fdc4">m_buffer</a>[j], pbData, i);
                <a class="code" href="classCSHA1.html#ab0f18a56653c27b0b5d91ebd7d561504">Transform</a>(<a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>, <a class="code" href="classCSHA1.html#a183aa7e77f79d3f14cfb91075a65fdc4">m_buffer</a>);

                <span class="keywordflow">for</span>( ; (i + 63) &lt; uLen; i += 64)
                        <a class="code" href="classCSHA1.html#ab0f18a56653c27b0b5d91ebd7d561504">Transform</a>(<a class="code" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">m_state</a>, &amp;pbData[i]);

                j = 0;
        }
        <span class="keywordflow">else</span> i = 0;

        <span class="keywordflow">if</span>((uLen - i) != 0)
                memcpy(&amp;<a class="code" href="classCSHA1.html#a183aa7e77f79d3f14cfb91075a65fdc4">m_buffer</a>[j], &amp;pbData[i], uLen - i);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aea8f8f3d927719faabcbcd2025dab34f"></a><!-- doxytag: member="CSHA1::m_block" ref="aea8f8f3d927719faabcbcd2025dab34f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="unionSHA1__WORKSPACE__BLOCK.html">SHA1_WORKSPACE_BLOCK</a>* <a class="el" href="classCSHA1.html#aea8f8f3d927719faabcbcd2025dab34f">CSHA1::m_block</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00279">279</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>

<p>Referenced by <a class="el" href="SHA1_8cc_source.html#l00046">CSHA1()</a>, and <a class="el" href="SHA1_8cc_source.html#l00073">Transform()</a>.</p>

</div>
</div>
<a class="anchor" id="a183aa7e77f79d3f14cfb91075a65fdc4"></a><!-- doxytag: member="CSHA1::m_buffer" ref="a183aa7e77f79d3f14cfb91075a65fdc4" args="[64]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT_8 <a class="el" href="classCSHA1.html#a183aa7e77f79d3f14cfb91075a65fdc4">CSHA1::m_buffer</a>[64]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00274">274</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>

<p>Referenced by <a class="el" href="SHA1_8cc_source.html#l00173">Final()</a>, and <a class="el" href="SHA1_8cc_source.html#l00114">Update()</a>.</p>

</div>
</div>
<a class="anchor" id="a55cfe3aebc945ec575e4b6b9669a7fb2"></a><!-- doxytag: member="CSHA1::m_count" ref="a55cfe3aebc945ec575e4b6b9669a7fb2" args="[2]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT_32 <a class="el" href="classCSHA1.html#a55cfe3aebc945ec575e4b6b9669a7fb2">CSHA1::m_count</a>[2]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00272">272</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>

<p>Referenced by <a class="el" href="SHA1_8cc_source.html#l00173">Final()</a>, <a class="el" href="SHA1_8cc_source.html#l00060">Reset()</a>, and <a class="el" href="SHA1_8cc_source.html#l00114">Update()</a>.</p>

</div>
</div>
<a class="anchor" id="a356dd315e89f1c5042084d7d3d8ac51f"></a><!-- doxytag: member="CSHA1::m_digest" ref="a356dd315e89f1c5042084d7d3d8ac51f" args="[20]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT_8 <a class="el" href="classCSHA1.html#a356dd315e89f1c5042084d7d3d8ac51f">CSHA1::m_digest</a>[20]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00275">275</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>

<p>Referenced by <a class="el" href="SHA1_8cc_source.html#l00173">Final()</a>, <a class="el" href="SHA1_8cc_source.html#l00249">GetHash()</a>, and <a class="el" href="SHA1_8cc_source.html#l00204">ReportHash()</a>.</p>

</div>
</div>
<a class="anchor" id="a430cd7f3396057b8a74ddf09dc031681"></a><!-- doxytag: member="CSHA1::m_reserved0" ref="a430cd7f3396057b8a74ddf09dc031681" args="[1]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT_32 <a class="el" href="classCSHA1.html#a430cd7f3396057b8a74ddf09dc031681">CSHA1::m_reserved0</a>[1]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00273">273</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4aa07d3976aa188656803081ce7ca326"></a><!-- doxytag: member="CSHA1::m_reserved1" ref="a4aa07d3976aa188656803081ce7ca326" args="[3]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT_32 <a class="el" href="classCSHA1.html#a4aa07d3976aa188656803081ce7ca326">CSHA1::m_reserved1</a>[3]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00276">276</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2c79d5db23dfc1cb883480b1ab458a0d"></a><!-- doxytag: member="CSHA1::m_state" ref="a2c79d5db23dfc1cb883480b1ab458a0d" args="[5]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT_32 <a class="el" href="classCSHA1.html#a2c79d5db23dfc1cb883480b1ab458a0d">CSHA1::m_state</a>[5]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00271">271</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>

<p>Referenced by <a class="el" href="SHA1_8cc_source.html#l00173">Final()</a>, <a class="el" href="SHA1_8cc_source.html#l00060">Reset()</a>, and <a class="el" href="SHA1_8cc_source.html#l00114">Update()</a>.</p>

</div>
</div>
<a class="anchor" id="a10499b68005c1e537339c9c78021b85e"></a><!-- doxytag: member="CSHA1::m_workspace" ref="a10499b68005c1e537339c9c78021b85e" args="[64]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT_8 <a class="el" href="classCSHA1.html#a10499b68005c1e537339c9c78021b85e">CSHA1::m_workspace</a>[64]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SHA1_8h_source.html#l00278">278</a> of file <a class="el" href="SHA1_8h_source.html">SHA1.h</a>.</p>

<p>Referenced by <a class="el" href="SHA1_8cc_source.html#l00046">CSHA1()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="SHA1_8h_source.html">SHA1.h</a></li>
<li><a class="el" href="SHA1_8cc_source.html">SHA1.cc</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="classCSHA1.html">CSHA1</a>      </li>

    <li class="footer">Generated on Thu Mar 6 2014 14:06:44 for OverSim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
